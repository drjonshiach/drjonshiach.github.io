

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Indirect Methods for Solving Systems of Linear Equations &#8212; My Jupyter Book</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-2 bd-sidebar site-navigation show single-page" id="site-navigation">
    
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/7_indirect_methods.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/7_indirect_methods.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-outcomes">
   Learning Outcomes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indirect-methods">
   Indirect methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-jacobi-method">
   The Jacobi method
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-residual">
     The residual
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-1">
       Example 1
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-2">
       Example 2
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-gauss-seidel-method">
   The Gauss-Seidel method
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3">
     Example 3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-4">
     Example 4
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#convergence-of-direct-methods">
   Convergence of direct methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-5">
     Example 5
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-successive-over-relaxation-sor-method">
   The Successive Over Relaxation (SOR) method
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optimum-value-of-the-relaxation-parameter">
     Optimum value of the relaxation parameter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-6">
       Example 6
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-7">
       Example 7
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-8">
       Example 8
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-9">
       Example 9
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="indirect-methods-for-solving-systems-of-linear-equations">
<h1>Indirect Methods for Solving Systems of Linear Equations<a class="headerlink" href="#indirect-methods-for-solving-systems-of-linear-equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="learning-outcomes">
<h2>Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this headline">¶</a></h2>
<p>On successful completion of this page readers will be able to:</p>
<ul class="simple">
<li><p>Understand the concept of an indirect method when used to solve a system of linear equations.</p></li>
<li><p>Apply the Jacobi, Gauss-Seidel and SOR methods to solve a linear system.</p></li>
<li><p>Use the residual to determine the accuracy of the current estimate of the solution to the linear system.</p></li>
<li><p>Determine whether an indirect method is convergent for a particular linear system and analyse the theoretical rate of convergence for indirect methods.</p></li>
</ul>
</div>
<div class="section" id="indirect-methods">
<h2>Indirect methods<a class="headerlink" href="#indirect-methods" title="Permalink to this headline">¶</a></h2>
<p>Indirect methods for solving systems of linear equations use an iterative approach to repeatedly update estimates of the exact solution to the linear system. They are called indirect methods since multiple applications of the method is required to calculate a solution unlike direct methods such as <a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gaussian elimination</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/LU_decomposition">LU decomposition</a> which require a single application to calculate the solution. However, direct methods are inefficient for large systems of equations for which we tend to using indirect methods instead.</p>
<p>An indirect method for solving a system of linear equations of the form <span class="math notranslate nohighlight">\(A\mathbf{x}=\mathbf{b}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{k+1} = T \mathbf{x}^k + \mathbf{c},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span> is the current estimate of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}^{k+1}\)</span> is the improved estimate of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>, <span class="math notranslate nohighlight">\(T\)</span> is an <strong>iteration matrix</strong> and <span class="math notranslate nohighlight">\(\mathbf{c}\)</span> is some vector. This equation is iterated updating the values of the estimates such that <span class="math notranslate nohighlight">\(\mathbf{x}^{(k)}\)</span> as <span class="math notranslate nohighlight">\(k\to \infty\)</span>. Note that unlike direct methods which will calculate the exact solution, indirect only calculate an estimate (albeit very close) of the exact solution.</p>
</div>
<div class="section" id="the-jacobi-method">
<h2>The Jacobi method<a class="headerlink" href="#the-jacobi-method" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Jacobi_method">Jacobi method</a> is the simplest indirect method. Splitting the coefficient matrix <span class="math notranslate nohighlight">\(A\)</span> into the of elements from the lower triangular, diagonal and upper triangular parts of <span class="math notranslate nohighlight">\(A\)</span> to form matrices <span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(D\)</span> and <span class="math notranslate nohighlight">\(U\)</span> such that <span class="math notranslate nohighlight">\(A = D + L + U\)</span>, e.g.,</p>
<div class="math notranslate nohighlight">
\[
    L = \pmatrix{ 0 &amp; 0 &amp; \cdots &amp; 0 \cr a_{21} &amp; 0 &amp; \ddots &amp; \vdots \cr \vdots &amp; \ddots &amp; \ddots &amp; 0 \cr a_{n1} &amp; \cdots &amp; a_{n,n-1} &amp; 0}, \qquad
    D = \pmatrix{ a_{11} &amp; 0 &amp; \cdots &amp; 0 \cr 0 &amp; a_{22} &amp; \ddots &amp; \vdots \cr \vdots &amp;\ddots &amp; \ddots &amp; 0 \cr 0 &amp; \cdots &amp; 0 &amp; a_{nn}}, \qquad
    U = \pmatrix{ 0 &amp; a_{12} &amp; \cdots &amp; a_{1n} \cr 0 &amp; 0 &amp; \ddots &amp; \vdots \cr \vdots &amp;\ddots &amp; \ddots &amp; a_{n-1,n} &amp; \cr 0 &amp; \cdots &amp; 0 &amp; 0}.  
\]</div>
<p>Rewriting the linear system <span class="math notranslate nohighlight">\(A\mathbf{x}=\mathbf{b}\)</span> using <span class="math notranslate nohighlight">\(D\)</span>, <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span> gives</p>
<div class="math notranslate nohighlight">
\[
(D + L + U) \mathbf{x} = \mathbf{b}
\]</div>
<p>which can be rearranged to</p>
<div class="math notranslate nohighlight" id="equation-jacobi-x">
<span class="eqno">(1)<a class="headerlink" href="#equation-jacobi-x" title="Permalink to this equation">¶</a></span>\[\mathbf{x} = D^{-1}(\mathbf{b} - (L+U)\mathbf{x}).\]</div>
<p>Let the <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> on the left-hand side be <span class="math notranslate nohighlight">\(\mathbf{x}^{(k+1)}\)</span> and the <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> on the right-hand side be <span class="math notranslate nohighlight">\(\mathbf{x}^{(k)}\)</span> then writing this out for each element we have</p>
<div class="math notranslate nohighlight" id="equation-jacobi">
<span class="eqno">(2)<a class="headerlink" href="#equation-jacobi" title="Permalink to this equation">¶</a></span>\[x_i^{(k+1)} = \frac{1}{a_{ii}} \left( b_i - \sum_{j=1,j\neq i}^N a_{ij} x_j^{(k)}\right), \qquad i = 1,2, \ldots, n. \]</div>
<div class="section" id="the-residual">
<h3>The residual<a class="headerlink" href="#the-residual" title="Permalink to this headline">¶</a></h3>
<p>The Jacobi method is applied by iterating equation (2) until the solution <span class="math notranslate nohighlight">\(\mathbf{x}^{(k+1)}\)</span> is accurate enough for our needs. Since we do not know what the exact solution is we can quantity the accuracy of an estimate by using the <strong>residual</strong> which is defined as</p>
<div class="math notranslate nohighlight" id="equation-residual">
<span class="eqno">(3)<a class="headerlink" href="#equation-residual" title="Permalink to this equation">¶</a></span>\[\mathbf{r} = \mathbf{b} - A \mathbf{x}^{(k)},\]</div>
<p>so that as <span class="math notranslate nohighlight">\(\mathbf{x}^{(k)} \to \mathbf{x}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{r} \to \mathbf{0}\)</span>. The convergence criteria used is</p>
<div class="math notranslate nohighlight">
\[\|\mathbf{r}\| &lt; tol,\]</div>
<p>where <span class="math notranslate nohighlight">\(tol\)</span> is some small number. The smaller <span class="math notranslate nohighlight">\(tol\)</span> is, the closer <span class="math notranslate nohighlight">\(\mathbf{x}^{(k)}\)</span> is to the exact solution but this will require more iterations. In practice a compromise is made between the accuracy required and the computational resources available. Typical values of <span class="math notranslate nohighlight">\(tol\)</span> are around <span class="math notranslate nohighlight">\(10^{-4}\)</span> or maybe even <span class="math notranslate nohighlight">\(10^{-6}\)</span>.</p>
<div class="section" id="example-1">
<h4>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h4>
<p>Calculate the first iteration of the Jacobi method to solve the following system of linear equations and calculate the norm of the residual.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
    4x_1 + 3x_2 &amp;= -2, \\
    3x_1 + 4x_2 - x_3 &amp;= -8, \\
    -x_2 + 4x_3 &amp;= 14.
\end{aligned} \end{split}\]</div>
<p>Using equation <a class="reference internal" href="#equation-jacobi">(2)</a> the Jacobi iterations are</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
    x_1^{(k+1)} &amp;= \frac{1}{4}(-2 - 3x_2^{(k)}), \\
    x_2^{(k+1)} &amp;= \frac{1}{4}(-8 - 3x_1^{(k)} + x_3^{(k)}), \\
    x_3^{(k+1)} &amp;= \frac{1}{4}(14 + x_2^{(k)}).
\end{aligned} \end{split}\]</div>
<p>Using starting values of <span class="math notranslate nohighlight">\(\mathbf{x}^{(0)} = (0, 0, 0)^T\)</span> the first iteration is</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
    x_1^{(1)} &amp;= \frac{1}{4}(-2 - 3(0)) = -0.5, \\
    x_2^{(1)} &amp;= \frac{1}{4}(-8 - 3(0) + 0) = -2, \\
    x_3^{(1)} &amp;= \frac{1}{4}(14 + 0) = 3.5.
\end{aligned} \end{split}\]</div>
<p>Calculate the residual using equation <a class="reference internal" href="#equation-residual">(3)</a></p>
<div class="math notranslate nohighlight">
\[\mathbf{r}^{(1)} = \mathbf{b} - A \mathbf{x}^{(1)} 
= \pmatrix{-2 \cr -8 \cr 14}  - 
\pmatrix{4 &amp; 3 &amp; 0 \cr 3 &amp; 4 &amp; -1 \cr 0 &amp; -1 &amp; 4} 
\pmatrix{-0.5 \cr -2 \cr 3} = 
\pmatrix{ 6 \cr 5 \cr -2 },\]</div>
<p>and the norm of the residual is <span class="math notranslate nohighlight">\(\|\mathbf{r}^{(1)}\|=\sqrt{6^2 + 5^2 + (-2)^2} = 8.06226\)</span>.</p>
</div>
<div class="section" id="example-2">
<h4>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h4>
<p>Write a MATLAB program to solve the system of linear equations from example 1 using the Jacobi method ceasing iterations when <span class="math notranslate nohighlight">\(\|\mathbf{r}\| &lt; 10^{-4}\)</span>.</p>
<p>The function called <code class="docutils literal notranslate"><span class="pre">jacobi</span></code> below solves a linear system of equations defined by the arrays <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>. Iterations cease when <span class="math notranslate nohighlight">\(\|\mathbf{r}\|&lt;tol\)</span> or <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> is exceeded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">jacobi</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">,</span> <span class="n">tol</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the solution to the system of linear equations Ax = b using</span>
<span class="sd">    the Jacobi method</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Initialise solution array</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">maxiter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
    
    <span class="c1"># Iteration loop</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
        
        <span class="c1"># Calculate Jacobi method</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            
            <span class="c1"># Calculate sum</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                    
            <span class="c1"># Calculate new estimate of x_i</span>
            <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
            
        <span class="c1"># Calculate the norm of the residual</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]))</span>
        
        <span class="c1"># Check for convergence</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">break</span>
    
    <span class="k">return</span> <span class="n">x</span><span class="p">[:</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<p>The program below uses the function jacobi to solve the system of linear equations from example 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solution_table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Prints a formatted table displaying the iterations values of an</span>
<span class="sd">    indirect method</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  k&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;      x_</span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    ||r||</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:10.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:10.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">,:]))))</span>


<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">14</span> <span class="p">])</span>

<span class="c1"># Solve linear system using the Jacobi method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">jacobi</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="n">solution_table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  k      x_0       x_1       x_2     ||r||
--------------------------------------------
   0   0.00000   0.00000   0.00000  16.24808
   1  -0.50000  -2.00000   3.50000   8.06226
   2   1.00000  -0.75000   3.00000   6.37377
   3   0.06250  -2.00000   3.31250   5.03891
   4   1.00000  -1.21875   3.00000   3.98361
   5   0.41406  -2.00000   3.19531   3.14932
   6   1.00000  -1.51172   3.00000   2.48976
   7   0.63379  -2.00000   3.12207   1.96832
   8   1.00000  -1.69482   3.00000   1.55610
   9   0.77112  -2.00000   3.07629   1.23020
  10   1.00000  -1.80927   3.00000   0.97256
  11   0.85695  -2.00000   3.04768   0.76888
  12   1.00000  -1.88079   3.00000   0.60785
  13   0.91059  -2.00000   3.02980   0.48055
  14   1.00000  -1.92549   3.00000   0.37991
  15   0.94412  -2.00000   3.01863   0.30034
  16   1.00000  -1.95343   3.00000   0.23744
  17   0.96508  -2.00000   3.01164   0.18771
  18   1.00000  -1.97090   3.00000   0.14840
  19   0.97817  -2.00000   3.00728   0.11732
  20   1.00000  -1.98181   3.00000   0.09275
  21   0.98636  -2.00000   3.00455   0.07333
  22   1.00000  -1.98863   3.00000   0.05797
  23   0.99147  -2.00000   3.00284   0.04583
  24   1.00000  -1.99289   3.00000   0.03623
  25   0.99467  -2.00000   3.00178   0.02864
  26   1.00000  -1.99556   3.00000   0.02264
  27   0.99667  -2.00000   3.00111   0.01790
  28   1.00000  -1.99722   3.00000   0.01415
  29   0.99792  -2.00000   3.00069   0.01119
  30   1.00000  -1.99827   3.00000   0.00885
  31   0.99870  -2.00000   3.00043   0.00699
  32   1.00000  -1.99892   3.00000   0.00553
  33   0.99919  -2.00000   3.00027   0.00437
  34   1.00000  -1.99932   3.00000   0.00346
  35   0.99949  -2.00000   3.00017   0.00273
  36   1.00000  -1.99958   3.00000   0.00216
  37   0.99968  -2.00000   3.00011   0.00171
  38   1.00000  -1.99974   3.00000   0.00135
  39   0.99980  -2.00000   3.00007   0.00107
  40   1.00000  -1.99983   3.00000   0.00084
  41   0.99988  -2.00000   3.00004   0.00067
  42   1.00000  -1.99990   3.00000   0.00053
  43   0.99992  -2.00000   3.00003   0.00042
  44   1.00000  -1.99994   3.00000   0.00033
  45   0.99995  -2.00000   3.00002   0.00026
  46   1.00000  -1.99996   3.00000   0.00021
  47   0.99997  -2.00000   3.00001   0.00016
  48   1.00000  -1.99997   3.00000   0.00013
  49   0.99998  -2.00000   3.00001   0.00010
  50   1.00000  -1.99998   3.00000   0.00008
</pre></div>
</div>
</div>
</div>
<p>So the Jacobi method took 50 iterations to converge to the solution <span class="math notranslate nohighlight">\(x_1=1.0000\)</span>, <span class="math notranslate nohighlight">\(x_2 = -2.0000\)</span> and <span class="math notranslate nohighlight">\(x_3 = 3.0000\)</span> correct to 4 decimal places.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="the-gauss-seidel-method">
<h2>The Gauss-Seidel method<a class="headerlink" href="#the-gauss-seidel-method" title="Permalink to this headline">¶</a></h2>
<p>The speed of convergence for the Jacobi method can be improved by using the values of <span class="math notranslate nohighlight">\(x_j^{(k+1)}\)</span> where <span class="math notranslate nohighlight">\(j&lt;i\)</span> to calculate <span class="math notranslate nohighlight">\(x_i^{(k+1)}\)</span>. This leads to the <a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Seidel_method">Gauss-Seidel method</a>. Writing the coefficient matrix of a system of linear equations <span class="math notranslate nohighlight">\(A\mathbf{x}=\mathbf{b}\)</span> as <span class="math notranslate nohighlight">\(A = L + D + U\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
(L + D + U)\mathbf{x} &amp;= \mathbf{b} \\
D\mathbf{x} &amp;= \mathbf{b} - L\mathbf{x} - U\mathbf{x} \\
\mathbf{x} &amp;= D^{-1}(\mathbf{b} - L\mathbf{x} - U\mathbf{x}).
\end{aligned}
\end{split}\]</div>
<p>Since <span class="math notranslate nohighlight">\(L\)</span> is a lower triangular matrix the values of <span class="math notranslate nohighlight">\(x_i^{(k+1)}\)</span> can be calculated sequentially using forward substitution so the iterative form of the Gauss-Seidel method is</p>
<div class="math notranslate nohighlight" id="equation-gauss-seidel">
<span class="eqno">(4)<a class="headerlink" href="#equation-gauss-seidel" title="Permalink to this equation">¶</a></span>\[x_i^{(k+1)} = \frac{1}{a_{ii}} \left(b_i - \sum_{j=1}^{i-1} a_{ij}x_j^{(k+1)} - \sum_{j=i+1}^n a_{ij} x_j^{(k)}\right), \qquad  i = 1, 2, \ldots, n.\]</div>
<div class="section" id="example-3">
<h3>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h3>
<p>Calculate the first iteration of the Gauss-Seidel method and the norm of the residual for the system of linear equations from example 1</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
4x_1 + 3x_2 &amp;= -2, \\
3x_1 + 4x_2 - x_3 &amp;= -8, \\
-x_2 + 4x_3 &amp;= 14.
\end{aligned} \end{split}\]</div>
<p>Using equation <a class="reference external" href="#gauss-seidel">(4)</a> and the Gauss-Seidel iterations are</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(k+1)} &amp;= \frac{1}{4}(-2 - 3x_2^{(k)}),\\
x_2^{(k+1)} &amp;= \frac{1}{4}(-8 - 3x_1^{(k+1)} + x_3^{(k)}), \\
x_3^{(k+1)} &amp;= \frac{1}{4}(14 + x_2^{(k+1)}).
\end{aligned} \end{split}\]</div>
<p>Using starting values of <span class="math notranslate nohighlight">\(\mathbf{x}^{(0)} = (0, 0, 0)^T\)</span> the first iteration is</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(1)} &amp;= \frac{1}{4}(-2-3(0)) = -0.5, \\
x_2^{(1)} &amp;= \frac{1}{4}(-8 - 3(-0.5) + 0) = -1.625 \\
x_3^{(1)} &amp;= \frac{1}{4}(14 - 1.625) = 3.09375. 
\end{aligned} \end{split}\]</div>
<p>Calculate the residual using equation <a class="reference internal" href="#equation-residual">(3)</a></p>
<div class="math notranslate nohighlight">
\[\mathbf{r}^{(1)} = \mathbf{b} - A \mathbf{x}^{(1)} = 
\pmatrix{ -2 \cr -8 \cr 14} - \pmatrix{4 &amp; 3 &amp; 0 \cr 3 &amp; 4 &amp; -1 \cr 0 &amp; -1 &amp; 4}\pmatrix{-0.5 \cr -1.625 \cr 3.09375} = \pmatrix{4.875 \cr 3.09375 \cr 0},\]</div>
<p>and the norm of the residual is <span class="math notranslate nohighlight">\(\|\mathbf{r}^{(1)}\|=\sqrt{4.875^2 + 3.09375^2 + 0^2} = 5.77381\)</span>.</p>
</div>
<div class="section" id="example-4">
<h3>Example 4<a class="headerlink" href="#example-4" title="Permalink to this headline">¶</a></h3>
<p>Write a Python program to solve the system of linear equations from example 1 using the Gauss-Seidel method.</p>
<p>The function called <code class="docutils literal notranslate"><span class="pre">gauss_seidel</span></code> defined below solves a linear system of equations defined by the arrays <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>. Iterations cease when <span class="math notranslate nohighlight">\(\|\mathbf{r}\|&lt;tol\)</span> or <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> is exceeded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gauss_seidel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">,</span> <span class="n">tol</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the solution to the system of linear equations Ax = b using</span>
<span class="sd">    the Gauss-Seidel method</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Initialise solution array</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">maxiter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
    
    <span class="c1"># Iterationa loop</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
        
        <span class="c1"># Calculate Gauss-Seidel method</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            
            <span class="c1"># Calculate sum</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
            
            <span class="c1"># Calculate new estimate of x_i</span>
            <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
        
        <span class="c1"># Calculate norm of the residual</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]))</span>
        
        <span class="c1"># Check for convergence</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">break</span>
    
    <span class="k">return</span> <span class="n">x</span><span class="p">[:</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>
<p>The program below uses the function <code class="docutils literal notranslate"><span class="pre">gauss_seidel</span></code> to solve the system of linear equations from example 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">14</span> <span class="p">])</span>

<span class="c1"># Solve linear system using the Gauss-Seidel method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">gauss_seidel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="n">solution_table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  k      x_0       x_1       x_2     ||r||
--------------------------------------------
   0   0.00000   0.00000   0.00000  16.24808
   1  -0.50000  -1.62500   3.09375   5.77381
   2   0.71875  -1.76562   3.05859   0.42334
   3   0.82422  -1.85352   3.03662   0.26459
   4   0.89014  -1.90845   3.02289   0.16537
   5   0.93134  -1.94278   3.01431   0.10335
   6   0.95708  -1.96424   3.00894   0.06460
   7   0.97318  -1.97765   3.00559   0.04037
   8   0.98324  -1.98603   3.00349   0.02523
   9   0.98952  -1.99127   3.00218   0.01577
  10   0.99345  -1.99454   3.00136   0.00986
  11   0.99591  -1.99659   3.00085   0.00616
  12   0.99744  -1.99787   3.00053   0.00385
  13   0.99840  -1.99867   3.00033   0.00241
  14   0.99900  -1.99917   3.00021   0.00150
  15   0.99938  -1.99948   3.00013   0.00094
  16   0.99961  -1.99967   3.00008   0.00059
  17   0.99976  -1.99980   3.00005   0.00037
  18   0.99985  -1.99987   3.00003   0.00023
  19   0.99990  -1.99992   3.00002   0.00014
  20   0.99994  -1.99995   3.00001   0.00009
</pre></div>
</div>
</div>
</div>
<p>Note that the Gauss-Seidel method took 20 iterations to achieve convergence to <span class="math notranslate nohighlight">\(tol=10^{-4}\)</span> whereas the Jacobi method took 50 iterations to achieve the same accuracy.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="convergence-of-direct-methods">
<h2>Convergence of direct methods<a class="headerlink" href="#convergence-of-direct-methods" title="Permalink to this headline">¶</a></h2>
<p>We have seen that both the Jacobi and Gauss-Seidel method converge to the solution to the example system of linear equations and that the Gauss-Seidel method converges at a faster rate. Direct methods will not be convergent for all linear systems and we tell if a method will be convergent using the theorem below</p>
<p>We can examine the convergence of an indirect method by considering the iteration of the error vector <span class="math notranslate nohighlight">\(\mathbf{e}^{(k)}\)</span></p>
<p>if <span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> are the <a class="reference external" href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">eigenvectors</a> of the iteration matrix <span class="math notranslate nohighlight">\(T\)</span> with corresponding <a class="reference external" href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">eigenvalues</a> <span class="math notranslate nohighlight">\(\lambda_i\)</span> then for the first error we can write</p>
<div class="math notranslate nohighlight">
\[\mathbf{e}^{(0)} = \alpha_1 \mathbf{v}_1 + \alpha_2 \mathbf{v}_2 + \cdots + \alpha_n \mathbf{v}_n = \sum_{i=1}^n \alpha_i \mathbf{v}_i.\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_i\)</span> are scalars. Applying an iteration matrix to <span class="math notranslate nohighlight">\(\mathbf{e}^{(k)}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
\mathbf{e}^{(1)} &amp;= T \mathbf{e}^{(0)} = T\left( \sum_{i=1}^n \alpha_i \mathbf{v}_i\right) = \sum_{i=1}^n \alpha_i T \mathbf{v}_i = \sum_{i=1}^n \alpha_i \lambda_i \mathbf{v}_i, \\
\mathbf{e}^{(2)} &amp;= T \mathbf{e}^{(1)} =  T\left( \sum_{i=1}^n \alpha_i \lambda_i \mathbf{v}_i\right) = \sum_{i=1}^n \alpha_i \lambda_i T \mathbf{v}_i = \sum_{i=1}^n \alpha_i \lambda_i^2 \mathbf{v}_i, \\
&amp;\vdots \\
\mathbf{e}^{(k+1)} &amp;= \sum_{i=1}^n \alpha_i \lambda_i^k \mathbf{v}_i.
\end{aligned} \end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(\|\lambda_1\|&gt;\lambda_i\)</span> for <span class="math notranslate nohighlight">\(i=2,3, \ldots, n\)</span> then</p>
<div class="math notranslate nohighlight">
\[\mathbf{e}^{(k+1)} = \alpha_1 \lambda_1^{k+1} \mathbf{v}_1 + \sum_{i=2}^n \alpha_i \lambda_i^{k+1} \mathbf{v}_i = \lambda_1^{k+1} \left( \alpha_1\mathbf{v}_1 + \sum_{i=2}^n \alpha_i\mathbf{v}_i \left(\frac{\lambda_i}{\lambda_1}\right)^{(k+1)}\right),\]</div>
<p>and since <span class="math notranslate nohighlight">\(\left(\dfrac{\lambda_i}{\lambda_1}\right)^{(k+1)}\)</span> so</p>
<div class="math notranslate nohighlight">
\[\lim_{k\to \infty} \mathbf{e}^{(k+1)} = \alpha_1 \lambda_1^{(k+1)} \mathbf{v}_1.\]</div>
<p>This means that the error varies by a factor of <span class="math notranslate nohighlight">\(\lambda_1^{(k+1)}\)</span> where <span class="math notranslate nohighlight">\(\lambda_1\)</span> is the largest eigenvalue of <span class="math notranslate nohighlight">\(T\)</span> which is also known as the <a class="reference external" href="https://en.wikipedia.org/wiki/Spectral_radius">spectral radius</a> and denoted by <span class="math notranslate nohighlight">\(\rho(T)\)</span>. The spectral radius gives us the following information about an indirect method</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(\rho(T) &gt; 1\)</span> then the errors will increase over each iteration, therefore for an indirect method to converge to the solution we require <span class="math notranslate nohighlight">\(\rho(T)&lt;1\)</span>.</p></li>
<li><p>The smaller the value of <span class="math notranslate nohighlight">\(\rho(T)\)</span> the faster the errors will tend to zero.</p></li>
</ul>
<div class="section" id="example-5">
<h3>Example 5<a class="headerlink" href="#example-5" title="Permalink to this headline">¶</a></h3>
<p>Show that the Jacobi and Gauss-Seidel methods are convergent of the system of linear equations from example 1.</p>
<p>Recall that the matrix form of the Jacobi method is equation <a class="reference internal" href="#equation-jacobi-x">(1)</a></p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{(k+1)} = D^{-1}(\mathbf{b} - (L + U)\mathbf{x}^{(k)}) = -D^{-1}(L+U)\mathbf{x}^{(k)} + D^{-1}\mathbf{b},\]</div>
<p>so the iteration matrix for the Jacobi method is</p>
<div class="math notranslate nohighlight" id="equation-t-j">
<span class="eqno">(5)<a class="headerlink" href="#equation-t-j" title="Permalink to this equation">¶</a></span>\[T_J = -D^{-1}(L+U).\]</div>
<p>The iteration matrix for the Gauss-Seidel method can be found by rearranging <span class="math notranslate nohighlight">\((L+D+U)\mathbf{x} = \mathbf{b}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
(L + D + U) \mathbf{x} &amp;= \mathbf{b} \\
(L + D)\mathbf{x} &amp;= \mathbf{b} - U \mathbf{x} \\
\mathbf{x} &amp;= -(L+D)^{-1}U\mathbf{x}  + (L+D)^{-1}\mathbf{x},
\end{aligned} \end{split}\]</div>
<p>So the Gauss-Seidel method is</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{(k+1)} = -(L+D)^{-1} U \mathbf{x}^{(k)} + (L+D)^{-1} \mathbf{x}^{(k+1)},\]</div>
<p>and the iteration matrix for the Gauss-Seidel method is</p>
<div class="math notranslate nohighlight" id="equation-t-gs">
<span class="eqno">(6)<a class="headerlink" href="#equation-t-gs" title="Permalink to this equation">¶</a></span>\[T_{GS} = -(L+D)^{-1} U.\]</div>
<p>The code below calculates the spectral radius of <span class="math notranslate nohighlight">\(T_J\)</span> and <span class="math notranslate nohighlight">\(T_{GS}\)</span> .</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">jacobi_iteration_matrix</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">D</span><span class="p">),</span> <span class="n">L</span> <span class="o">+</span> <span class="n">U</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gauss_seidel_iteration_matrix</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="n">D</span><span class="p">),</span> <span class="n">U</span><span class="p">)</span>

<span class="c1"># Define coefficient matrix</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span> 
              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]])</span>

<span class="c1"># Calculate L, D and U</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">L</span> <span class="o">-</span> <span class="n">U</span>

<span class="c1"># Calculate spectral radii of TJ and TGS</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">jacobi_iteration_matrix</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">))</span>
<span class="n">rho_TJ</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">gauss_seidel_iteration_matrix</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">))</span>
<span class="n">rho_TGS</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho(T_J) = </span><span class="si">{:0.4f}</span><span class="se">\n</span><span class="s1">rho(T_GS) = </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rho_TJ</span><span class="p">,</span> <span class="n">rho_TGS</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>rho(T_J) = 0.7906
rho(T_GS) = 0.6250
</pre></div>
</div>
</div>
</div>
<p>So <span class="math notranslate nohighlight">\(\rho(T_J)=0.7906\)</span> and <span class="math notranslate nohighlight">\(\rho(T_{GS})=0.6250\)</span> which are both less than 1 so both of these methods is convergent for this system. Furthermore, the Gauss-Seidel method will converge faster than the Jacobi method since it has a smaller spectral radius.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="the-successive-over-relaxation-sor-method">
<h2>The Successive Over Relaxation (SOR) method<a class="headerlink" href="#the-successive-over-relaxation-sor-method" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Successive_over-relaxation">Successive Over Relaxation (SOR) method</a> improves on the convergence rate of the Gauss-Seidel method by applying a weighting factor to the updated estimates to increase (or decrease in the the case of oscillatory convergence) the affect of the change.</p>
<p>Let <span class="math notranslate nohighlight">\(\omega\)</span> be a <strong>relaxation parameter</strong> in the range <span class="math notranslate nohighlight">\([0,2]\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}_{GS}^{(k)}\)</span> denote the Gauss-Seidel solution for iteration <span class="math notranslate nohighlight">\(k\)</span> then the SOR method is</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{(k+1)} = (1 - \omega)\mathbf{x}^{(k)} + \omega \mathbf{x}_{GS}^{(k)}\]</div>
<p>so the iterative scheme is</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
\mathbf{x}^{(k+1)} &amp;= (1 - \omega) \mathbf{x}^{(k)} + \frac{\omega}{a_{ii}}\left( b_i - \sum_{j=1}^{i-1} a_{ij} \mathbf{x}_j^{(k+1)} - \sum_{j=i+1}^n a_{ij}\mathbf{x}_j^{(k)} \right). &amp;&amp; (7)
\end{aligned}
\]</div>
<p>When <span class="math notranslate nohighlight">\(\omega&lt;1\)</span> the coefficient of the first term in equation (7) is multiplied by a number greater than 1 and the second term (which is the <a class="reference external" href="#gauss-seidel">Gauss-Seidel method</a>) is multiplied by a number less than 1 therefore reducing the change in the value of the estimate from one iteration to the next. This will speed up the rate of convergence when the estimates oscillate about the exact solution.</p>
<p>When <span class="math notranslate nohighlight">\(\omega&gt;1\)</span> the coefficient of the first term is multiplied by a number less than 1 and the second term by a number greater than 1 therefore increasing the change in the estimates. This will speed up the rate of convergence when the estimates converge monotonically.</p>
<div class="section" id="optimum-value-of-the-relaxation-parameter">
<h3>Optimum value of the relaxation parameter<a class="headerlink" href="#optimum-value-of-the-relaxation-parameter" title="Permalink to this headline">¶</a></h3>
<p>The optimum value of <span class="math notranslate nohighlight">\(\omega\)</span> will be the one that minimises the spectral radius of the iteration matrix. The iteration matrix for the SOR method is derived by writing the coefficient matrix of the linear system <span class="math notranslate nohighlight">\(A\mathbf{x} = \mathbf{b}\)</span> using</p>
<div class="math notranslate nohighlight">
\[A = L + \left(1 - \frac{1}{\omega}\right)D + \frac{1}{\omega}D + U.\]</div>
<p>Substituting into the linear system and rearranging</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\left( L + \left( 1 - \frac{1}{\omega}\right)D + \frac{1}{\omega}D + U\right) \mathbf{x} &amp;= \mathbf{b} \\
(D + \omega L) \mathbf{x} + ((\omega - 1) D + \omega U) \mathbf{x} &amp;= \omega \mathbf{b} \\
(D + \omega L) \mathbf{x} &amp;= ((1 - \omega)D - \omega U) \mathbf{x} +  \omega \mathbf{b} \\
\mathbf{x} &amp;= (D + \omega L)^{-1}((1 - \omega)D-\omega U)\mathbf{x} + (D + \omega L)^{-1}\omega \mathbf{b}.
\end{aligned}
\end{split}\]</div>
<p>So the matrix form of the SOR method is</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{(k+1)} = (D + \omega L)^{-1}((1 - \omega)D-\omega U)\mathbf{x}^{(k)} + (D + \omega L)^{-1}\omega \mathbf{b},\]</div>
<p>and the iteration matrix is</p>
<div class="math notranslate nohighlight" id="equation-t-sor">
<span class="eqno">(7)<a class="headerlink" href="#equation-t-sor" title="Permalink to this equation">¶</a></span>\[T_{SOR} = (D + \omega L)^{-1}((1 - \omega) D - \omega U).\]</div>
<p>Equation <a class="reference internal" href="#equation-t-sor">(7)</a> is a function of <span class="math notranslate nohighlight">\(\omega\)</span> so the spectral radius of <span class="math notranslate nohighlight">\(T_{SOR}\)</span> will depend on <span class="math notranslate nohighlight">\(\omega\)</span>.</p>
<div class="section" id="example-6">
<h4>Example 6<a class="headerlink" href="#example-6" title="Permalink to this headline">¶</a></h4>
<p>Determine the optimum relaxation parameter for the SOR when applied to the linear system from example 1.</p>
<p>The code below calculates the spectral radius of the SOR method for a range of <span class="math notranslate nohighlight">\(\omega\)</span> values and plots them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sor_iteration_matrix</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">L</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">omega</span><span class="p">)</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">U</span><span class="p">))</span>

<span class="c1"># Define coefficient matrix</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span> 
              <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]])</span>

<span class="c1"># Calculate L, D and U</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">L</span> <span class="o">-</span> <span class="n">U</span>

<span class="c1"># Calculate spectral radius for a range of omega values</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">rho_TSOR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">omega</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">omega</span><span class="p">)):</span>
    <span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">sor_iteration_matrix</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">rho_TSOR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">));</span>

<span class="c1"># Plot spectral radius against omega</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">rho_TSOR</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\omega$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">rho(T_</span><span class="si">{SOR}</span><span class="s1">)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7_indirect_methods_23_0.png" src="_images/7_indirect_methods_23_0.png" />
</div>
</div>
<p>The value of <span class="math notranslate nohighlight">\(\rho(T_{SOR})\)</span> is a minimum when <span class="math notranslate nohighlight">\(\omega \approx 1.2\)</span> so this is the optimum value.</p>
<div class="tip admonition">
<p class="admonition-title"><strong>Theorem:</strong> Optimum relaxation parameter</p>
<p>If a system of linear equations of the form <span class="math notranslate nohighlight">\(A\mathbf{x}=\mathbf{b}\)</span> has a positive definite coefficient matrix <span class="math notranslate nohighlight">\(A\)</span> with all real eigenvalues then the optimum relaxation parameter for the SOR method can be calculated using</p>
<div class="math notranslate nohighlight">
\[\omega_{opt} = 1 + \left(\frac{\rho(T_J)}{1 + \sqrt{1 - \rho(T_J)^2}}\right)^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(T_J\)</span> is the iteration matrix for the Jacobi method (equation <a class="reference internal" href="#equation-t-j">(5)</a>).</p>
</div>
</div>
<div class="section" id="example-7">
<h4>Example 7<a class="headerlink" href="#example-7" title="Permalink to this headline">¶</a></h4>
<p>Determine the optimum value of the relaxation parameter <span class="math notranslate nohighlight">\(\omega\)</span> for the linear system from example 1.</p>
<p>Checking that <span class="math notranslate nohighlight">\(A\)</span> is positive definite</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]])</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lambda_1 = </span><span class="si">{:0.4f}</span><span class="se">\n</span><span class="s1">lambda_2 = </span><span class="si">{:0.4f}</span><span class="se">\n</span><span class="s1">lambda_3 = </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span>\
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>lambda_1 = 7.5616
lambda_2 = 1.0000
lambda_3 = 3.4384
</pre></div>
</div>
</div>
</div>
<p>So <span class="math notranslate nohighlight">\(\lambda_1=7.5616\)</span>, <span class="math notranslate nohighlight">\(\lambda_2=1\)</span> and <span class="math notranslate nohighlight">\(\lambda_3=3.4384\)</span> which are all real and <span class="math notranslate nohighlight">\(A\)</span> is symmetric so <span class="math notranslate nohighlight">\(A\)</span> is a positive definite matrix.</p>
<p>We saw in example 6] that <span class="math notranslate nohighlight">\(\rho(T_J) = 0.7906\)</span>, so the optimum value of <span class="math notranslate nohighlight">\(\omega\)</span> is</p>
<div class="math notranslate nohighlight">
\[\omega_{opt} = 1 + \left(\frac{0.7906}{1 + \sqrt{1 - 0.7906^2}}\right)^2 = 1.2404.\]</div>
</div>
<div class="section" id="example-8">
<h4>Example 8<a class="headerlink" href="#example-8" title="Permalink to this headline">¶</a></h4>
<p>Calculate the first iteration of the SOR method using <span class="math notranslate nohighlight">\(\omega=1.24\)</span> and the norm of the residual for the system of linear equations from example 1.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
4x_1 + 3x_2 &amp;= -2, \\
3x_1 + 4x_2 - x_3 &amp;= -8, \\
-x_2 + 4x_3 &amp;= 14.
\end{aligned} \end{split}\]</div>
<p>The SOR iterations are</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(k+1)} &amp;= (1 - 1.24)x_1^{(k)} +  \frac{1.24}{4}(-2 - 3x_2^{(k)}),\\
x_2^{(k+1)} &amp;= (1 - 1.24)x_2^{(k)} + \frac{1.24}{4}(-8 - 3x_1^{(k+1)} + x_3^{(k)}), \\
x_3^{(k+1)} &amp;= (1 - 1.24)x_3^{(k)} + \frac{1.24}{4}(14 + x_2^{(k+1)}).
\end{aligned} \end{split}\]</div>
<p>Using starting values of <span class="math notranslate nohighlight">\(\mathbf{x}^{(0)} = (0, 0, 0)^T\)</span> the first iteration is</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(k+1)} &amp;= (1 - 1.24)(0) +  \frac{1.24}{4}(-2 - 3(0)) = -0.62,\\
x_2^{(k+1)} &amp;= (1 - 1.24)(0) + \frac{1.24}{4}(-8 - 3(-0.62) + 0) = -1.9034, \\
x_3^{(k+1)} &amp;= (1 - 1.24)(0) + \frac{1.24}{4}(14 - 1.9034) = 3.74995.
\end{aligned} \end{split}\]</div>
<p>Calculate the residual</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}^{(1)} = \mathbf{b} - A \mathbf{x}^{(1)} = 
\pmatrix{ -2 \cr -8 \cr 14} - 
\pmatrix{4 &amp; 3 &amp; 0 \cr 3 &amp; 4 &amp; -1 \cr 0 &amp; -1 &amp; 4}
\pmatrix{-0.62 \cr -1.9034 \cr 3.74995} = 
\pmatrix{6.1902 \cr 5.2235 \cr -2.9032},\]</div>
<p>and the norm of the residual is <span class="math notranslate nohighlight">\(\|\mathbf{r}^{(1)}\|=\sqrt{6.1902^2 + 5.2235^2 + (-2.9032)^2} = 8.60421\)</span>.</p>
</div>
<div class="section" id="example-9">
<h4>Example 9<a class="headerlink" href="#example-9" title="Permalink to this headline">¶</a></h4>
<p>Write a Python program to solve the system of linear equations from example 1 using the SOR method with <span class="math notranslate nohighlight">\(\omega=1.24\)</span>.</p>
<p>The function called <code class="docutils literal notranslate"><span class="pre">sor</span></code> below solves a linear system of equations defined by the arrays <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> using the SOR method. Iterations cease when <span class="math notranslate nohighlight">\(\|\mathbf{r}\|&lt;tol\)</span> or <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> is exceeded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sor</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">,</span> <span class="n">tol</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the solution to the system of linear equations Ax = b using the SOR method</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Initialise solution array</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">maxiter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
    
    <span class="c1"># Iteration loop</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
        
        <span class="c1"># Calculate SOR method</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            
            <span class="c1"># Calculate sum</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            
            <span class="c1"># Calculate new estimate of x_i</span>
            <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">omega</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
        
        <span class="c1"># Calculate the norm of the residual</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]))</span>

        <span class="c1"># Check for convergence</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">break</span>
    
    <span class="k">return</span> <span class="n">x</span><span class="p">[:</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>
<p>The program below uses the function <code class="docutils literal notranslate"><span class="pre">sor</span></code> to solve the system of linear equations from example 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">14</span> <span class="p">])</span>

<span class="c1"># Solve linear system using the SOR method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sor</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="n">solution_table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  k      x_0       x_1       x_2     ||r||
--------------------------------------------
   0   0.00000   0.00000   0.00000  16.24808
   1  -0.62000  -1.90340   3.74995   8.60421
   2   1.29896  -2.06874   2.79870   1.48306
   3   0.99217  -2.03863   3.03634   0.31850
   4   1.03780  -2.01462   2.98675   0.13283
   5   1.00452  -2.00481   3.00169   0.01419
   6   1.00338  -2.00147   2.99914   0.01066
   7   1.00055  -2.00043   3.00007   0.00118
   8   1.00027  -2.00012   2.99994   0.00080
   9   1.00005  -2.00003   3.00000   0.00011
  10   1.00002  -2.00001   3.00000   0.00006
</pre></div>
</div>
</div>
</div>
<p>Note that the SOR method took 10 iterations to achieve convergence to <span class="math notranslate nohighlight">\(tol=10^{-4}\)</span> whereas the Gauss-Seidel and Jacobi methods took 20 and 50 iterations respectively to achieve the same accuracy.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Indirect methods use an iterative approach to improve an estimate of the solution to a system of linear equations. The methods are iterated until the estimates have achieved the required accuracy.</p></li>
<li><p>The Jacobi method uses information from the previous iteration only to update the estimates.</p></li>
<li><p>The Gauss-Seidel method uses values of estimates already calculated in a given iteration to update the estimates. This means that the Gauss-Seidel method will converge to a solution faster than the Jacobi method.</p></li>
<li><p>An indirect method will converge to the exact solution if the value of the spectral radius (the largest absolute eigenvalue) of the iteration matrix for a linear system is less than 1.</p></li>
<li><p>The smaller the value of the spectral radius, the faster the method will converge to the exact solution.</p></li>
<li><p>The SOR method uses a relaxation parameter to adjust how much estimates will change over a single iteration. The value of the relaxation parameter is chosen to minimise the spectral radius.</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>Using a pen and calculator, calculate the first 2 iterations of the Jacobi method for solving the system of linear equations below. Use starting values of <span class="math notranslate nohighlight">\(x_i^{(0)}=0\)</span> and work to 4 decimal places.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
4x_1 + x_2 - x_3 + x_4 &amp;= 14 ,\\
x_1 + 4x_2 - x_3 - x_4 &amp;= 10, \\
-x_1 -x_2 + 5x_3 + x_4 &amp;= -15, \\
x_1 - x_2 + x_3 + 3x_4 &amp;= 3.
\end{aligned}
\end{split}\]</div>
</li>
<li><p>Repeat question 1 using the Gauss-Seidel method.</p></li>
<li><p>Repeat question 1 using the SOR method using the optimum value for the relaxation parameter (use Python to determine the spectral radius of <span class="math notranslate nohighlight">\(T_J\)</span>).</p></li>
<li><p>Which method would you expect to converge to the solution with the fewest iterations? What quantitative evidence do you have to support your conclusion?</p></li>
<li><p>Write a Python program to calculate the solution to questions 1 to 3 using <span class="math notranslate nohighlight">\(tol=10^{-5}\)</span>.</p></li>
<li><p>A linear system has the following coefficient matrix. What is the largest value that  can be in order for the Jacobi method to be convergent?</p>
<div class="math notranslate nohighlight">
\[A = \pmatrix{ 2 &amp; 1 \cr \alpha &amp; 2}\]</div>
</li>
<li><p>A linear system has the following coefficient matrix. Is the Jacobi method convergent for this system? If not, can the system be altered so that the Jacobi method is convergent?</p>
<div class="math notranslate nohighlight">
\[A = \pmatrix{1 &amp; 3 &amp; 1 \cr 2 &amp; 1 &amp; 0 \cr 1 &amp; 1 &amp; 4}\]</div>
</li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>