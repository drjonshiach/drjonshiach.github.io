

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Solutions to Tutorials Exercises &#8212; My Jupyter Book</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-2 bd-sidebar site-navigation show single-page" id="site-navigation">
    
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/8_exercise_solutions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/8_exercise_solutions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initial-value-problems">
   Initial Value Problems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#runge-kutta-methods">
   Runge-Kutta Methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implicit-runge-kutta-methods">
   Implicit Runge-Kutta Methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stability">
   Stability
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boundary-value-problems">
   Boundary Value Problems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#direct-methods-for-solving-systems-of-linear-equations">
   Direct Methods for Solving Systems of Linear Equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indirect-methods-for-solving-systems-of-linear-equations">
   Indirect Methods for Solving Systems of Linear Equations
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="solutions-to-tutorials-exercises">
<h1>Solutions to Tutorials Exercises<a class="headerlink" href="#solutions-to-tutorials-exercises" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<div class="section" id="initial-value-problems">
<h2>Initial Value Problems<a class="headerlink" href="#initial-value-problems" title="Permalink to this headline">¶</a></h2>
<p>Question 1. Using a pen and calculator (i.e., not Python), solve the following IVP using the Euler method with step length <span class="math notranslate nohighlight">\(h=0.4\)</span>. Write down your solution correct to 4 decimal places</p>
<div class="math notranslate nohighlight">
\[
y' = ty, \qquad t \in [0, 2], \qquad y(0) = 1.
\]</div>
<p><strong>Solution:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
y_0 &amp;=1, &amp; t_0 &amp;= 0, \\
y_1 &amp;= y_0 + ht_0y_0=1+0.4(0)(1) = 1, &amp; t_1&amp;=t_0+h=0+0.4=0.4,\\
y_2 &amp;= y_1 + ht_1y_1 = 1 + 0.4(0.4)(1) = 1.16, &amp; t_2&amp;=t_1+h=0.4+0.4=0.8, \\
y_3 &amp;= y_2 + ht_2y_2 = 1.16 + 0.4(0.8)(1.16) = 1.5312, &amp; t_3 &amp;=t_2 + h = 0.8 + 0.4 =1.2,\\
y_4 &amp;= y_3 + ht_3y_3 = 1.5312 + 0.4(1.2)(1.5312) = 2.2662, &amp; t_4 &amp;= t_3 + h=1.2+0.4 = 1.6, \\
y_5 &amp;= y_4 + ht_4y_4 = 2.2662 + 0.4(1.6)(2.2662) = 5.1724, &amp; t_5 &amp;= t_4 + h = 1.6 + 0.4 = 2.
\end{aligned}
\end{split}\]</div>
<p>Question 2. Reproduce your solutions to question 1 using Python.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Define ODE function</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span>  <span class="n">t</span><span class="o">*</span><span class="n">y</span>

<span class="c1"># Define IVP parameters</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># Solve IVP using the Euler method</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; t     RK2</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.2f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span> t     RK2
------------
0.00  1.0000
0.40  1.0000
0.80  1.1600
1.20  1.5312
1.60  2.2662
2.00  3.7165
</pre></div>
</div>
</div>
</div>
<p>Question 3. The exact solution to the IVP in question 1 is <span class="math notranslate nohighlight">\(y=e^{\frac{1}{2}t^2}\)</span>. Produce a plot of the Euler solution from question 2 against the exact solution.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot solution</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t1</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Solutions to the IVP $y&#39;=ty$, $y(0)=2$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8_exercise_solutions_5_0.png" src="_images/8_exercise_solutions_5_0.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="runge-kutta-methods">
<h2>Runge-Kutta Methods<a class="headerlink" href="#runge-kutta-methods" title="Permalink to this headline">¶</a></h2>
<p>Question 1. Write the following Runge-Kutta method in a Butcher tableau.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_{n+1} &amp;= y_n + \frac{h}{6}(k_1 + 4k_3 + k_4), \\
    k_1 &amp;= f(t_n, y_n), \\
    k_2 &amp;= f(t_n + \tfrac{1}{4}h, y_n + \tfrac{1}{4}hk_1), \\
    k_3 &amp;= f(t_n + \tfrac{1}{2}h, y_n + \tfrac{1}{2}hk_2), \\
    k_4 &amp;= f(t_n + h, y_n + h(k_1 - 2k_2 + 2k_3)).
\end{aligned}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cccc}
0 &amp; \\
\frac{1}{4} &amp; \frac{1}{4} \\
\frac{1}{2} &amp; 0 &amp; \frac{1}{2} \\
1 &amp; 1 &amp; -2 &amp; 2 \\ \hline
&amp; \frac{1}{6} &amp; 0 &amp; \frac{2}{3} &amp; \frac{1}{6}
\end{array}\end{split}\]</div>
<p>Question 2. Write out the equations for the following Runge-Kutta method.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cccc}
0 \\
\frac{1}{4} &amp; \frac{1}{4} \\
\frac{1}{2} &amp; -\frac{1}{2} &amp; 1 \\
1 &amp; \frac{1}{4} &amp; 0 &amp; \frac{3}{4} \\ \hline
&amp; 0 &amp; \frac{4}{9} &amp; \frac{1}{3} &amp; \frac{2}{9}
\end{array}\end{split}\]</div>
<p><strong>Solution:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
y_{n+1} &amp;= y_n + \frac{h}{9}(4k_2 + 3k_3 + 2k_4), \\
k_1 &amp;= f(t_n, y_n), \\
k_2 &amp;= f(t_n + \tfrac{1}{4}h, y_n + \tfrac{1}{4}hk_1), \\
k_3 &amp;= f(t_n + \tfrac{1}{2}h, y_n + h(-\tfrac{1}{2}k_1 + k_2)), \\
k_4 &amp;= f(t_n + h, y_n + h(\tfrac{1}{4}k_1 + \tfrac{3}{4}k_3)).
\end{aligned} \end{split}\]</div>
<p>Question 3. Derive an explicit second-order Runge-Kutta method such that <span class="math notranslate nohighlight">\(b_1 = \tfrac{1}{3}\)</span>. Express your solution as a Butcher tableau.</p>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">a21</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;b1, b2, c1, c2, a21&#39;</span><span class="p">)</span>

<span class="n">b1</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 3&#39;</span><span class="p">)</span>

<span class="n">eqn1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span>
<span class="n">eqn3</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span>

<span class="n">solve</span><span class="p">((</span><span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[{a21: 3/4, b2: 2/3, c2: 3/4}]
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|cc}
0 &amp; 0 \\
\frac{3}{4} &amp; \frac{3}{4} \\ \hline
&amp; \frac{1}{3} &amp; \frac{2}{3}
\end{array}
\end{split}\]</div>
<p>Question 4. Derive an explicit fourth-order Runge-Kutta method such that <span class="math notranslate nohighlight">\(b_1=0\)</span> and <span class="math notranslate nohighlight">\(c_2 = \tfrac{1}{5}\)</span>. Write your answer in the form of a Butcher tableau.</p>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialise symbolic variables</span>
<span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b3</span><span class="p">,</span> <span class="n">b4</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;b1, b2, b3, b4&#39;</span><span class="p">)</span>
<span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;c2, c3, c4&#39;</span><span class="p">)</span>
<span class="n">a31</span><span class="p">,</span> <span class="n">a32</span><span class="p">,</span> <span class="n">a41</span><span class="p">,</span> <span class="n">a42</span><span class="p">,</span> <span class="n">a43</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a31, a32, a41, a42, a43&#39;</span><span class="p">)</span>
<span class="n">b1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 5&#39;</span><span class="p">)</span>

<span class="c1"># Define order conditions</span>
<span class="n">eqn1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">+</span> <span class="n">b3</span> <span class="o">+</span> <span class="n">b4</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">c3</span> <span class="o">+</span> <span class="n">b4</span> <span class="o">*</span> <span class="n">c4</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span>
<span class="n">eqn3</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">c3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b4</span> <span class="o">*</span> <span class="n">c4</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 3&#39;</span><span class="p">)</span>
<span class="n">eqn4</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">c3</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b4</span> <span class="o">*</span> <span class="n">c4</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 4&#39;</span><span class="p">)</span>
<span class="n">eqn5</span> <span class="o">=</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">c3</span> <span class="o">*</span> <span class="n">a32</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">b4</span> <span class="o">*</span> <span class="n">c4</span> <span class="o">*</span> <span class="p">(</span><span class="n">a42</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">a43</span> <span class="o">*</span> <span class="n">c3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 8&#39;</span><span class="p">)</span>
<span class="n">eqn6</span> <span class="o">=</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">a32</span> <span class="o">+</span> <span class="n">b4</span> <span class="o">*</span> <span class="n">a42</span> <span class="o">-</span> <span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c2</span><span class="p">)</span>
<span class="n">eqn7</span> <span class="o">=</span> <span class="n">b4</span> <span class="o">*</span> <span class="n">a43</span> <span class="o">-</span> <span class="n">b3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c3</span><span class="p">)</span>
<span class="n">eqn8</span> <span class="o">=</span> <span class="n">b4</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c4</span><span class="p">)</span>
<span class="n">eqn9</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">a21</span>
<span class="n">eqn10</span> <span class="o">=</span> <span class="n">c3</span> <span class="o">-</span> <span class="n">a31</span> <span class="o">-</span> <span class="n">a32</span>
<span class="n">eqn11</span> <span class="o">=</span> <span class="n">c4</span> <span class="o">-</span> <span class="n">a41</span> <span class="o">-</span> <span class="n">a42</span> <span class="o">-</span> <span class="n">a43</span>

<span class="c1"># Solve system</span>
<span class="n">solve</span><span class="p">((</span><span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span><span class="p">,</span> <span class="n">eqn4</span><span class="p">,</span> <span class="n">eqn5</span><span class="p">,</span> <span class="n">eqn6</span><span class="p">,</span> <span class="n">eqn7</span><span class="p">,</span> <span class="n">eqn8</span><span class="p">,</span> <span class="n">eqn9</span><span class="p">,</span> <span class="n">eqn10</span><span class="p">,</span> <span class="n">eqn11</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[{a21: 1/5,
  a31: -31/32,
  a32: 55/32,
  a41: 9,
  a42: -120/11,
  a43: 32/11,
  b2: 125/264,
  b3: 16/33,
  b4: 1/24,
  c3: 3/4,
  c4: 1}]
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cccc}
0 \\
\frac{1}{5} &amp; \frac{1}{5} \\
\frac{3}{4} &amp; -\frac{31}{32} &amp; \frac{55}{32} \\
1 &amp; 9 &amp; -\frac{120}{11} &amp; \frac{32}{11} \\ \hline
&amp; \frac{1}{5} &amp; \frac{125}{264} &amp; \frac{16}{33} &amp; \frac{1}{24}
\end{array}\end{split}\]</div>
<p>Question 5. Using pen and a calculator and working to 4 decimal places, apply your Runge-Kutta method derived in question 3 to solve the following IVP using a step length of <span class="math notranslate nohighlight">\(h=0.4\)</span></p>
<div class="math notranslate nohighlight">
\[
    y' = ty, \qquad t \in [0, 2], \qquad y(0) = 1.
\]</div>
<p><strong>Solution:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
k_1 &amp;= t_0y_0 = 0(1) = 0, \\
k_2 &amp;= (t_0+c_2h)(y_0 + a_{12}hk_1) = \left(0 + \frac{3}{4}(0.4)\right)\left(1 + \frac{3}{4}(0.4)(0)\right) = 0.3,\\
y_1 &amp;= y_0 + \frac{h}{3}(k_1 + 2k_2) = 1 + \frac{0.4}{3}(0 +0.3 ) = 1.08,\\
 t_1 &amp;= t_0 + h = 0 + 0.4 = 0.4, \\
\\
k_1 &amp;= t_1y_1 = (0.4)(1.08) = 0.432, \\
k_2 &amp;= (t_1 + c_2h)(y_1+a_{21}hk_1) = \left( 0.4 + \frac{3}{4}(0.4)\right)\left(1.08 + \frac{3}{4}(0.4)(0.432)\right) = 0.8467, \\
y_2 &amp;= y_1 + \frac{h}{3}(k_1 + 2k_2) = 1.08 + \frac{0.4}{3}(0.432 + 2(0.8467)) = 1.3634,\\
 t_2 &amp;= t_1 + h = 0.4 + 0.4 = 0.8, \\
\\
k_1 &amp;= t_2y_2 = 0.8(1.3634) = 1.0907, \\
k_2&amp;= (t_2 + c_2h)(y_2 + a_{21}hk_1) = \left(0.8 + \frac{3}{4}(0.4)\right)\left(1.3634 + \frac{3}{4}(0.4)(1.0907)\right) = 1.8597, \\
y_3 &amp;= y_2 + \frac{h}{3}(k_1 + 2k_2) = 1.3634 + \frac{0.4}{3}(1.0907 + 2(1.8597)) = 2.0047, \\
 t_3 &amp;= t_2 + h = 0.8 + 0.4 = 1.2, \\
\\
k_1 &amp;= t_3y_3 = 1.2(2.0047) = 2.4057, \\
k_2 &amp;= (t_3 + c_2h)(y_3 + a_{21}hk_1) = \left(1.2 + \frac{3}{4}(0.4)\right)\left(2.0047 + \frac{3}{4}(0.4)(2.4057)\right) = 4.0897, \\
y_4 &amp;= y_3 + \frac{h}{3}(k_1 + 2k_2) = 2.0047 + \frac{0.4}{3}(2.4057 + 2(4.0897)) = 3.4161, \\
 t_4 &amp;=t_3 + h = 1.2 + 0.4 = 1.6, \\
\\
k_1 &amp;= t_4y_4 = 1.6(3.4161), \\
k_2 &amp;= (t_4 + c_2h)(y_4 + a_{21}hk_1) = \left(1.6 + \frac{3}{4}(0.4)\right)\left(3.4161 + \frac{3}{4}(0.4)(3.4161)\right) = 9.6060, \\
y_5 &amp;= y_4 + \frac{h}{3}(k_1 + 2k_2) = 3.4161 + \frac{0.4}{3}(5.4647 + 2(9.6060)) = 6.7064, \\
t_5 &amp;= t_4 + h = 1.6 + 0.4 = 2.
\end{aligned}
\end{split}\]</div>
<p>Question 6. Repeat question 5 using the RK4 method (the RK4 method is derived in example 4).</p>
<p><strong>Solution:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
k_1 &amp;= t_0y_0 = 0(1) = 0, \\
k_2 &amp;= (t_0 + c_2h)(y_0 + a_{21}hk_1) = \left(0 + \frac{1}{2}(0.4)\right)\left(1 + \frac{1}{2}(0.4)(0)\right) = 0.2, \\
k_3 &amp;= (t_0 + c_3h)(y_0 + h(a_{31}k_1 + a_{32}k_2)) = \left(0 + \frac{1}{2}(0.4)\right)\left(1 + \frac{1}{2}(0.4)(0.2)\right)=0.2080, \\
k_4 &amp;= (t_0 + c_4h)(y_0 + h(a_{41}k_1 + a_{42}k_2 + a_{43}k_3)) = \left(0 + 0.4)\right)\left(1 + 0.4(0.2080)\right) = 0.4333, \\
y_1 &amp;= y_0 + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4) = 1 + \frac{0.4}{6}(0 + 2(0.2) + 2(0.2080) + 0.4333) = 1.0833, \\
t_1 &amp;= t_0 + h = 0 + 0.4 = 0.4,\\
\\
k_1 &amp;= t_1y_1 = 0.4(1.0833) = 0.4333, \\
k_2 &amp;= (t_1 + c_2h)(y_1 + a_{21}hk_1) = \left(0.4 + \frac{1}{2}(0.4)\right)\left(1.0833 + \frac{1}{2}(0.4)(0.4333)\right) = 0.7020, \\
k_3 &amp;= (t_1 + c_3h)(y_1 + h(a_{31}k_1 + a_{32}k_2)) = \left(0.4 + \frac{1}{2}(0.4)\right)\left(1.0833 + \frac{1}{2}(0.4)(0.7020)\right)=0.7342, \\
k_4 &amp;= (t_1 + c_4h)(y_1 + h(a_{41}k_1 + a_{42}k_2 + a_{43}k_3)) = \left(0.4 + 0.4\right)\left(1.0833 + 0.4(0.7342)\right) = 1.1016, \\
y_2 &amp;= y_1 + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4) = 1.0833 + \frac{0.4}{6}(04333 + 2(0.7020) + 2(0.7342) + 1.1016) = 1.3771, \\
t_2 &amp;= t_1 + h = 0.4 + 0.4 = 0.8,\\
\\
k_1 &amp;= t_2y_2 = 0.8(1.3771) = 1.1017, \\
k_2 &amp;= (t_2 + c_2h)(y_2 + a_{21}hk_1) = \left(0.8 + \frac{1}{2}(0.4)\right)\left(1.3771 + \frac{1}{2}(0.4)(1.1017)\right) = 1.5974, \\
k_3 &amp;= (t_2 + c_3h)(y_2 + h(a_{31}k_1 + a_{32}k_2)) = \left(0.8 + \frac{1}{2}(0.4)\right)\left(1.3771 + \frac{1}{2}(0.4)(1.5974)\right)=1.6966, \\
k_4 &amp;= (t_2 + c_4h)(y_2 + h(a_{41}k_1 + a_{42}k_2 + a_{43}k_3)) = \left(0.8 + 0.4\right)\left(1.3771 + 0.4(1.6966)\right) = 2.4669, \\
y_3 &amp;= y_2 + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4) = 1.3771 + \frac{0.4}{6}(1.1017+ 2(1.5974) + 2(1.6966) + 2.4669) = 2.0542, \\
t_3 &amp;= t_2 + h = 0.8 + 0.4 = 1.2,\\
\\
k_1 &amp;= t_3y_3 = 1.2(2.0542) = 2.4561, \\
k_2 &amp;= (t_3 + c_2h)(y_3 + a_{21}hk_1) = \left(1.2 + \frac{1}{2}(0.4)\right)\left(2.0542 + \frac{1}{2}(0.4)(2.4651)\right) = 3.5661, \\
k_3 &amp;= (t_3 + c_3h)(y_3 + h(a_{31}k_1 + a_{32}k_2)) = \left(1.2 + \frac{1}{2}(0.4)\right)\left(2.0542 + \frac{1}{2}(0.4)(3.5661)\right)=3.8744, \\
k_4 &amp;= (t_3 + c_4h)(y_3 + h(a_{41}k_1 + a_{42}k_2 + a_{43}k_3)) = \left(1.2 + 0.4\right)\left(2.0542 + 0.4(3.8744)\right) = 5.7664, \\
y_4 &amp;= y_3 + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4) = 2.0542 + \frac{0.4}{6}(2.4561 + 2(3.5661) + 2(3.8744) + 5.7664) = 3.5950, \\
t_4 &amp;= t_3 + h = 1.2 + 0.4 = 1.6,\\
\\
k_1 &amp;= t_4y_4 = 1.6(3.5950) = 5.7521, \\
k_2 &amp;= (t_4 + c_2h)(y_4 + a_{21}hk_1) = \left(1.6 + \frac{1}{2}(0.4)\right)\left(3.5950 + \frac{1}{2}(0.4)(5.7521)\right) = 8.5418, \\
k_3 &amp;= (t_4 + c_3h)(y_4 + h(a_{31}k_1 + a_{32}k_2)) = \left(1.2 + \frac{1}{2}(0.4)\right)\left(3.5950 + \frac{1}{2}(0.4)(8.5418)\right)= 9.5461, \\
k_4&amp;= (t_4 + c_4h)(y_4 + h(a_{41}k_1 + a_{42}k_2 + a_{43}k_3)) = \left(1.2 + 0.4\right)\left(3.5950 + 0.4(9.5461)\right) = 14.8270, \\
y_5 &amp;= y_4 + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4) = 3.5950 + \frac{0.4}{6}(5.7521 + 2(8.5418) + 2(9.5461) + 14.8270) = 7.3787, \\
t_5 &amp;= t_4 + h = 1.6 + 0.4 = 2,
\end{aligned} \end{split}\]</div>
<p>Question 7. Repeat question 5 using Python. The exact solution to this IVP is <span class="math notranslate nohighlight">\(y=e^{t^2/2}\)</span>. Produce a table comparing the numerical and exact solutions. Produce a plot of the numerical solutions and exact solution on the same set of axes.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>

<span class="c1"># Define IVP parameters</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># Invoke the RK2 method to solve IVP</span>
<span class="n">t1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">rk2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; t     RK2    Exact</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.2f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>
    
<span class="c1"># Plot solutions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">t3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t3</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t3</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact solution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;RK2&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Solution to the IVP $y&#39;=ty$, $y(0) = 1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span> t     RK2    Exact
--------------------
0.00  1.0000  1.0000
0.40  1.0000  1.0209
0.80  1.1600  1.1620
1.20  1.5312  1.5390
1.60  2.2662  2.2583
2.00  3.7165  3.2845
</pre></div>
</div>
<img alt="_images/8_exercise_solutions_12_1.png" src="_images/8_exercise_solutions_12_1.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="implicit-runge-kutta-methods">
<h2>Implicit Runge-Kutta Methods<a class="headerlink" href="#implicit-runge-kutta-methods" title="Permalink to this headline">¶</a></h2>
<p>Question 1. Show that the Radau IA method derived in example 3 is a third-order method.</p>
<p><strong>Solution:</strong> The Radau IA method is</p>
<div class="math notranslate nohighlight">
\[A = \pmatrix{0 &amp; 0 \cr \frac{1}{3} &amp; \frac{1}{3}}, \qquad \mathbf{b} = \pmatrix{\frac{1}{4} \cr \frac{3}{4}}, \qquad \mathbf{c} = \pmatrix{0 \cr \frac{2}{3}}.\]</div>
<p>Check the <span class="math notranslate nohighlight">\(B(k)\)</span> condition</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lll}
j = 1: &amp; LHS = b_1 + b_2 = \frac{1}{4} + \frac{3}{4} = 1, &amp; RHS = 1, \\
j = 2 : &amp; LHS = b_1c_1 + b_2c_2 = \frac{1}{4}(0) + \frac{3}{4}\left(\frac{2}{3}\right) = \frac{1}{2}, &amp; RHS = \frac{1}{2}, \\
j = 3 : &amp; LHS = b_1c_1^2 + b_2c_2^2 = \frac{1}{4}(0)^2 + \frac{3}{4}\left(\frac{2}{3}\right)^2 = \frac{1}{3}, &amp; RHS = \frac{1}{3}, \\
j = 4 : &amp; LHS = b_1c_1^3 + b_2c_2^3 = \frac{1}{4}(0)^2 + \frac{3}{4}\left(\frac{2}{3}\right)^3 = \frac{2}{9}, &amp; RHS = \frac{1}{4}.
\end{array}\end{split}\]</div>
<p>So this IRK method can be upto order <span class="math notranslate nohighlight">\(k=3\)</span>. Since <span class="math notranslate nohighlight">\(\lfloor \frac{3}{2} \rfloor=1\)</span> check the <span class="math notranslate nohighlight">\(C(1)\)</span> condition:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lll}
j = 1: &amp; LHS = a_{11} + a_{12} = 0 + 0 = 0, &amp; RHS = c_1 = 0, \\
j = 2: &amp; LHS = a_{21} + a_{22} = \frac{1}{3} + \frac{1}{3} = \frac{2}{3}, &amp; RHS = \frac{2}{3}.
\end{array}\end{split}\]</div>
<p>So the <span class="math notranslate nohighlight">\(C(1)\)</span> condition is satisfied. Check the <span class="math notranslate nohighlight">\(D(1)\)</span> condition</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lll}
i = 1: &amp; LHS = a_{11}b_1 + a_{21}b_2 = 0\left(\frac{1}{4}\right)+\frac{1}{3}\left(\frac{3}{4}\right) = \frac{1}{4}, &amp; RHS = b_1 (1 - c_1) = \frac{1}{4}(1 - 0) = \frac{1}{4}, \\
i = 2: &amp; LHS = a_{12}b_1 + a_{22}b_2 = 0\left(\frac{1}{4}\right) + \frac{1}{3}\left(\frac{3}{4}\right) = \frac{1}{4}, &amp; RHS= b_2(1 - c_2) = \frac{3}{4}\left(1 - \frac{2}{3}\right) = \frac{1}{4}.
\end{array}\end{split}\]</div>
<p>Since <span class="math notranslate nohighlight">\(C(3)\)</span>, <span class="math notranslate nohighlight">\(C(1)\)</span> and <span class="math notranslate nohighlight">\(D(1)\)</span> conditions are satisfied then this is a third-order IRK method.</p>
<p>Question 2. Determine the order of the following IRK method</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
\begin{array}{c|ccc}
0 &amp; 0 &amp; 0 \\
\frac{1}{2} &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 \\ \hline
&amp; \frac{1}{6} &amp; \frac{2}{3} &amp; \frac{1}{6}
\end{array}
\end{aligned} \end{split}\]</div>
<p><strong>Solution:</strong> Check the <span class="math notranslate nohighlight">\(B(k)\)</span> condition:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lll}
j = 1: &amp; LHS = b_1 + b_2 + b_3 = \frac{1}{6} + \frac{2}{3} + \frac{1}{6} = 1, &amp; RHS = 1, \\
j = 2: &amp; LHS = b_1c_1 + b_2c_2 + b_3c_3 = \frac{1}{6}(0) + \frac{2}{3}\left(\frac{1}{2}\right) + \frac{1}{6}(1) = \frac{1}{2}, &amp; RHS = \frac{1}{2}, \\
j = 3: &amp; LHS = b_1c_1^2 + b_2c_2^2 + b_3c_3^2 = \frac{1}{6}(0)^2 + \frac{2}{3}\left(\frac{1}{2}\right)^2 + \frac{1}{6}(1)^2 = \frac{1}{3}, &amp; RHS = \frac{1}{3} , \\
j = 4: &amp; LHS = b_1c_1^3 + b_2c_2^3 + b_3c_3^3 = \frac{1}{6}(0)^3 + \frac{2}{3}\left(\frac{1}{2}\right)^3 + \frac{1}{6}(1)^3 = \frac{1}{4}, &amp; RHS = \frac{1}{4},  \\
j = 5: &amp; LHS = b_1c_1^4 + b_2c_2^4 + b_3c_3^4 = \frac{1}{6}(0)^3 + \frac{2}{3}\left(\frac{1}{2}\right)^4 + \frac{1}{6}(1)^4 = \frac{5}{24}, &amp; RHS = \frac{1}{5}.
\end{array}\end{split}\]</div>
<p>So this IRK method can be up to order 4. Check the <span class="math notranslate nohighlight">\(C(2)\)</span> condition:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{llll}
\ell = 1, &amp; i = 1: &amp; LHS = a_{11} + a_{12} + a_{13} = 0 + 0 + 0 = 0, &amp; RHS = 0, \\
&amp; i = 2 : &amp; LHS = a_{21} + a_{22} + a_{32} = \frac{1}{4} + \frac{1}{4} + 0 = \frac{1}{2}, &amp; RHS =  \frac{1}{2}, \\
&amp; i = 3 : &amp; LHS = a_{31} + a_{32} + a_{33} = 0 + 1 + 0 = 1, &amp; RHS = 1, \\
\ell = 2, &amp; i = 1 : &amp; LHS = a_{11}c_1 + a_{12}c_2 + a_{13}c_3 = 0(0) + 0\left(\frac{1}{2}\right) + 0(1) = 0, &amp; RHS = \frac{1}{2}c_1^2 = \frac{1}{2}(0)^2 = 0, \\
&amp; i = 2: &amp; LHS = a_{21}c_1 + a_{22}c_2 + a_{23}c_3 = \frac{1}{4}(0) + \frac{1}{4}\left(\frac{1}{2}\right) + 0(1) = \frac{1}{8}, &amp; RHS = \frac{1}{2}c_2^2 = \frac{1}{2}\left(\frac{1}{2}\right)^2 = \frac{1}{8}, \\
&amp; i = 3: &amp; LHS = a_{31}c_1 + a_{32}c_2 + a_{33}c_3 = 0(0) + 1\left(\frac{1}{2}\right) + 0(1) = \frac{1}{2}, &amp; RHS = \frac{1}{2}(c_3)^2 = \frac{1}{3}(1)^2 = \frac{1}{3}.
\end{array}\end{split}\]</div>
<p>Since the <span class="math notranslate nohighlight">\(C(k)\)</span> condition is only satisfied up to <span class="math notranslate nohighlight">\(k=1\)</span> then this IRK method can be up to order  3. Check the <span class="math notranslate nohighlight">\(D(1)\)</span> condition:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lll}
j = 1: &amp; LHS = b_1a_{11} + b_2a_{21} + b_3a_{31} = \frac{1}{6}(0) + \frac{2}{3}\left(\frac{1}{4}\right) + \frac{1}{6}(0) = \frac{1}{6}, &amp; RHS = b_1(1 - c_1) = \frac{1}{6}(1 -0) = \frac{1}{6}, \\
j = 2 : &amp; LHS = b_1a_{12} + b_2a_{22} + b_3a_{32} = \frac{1}{6}(0) + \frac{2}{3}\left(\frac{1}{4}\right) + \frac{1}{6}(1) = \frac{1}{3}, &amp; RHS = b_2 (1 - c_2) = \frac{2}{3}\left(1 - \frac{1}{2}\right) = \frac{1}{3}, \\
j = 3: &amp; LHS = b_1a_{13} + b_2a_{23} + b_3a_{33} = \frac{1}{6}(0) + \frac{1}{2}(0) + 1(0) = 0, &amp; RHS = b_3(1 - c_3) = \frac{1}{6}(1 - 1) = 0.
\end{array}\end{split}\]</div>
<p>So the <span class="math notranslate nohighlight">\(D(1)\)</span> condition is satisfied so this IRK method is a third-order method.</p>
<p>Question 3. Derive a third-order Radau IIA method.</p>
<p><strong>Solution:</strong> An <span class="math notranslate nohighlight">\(s\)</span>-stage Radau method has order <span class="math notranslate nohighlight">\(k=2s-1\)</span> so <span class="math notranslate nohighlight">\(k=2\)</span>. Let <span class="math notranslate nohighlight">\(c_2=1\)</span> and choose <span class="math notranslate nohighlight">\(c_1\)</span> to be the root of <span class="math notranslate nohighlight">\(P_2(t)-P_1(5) = 3t^2 - 4t + 1\)</span> which is <span class="math notranslate nohighlight">\(c_1=\frac{1}{3}\)</span>.</p>
<p>The <span class="math notranslate nohighlight">\(B(2)\)</span> and <span class="math notranslate nohighlight">\(C(1)\)</span> order conditions are:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
b_1 + b_2 &amp;= 1, \\
b_1c_1 + b_2c_2 &amp;= \frac{1}{2},\\
a_{11} + a_{12} &amp;= c_1, \\
a_{21} + a_{22} &amp;= c_2, \\
a_{11}b_1 + a_{12}b_2 &amp;= \frac{1}{2}c_1^2, \\
a_{21} b_1 + a_{22} b_2 &amp;= \frac{1}{2}c_2^2.
\end{aligned} \end{split}\]</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define symbolic variables</span>
<span class="n">t</span><span class="p">,</span> <span class="n">a11</span><span class="p">,</span> <span class="n">a12</span><span class="p">,</span> <span class="n">a21</span><span class="p">,</span> <span class="n">a22</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t, a11, a12, a21, a22, b1, b2, c1, c2&#39;</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Define order conditions</span>
<span class="n">eqn1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span>
<span class="n">eqn3</span> <span class="o">=</span> <span class="n">a11</span> <span class="o">+</span> <span class="n">a12</span> <span class="o">-</span> <span class="n">c1</span>
<span class="n">eqn4</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">+</span> <span class="n">a22</span> <span class="o">-</span> <span class="n">c2</span>
<span class="n">eqn5</span> <span class="o">=</span> <span class="n">a11</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">a12</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">eqn6</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">a22</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># Solve system</span>
<span class="n">solve</span><span class="p">((</span><span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span><span class="p">,</span> <span class="n">eqn4</span><span class="p">,</span> <span class="n">eqn5</span><span class="p">,</span> <span class="n">eqn6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>{a11: 5/12, a12: -1/12, a21: 3/4, a22: 1/4, b1: 3/4, b2: 1/4}
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
\frac{1}{3} &amp; \frac{5}{12} &amp; -\frac{1}{12} \\
1 &amp; \frac{3}{4} &amp; \frac{1}{4} \\ \hline
&amp; \frac{3}{4} &amp; \frac{1}{4}
\end{array}\end{split}\]</div>
<p>Question 4. Derive a two-stage second-order SDIRK method with <span class="math notranslate nohighlight">\(c_1=\frac{1}{4}\)</span>.</p>
<p><strong>Solution:</strong> Since <span class="math notranslate nohighlight">\(c_1=\frac{1}{4}\)</span> then <span class="math notranslate nohighlight">\(a_{11} =a_{22} = \frac{1}{4}\)</span> and <span class="math notranslate nohighlight">\(a_{12}=0\)</span> then the <span class="math notranslate nohighlight">\(B(2)\)</span> and <span class="math notranslate nohighlight">\(D(1)\)</span> order conditions are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
b_1 + b_2 &amp;= 1, \\
b_1c_1 + b_2c_2 &amp;= \frac{1}{2}, \\
a_{21} + c_1 &amp;= c_2, \\
b_1c_1 + b_2a_{21}&amp;= b_1(1 - c_1), \\
b_2c_1 &amp;= b_2(1-c_2).
\end{aligned}\end{split}\]</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define symbolic variables</span>
<span class="n">a21</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a21, b1, b2, c1, c2&#39;</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 4&#39;</span><span class="p">)</span>

<span class="c1"># Define order conditions</span>
<span class="n">eqn1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span>
<span class="n">eqn3</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">-</span> <span class="n">c2</span>
<span class="n">eqn4</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">a21</span> <span class="o">-</span> <span class="n">b1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c1</span><span class="p">)</span>
<span class="n">eqn5</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">-</span> <span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c2</span><span class="p">)</span>

<span class="c1"># Solve system</span>
<span class="n">solve</span><span class="p">((</span><span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span><span class="p">,</span> <span class="n">eqn4</span><span class="p">,</span> <span class="n">eqn5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[{a21: 1/2, b1: 1/2, b2: 1/2, c2: 3/4}]
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
\frac{1}{4} &amp; \frac{1}{4} &amp; 0 \\
\frac{3}{4} &amp; \frac{1}{2} &amp; \frac{1}{4} \\ \hline
&amp; \frac{1}{2} &amp; \frac{1}{2}
\end{array}\end{split}\]</div>
<p>Question 5. Using pen and a calculator and working to 4 decimal places, calculate the first step of your IRK method derived in question 4 to solve the following IVP using a step length of <span class="math notranslate nohighlight">\(h=0.4\)</span></p>
<div class="math notranslate nohighlight">
\[
    y' = ty, \qquad t \in [0, 2], \qquad y(0) = 1.
\]</div>
<p><strong>Solution:</strong></p>
<p><span class="math notranslate nohighlight">\(y_0=1\)</span> and <span class="math notranslate nohighlight">\(t_0=0\)</span> and using the Jacobi method with starting values <span class="math notranslate nohighlight">\(Y^0=(1,1)^T\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
Y^1 &amp;= y_0 + hAf(t_0+\mathbf{c}h, Y^0) = 1 + 0.4\pmatrix{\frac{1}{4} &amp; 0 \cr \frac{1}{2} &amp; \frac{1}{4}} \pmatrix{ \left(0 + \frac{1}{4}(0.4)\right)(1) \cr \left(0 + \frac{3}{4}(0.4)\right)(1)} = \pmatrix{1.01 \cr 1.05}, \\
Y^2 &amp;= y_0 + hAf(t_0+\mathbf{c}h, Y^1) = 1 + 0.4\pmatrix{\frac{1}{4} &amp; 0 \cr \frac{1}{2} &amp; \frac{1}{4}} \pmatrix{\left( 0 + \frac{1}{4}(0.4)\right)(1.01) \cr \left(0 + \frac{3}{4}(0.4)\right)(1.05)} = \pmatrix{1.0101 \cr 1.0517}, \\
Y^3 &amp;=  y_0 + hAf(t_0+\mathbf{c}h, Y^2) = 1 + 0.4\pmatrix{\frac{1}{4} &amp; 0 \cr \frac{1}{2} &amp; \frac{1}{4}} \pmatrix{\left( 0 + \frac{1}{4}(0.4)\right)(1.0101) \cr \left(0 + \frac{3}{4}(0.4)\right)(1.0517)} = \pmatrix{1.0101 \cr 1.0518}, \\
Y^4 &amp;=  y_0 + hAf(t_0+\mathbf{c}h, Y^3) = 1 + 0.4\pmatrix{\frac{1}{4} &amp; 0 \cr \frac{1}{2} &amp; \frac{1}{4}} \pmatrix{\left( 0 + \frac{1}{4}(0.4)\right)(1.0101) \cr \left(0 + \frac{3}{4}(0.4)\right)(1.0518)} = \pmatrix{1.0101 \cr 1.0518}.
\end{aligned}\end{split}\]</div>
<p>Calculate <span class="math notranslate nohighlight">\(y_1\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
y_1 &amp;= y_0 + h(b_1f(t_0+c_1h, Y_1) + b_2f(t_0+c_2h, Y_2)) \\
&amp;= 1 + \frac{0.4}{2}\left(\left(0 + \frac{1}{4}(0.4)\right)(1.0101) + \left(0 +\frac{3}{4}(0.4)\right)(1.0518)\right) = 1.0833.
\end{aligned}\end{split}\]</div>
<p>Question 6. The exact solution to the IVP in question 5 is <span class="math notranslate nohighlight">\(y=e^{t^2/2}\)</span>. Using Python repeat question 5 for the full domain and produce a table comparing the numerical and exact solutions and plot the numerical solutions and exact solutions on the same set of axes.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">*</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Define IRK method</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span> <span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Define IVP parameters</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># Solve IVP using the IRK method</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">irk</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; t     RK2    Exact</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.2f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>

<span class="c1"># Plot solutions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t1</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;IRK&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Solution to the IVP $y&#39;=\sin^2(t)y$, $y(0) = 1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span> t     RK2    Exact
--------------------
0.00  1.0000  1.0000
0.40  1.0833  1.0833
0.80  1.3776  1.3771
1.20  2.0580  2.0544
1.60  3.6164  3.5966
2.00  7.4893  7.3891
</pre></div>
</div>
<img alt="_images/8_exercise_solutions_19_1.png" src="_images/8_exercise_solutions_19_1.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="stability">
<h2>Stability<a class="headerlink" href="#stability" title="Permalink to this headline">¶</a></h2>
<p>Question 1. Determine the stability function of the following Runge-Kutta method</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|ccccc}
0 \\
\frac{1}{4} &amp; \frac{1}{4} \\
\frac{1}{2} &amp; \frac{1}{2} &amp; 0 \\
\frac{3}{4} &amp; \frac{1}{2} &amp; \frac{1}{4} \\
0 &amp; 0 &amp; \frac{1}{6} &amp; -\frac{1}{3} &amp; \frac{1}{6} \\ \hline
&amp; -1 &amp; \frac{2}{3} &amp; -\frac{1}{3} &amp; \frac{2}{3} &amp; 1
\end{array}\end{split}\]</div>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define ERK method</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/4&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/2&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/2&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/4&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/6&#39;</span><span class="p">),</span> <span class="o">-</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/3&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/6&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;2/3&#39;</span><span class="p">),</span> <span class="o">-</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/3&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;2/3&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]])</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Determine stability function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R(z) = 1&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)):</span>
    <span class="n">coeff</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span><span class="o">**</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; + </span><span class="si">{}</span><span class="s2"> z**</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>R(z) = 1 + 1 z**1 + 1/2 z**2 + 1/24 z**3 + 1/96 z**4 + 0 z**5
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[R(z) = 1 + z + \frac{1}{2} z^2 + \frac{1}{24} z^3 + \frac{1}{96} z^4\]</div>
<p>Question 2. Determine the stability function of the following Runge-Kutta method. Is this an A-stable method?</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
\frac{1}{4} &amp; \frac{7}{24} &amp; -\frac{1}{24} \\
\frac{3}{4} &amp; \frac{13}{24} &amp; \frac{5}{24} \\  \hline
&amp; \frac{1}{2} &amp; \frac{1}{2}
\end{array}\end{split}\]</div>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define IRK method</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;7 / 24&#39;</span><span class="p">),</span> <span class="o">-</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 24&#39;</span><span class="p">)</span> <span class="p">],</span>
           <span class="p">[</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;13 / 24&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;5 / 24&#39;</span><span class="p">)</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">),</span> <span class="mi">0</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span> <span class="p">]])</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Calculate P(z) and Q(z) polynomials</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="n">z</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">b</span><span class="p">)))</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="n">z</span> <span class="o">*</span> <span class="n">A</span><span class="p">))</span>

<span class="c1"># Find roots of Q(z)</span>
<span class="n">roots</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

<span class="c1"># Calculate E(y)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">Pp</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">b</span><span class="p">)))</span>
<span class="n">Pm</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">b</span><span class="p">)))</span>
<span class="n">Qp</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">A</span><span class="p">))</span>
<span class="n">Qm</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">A</span><span class="p">))</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">Qp</span> <span class="o">*</span> <span class="n">Qm</span> <span class="o">-</span> <span class="n">Pp</span> <span class="o">*</span> <span class="n">Pm</span><span class="p">)</span>

<span class="c1"># Output polynomials</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P(z) = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q(z) = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q(z) has roots at </span><span class="si">{}</span><span class="s2"> and </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">roots</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">roots</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;E(y) = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>P(z) = z**2/12 + z/2 + 1
Q(z) = z**2/12 - z/2 + 1
Q(z) has roots at 3 - sqrt(3)*I and 3 + sqrt(3)*I
E(y) = 0
</pre></div>
</div>
</div>
</div>
<p>The stability function is</p>
<div class="math notranslate nohighlight">
\[R(z) = \frac{1 + \frac{1}{2}z + \frac{1}{12}z^2}{1 - \frac{1}{2}z + \frac{1}{12}z^2}\]</div>
<p>The roots of <span class="math notranslate nohighlight">\(Q(z)\)</span> are <span class="math notranslate nohighlight">\(3 \pm \sqrt{3}i\)</span> and <span class="math notranslate nohighlight">\(E(y)=0\)</span> therefore this is an A-stable method.</p>
<p>Question 3. Plot the region of absolute stability for the following Runge-Kutta method.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
\frac{1}{3} &amp; \frac{1}{3} &amp; 0 \\
1 &amp; 1 &amp; 0 \\ \hline
&amp; \frac{3}{4} &amp; \frac{1}{4}
\end{array}\end{split}\]</div>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define IRK method</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 3&#39;</span><span class="p">),</span> <span class="mi">0</span> <span class="p">],</span>
           <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;3 / 4&#39;</span><span class="p">),</span> <span class="mi">0</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 4&#39;</span><span class="p">)</span> <span class="p">]])</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Calculate P(z) and Q(z) polynomials</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="n">z</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">b</span><span class="p">)))</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="n">z</span> <span class="o">*</span> <span class="n">A</span><span class="p">))</span>

<span class="c1"># Output polynomials</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P(z) = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q(z) = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>P(z) = 5*z**2/48 + 2*z/3 + 1
Q(z) = 1 - z/3
</pre></div>
</div>
</div>
</div>
<p>The stability function for this IRK method is</p>
<div class="math notranslate nohighlight">
\[R(z) = \frac{1 + \frac{2}{3}z + \frac{5}{48}z^2}{1 - \frac{1}{3}z}.\]</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Generate z values</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="n">Y</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span>

<span class="c1"># Define stability function for the IRK method</span>
<span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">Z</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">48</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Z</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Z</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># Plot the region of absolute stability</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">R</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;lightskyblue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">R</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;The region of absolute stability for the IRK method&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm</span><span class="si">{Re}</span><span class="s1">(z)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm</span><span class="si">{Im}</span><span class="s1">(z)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8_exercise_solutions_27_0.png" src="_images/8_exercise_solutions_27_0.png" />
</div>
</div>
<p>Question 4. Determine the stability function of the following Runge-Kutta method. What is the order of the method?</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|ccccc}
0 \\
\frac{2}{7} &amp; \frac{2}{7} \\
\frac{4}{7} &amp; -\frac{8}{35} &amp; \frac{4}{5} \\
\frac{6}{7} &amp; \frac{29}{42} &amp; -\frac{2}{3} &amp; \frac{5}{6} \\
1 &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{5}{12} &amp; \frac{1}{4} \\ \hline
&amp; \frac{11}{96} &amp; \frac{7}{24} &amp; \frac{35}{96} &amp; \frac{7}{48} &amp; \frac{1}{12}
\end{array}\end{split}\]</div>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define ERK method</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;2/7&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;8/35&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;4/5&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;29/42&#39;</span><span class="p">),</span> <span class="o">-</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;2/3&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;5/6&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/6&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/6&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;5/12&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/4&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;11/96&#39;</span><span class="p">),</span> <span class="o">-</span><span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;7/24&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;35/96&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;7/48&#39;</span><span class="p">),</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1/12&#39;</span><span class="p">)])</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]])</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Determine stability function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R(z) = 1&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)):</span>
    <span class="n">coeff</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span><span class="o">**</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; + </span><span class="si">{}</span><span class="s2"> z**</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>R(z) = 1 + 5/12 z**1 + 1/3 z**2 + 1/6 z**3 + 1/24 z**4 + 1/252 z**5
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[R(z) = 1 + \frac{5}{12} z + \frac{1}{3} z^2 + \frac{1}{6} z^3 + \frac{1}{24} z^4 + \frac{1}{252} z^5\]</div>
<p><span class="math notranslate nohighlight">\(R(z)\)</span> agrees to the series expansion of <span class="math notranslate nohighlight">\(e^z\)</span> up to the fourth-order term therefore this is a fourth-order method.</p>
<p>Question 5. Calculate the stiffness ratio for the following system of ODEs. What are the maximum step lengths that the Euler method is stable for solving each equation?</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_1' = -80.6y_1 + 119.4y_2, \\ y_2' = 79.6y_1 - 120.4y_2.\end{split}\]</div>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define coefficient matrix</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">80.6</span><span class="p">,</span> <span class="mf">119.4</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mf">79.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.4</span> <span class="p">]])</span>

<span class="c1"># Calculate eigenvalues</span>
<span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>

<span class="c1"># Calculate stiffness ratio</span>
<span class="n">S</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">eigvals</span><span class="o">.</span><span class="n">real</span><span class="p">))</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">eigvals</span><span class="o">.</span><span class="n">real</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The eigenvalues are </span><span class="si">{:0.4f}</span><span class="s1"> and </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eigvals</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The stiffness ratio os S = </span><span class="si">{:0.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The step lengths of the Euler method are h = </span><span class="si">{:0.4f}</span><span class="s1"> and </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span><span class="o">.</span> \
      <span class="nb">format</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">/</span> <span class="n">eigvals</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span> <span class="o">/</span> <span class="n">eigvals</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The eigenvalues are -1.0000 and -200.0000
The stiffness ratio os S = 200.0
The step lengths of the Euler method are h = 2.0000 and 0.0100
</pre></div>
</div>
</div>
</div>
<p>The eigenvalues are <span class="math notranslate nohighlight">\(\lambda_1 = -1\)</span> and <span class="math notranslate nohighlight">\(\lambda_2 = -200\)</span> therefore the stiffness ratio is <span class="math notranslate nohighlight">\(S=200\)</span>. The maximum step lengths of the Euler method are <span class="math notranslate nohighlight">\(h=2\)</span> and <span class="math notranslate nohighlight">\(h=0.01\)</span>.</p>
</div>
<hr class="docutils" />
<div class="section" id="boundary-value-problems">
<h2>Boundary Value Problems<a class="headerlink" href="#boundary-value-problems" title="Permalink to this headline">¶</a></h2>
<p>Question 1. Determine which of the following BVPs have a unique solutions:</p>
<p>(a) <span class="math notranslate nohighlight">\(y'' = -\dfrac{4}{t} y' + \dfrac{2}{t^2}y - \dfrac{2\ln(t)}{t^3}, \qquad t\in[1,2], \qquad y(1) = \dfrac{1}{2}, \qquad y(2) = \ln(2)\)</span>;</p>
<p><strong>Solution:</strong>
<span class="math notranslate nohighlight">\(p(t) = -\dfrac{4}{t}\)</span>, <span class="math notranslate nohighlight">\(q(t) = \dfrac{2}{t^2}\)</span> and <span class="math notranslate nohighlight">\(r(t) = -\dfrac{2\ln(t)}{t^3}\)</span> are all continuous over the domain and <span class="math notranslate nohighlight">\(q(t)&gt;0\)</span> for all <span class="math notranslate nohighlight">\(t\in [1, 2]\)</span> so the solution to this BVP is unique.</p>
<p>(b) <span class="math notranslate nohighlight">\(y'' = e^t + y\cos(t) - (t + 1) y', \qquad t \in [0, 2], \qquad y(0) = 1, \qquad y(2) = \ln(3)\)</span>;</p>
<p><strong>Solution:</strong>
<span class="math notranslate nohighlight">\(p(t) = -(t+1)\)</span>, <span class="math notranslate nohighlight">\(q(t)=\cos(t)\)</span> and <span class="math notranslate nohighlight">\(r(t)=e^t\)</span>. This BVP does not have a solution since <span class="math notranslate nohighlight">\(q(t)&lt;0\)</span> for <span class="math notranslate nohighlight">\(t\in\left[ \dfrac{\pi}{2}, 2\right]\)</span>.</p>
<p>(c) <span class="math notranslate nohighlight">\(y'' = (t^3 + 5)y + \sin(t), \qquad t \in [0, 1], \qquad y(0) = 0, \qquad y(1) = 1\)</span>;</p>
<p><strong>Solution:</strong>
<span class="math notranslate nohighlight">\(p(t)=t^3 + 5\)</span>, <span class="math notranslate nohighlight">\(q(t)=0\)</span> and <span class="math notranslate nohighlight">\(r(t)=\sin(t)\)</span>. This BVP does not have a solution since <span class="math notranslate nohighlight">\(q \not &gt; 0\)</span>.</p>
<p>(d) <span class="math notranslate nohighlight">\(y'' = (5y + \sin(3t))e^t, \qquad t \in [0, 1], \qquad y(0) = 0, \qquad y(1) = 0\)</span>.</p>
<p><strong>Solution:</strong>
<span class="math notranslate nohighlight">\(p(t)=0\)</span>, <span class="math notranslate nohighlight">\(q(t)=5e^t\)</span> and <span class="math notranslate nohighlight">\(r(t)=e^t \sin(3t)\)</span> are all continuous over the domain and <span class="math notranslate nohighlight">\(q(t)&gt;0\)</span> for all <span class="math notranslate nohighlight">\(t\in[0,1]\)</span> so the solution to this BVP is unique.</p>
<p>Question 2. Consider the following BVP</p>
<div class="math notranslate nohighlight">
\[y'' = 2t, \qquad t \in [0, 2], \qquad y(0) = 1,  \qquad y(2) = 3.\]</div>
<p>Using a pen and calculator, calculate the Euler method solutions using a step length of <span class="math notranslate nohighlight">\(h=0.5\)</span> for each of the following guess values:</p>
<p>(a) <span class="math notranslate nohighlight">\(s = 1\)</span>;</p>
<p><strong>Solution:</strong>
This ODE can be written as the following system</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
y_1' &amp;= y_2, &amp; y_1(0)&amp;=1\\ 
y_2' &amp;= 2t, &amp; y_2(0)&amp;= s.
\end{aligned}\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{y} = \pmatrix{y_1 \cr y_2}\)</span> and <span class="math notranslate nohighlight">\(F(t, \mathbf{y}) = \pmatrix{y_2 \cr 2t}\)</span> and using <span class="math notranslate nohighlight">\(s=1\)</span> then <span class="math notranslate nohighlight">\(\mathbf{y}_0 = \pmatrix{1 \cr 1}\)</span></p>
<div class="math notranslate nohighlight" id="equation-b">
<span class="eqno">(1)<a class="headerlink" href="#equation-b" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\mathbf{y}_1 &amp;= \mathbf{y}_0 + hF(t, \mathbf{y}_0) = \pmatrix{1 \cr 1} + 0.5\pmatrix{1 \cr 2(0)} = \pmatrix{1.5\cr 1}, &amp; 
t_1 = t_0 + h = 0 + 0.5 = 0.5, \\
\mathbf{y}_2 &amp;= \mathbf{y}_1 + hF(t, \mathbf{y}_1) = \pmatrix{1.5\cr 1}+ 0.5 \pmatrix{1 \cr 2(0.5)} = \pmatrix{2\cr 1.5}, &amp;
t_2 = t_1 + h = 0.5 + 0.5 = 1, \\
\mathbf{y}_3 &amp;= \mathbf{y}_2 + hF(t, \mathbf{y}_2) = \pmatrix{2 \cr 1.5} + 0.5\pmatrix{1.5 \cr 2(1)} = \pmatrix{2.75 \cr 2.5}, &amp;
t_3 = t_2 + h = 1 + 0.5 = 1.5, \\
\mathbf{y}_4 &amp;= \mathbf{y}_3 + h F(t, \mathbf{y}_3) = \pmatrix{2.75 \cr 2.5} + 0.5\pmatrix{2.5 \cr 2(1.5)} = \pmatrix{4 \cr 4}, &amp;
t_4 = t_3 + h = 1.5 + 0.5 = 2.
\end{aligned}\end{split}\]</div>
<p><strong>Solution:</strong> Using <span class="math notranslate nohighlight">\(s=-1\)</span> then <span class="math notranslate nohighlight">\(\mathbf{y}_0 = \pmatrix{1 \cr -1}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mathbf{y}_1 &amp;= \pmatrix{1 \cr -1} + 0.5\pmatrix{-1 \cr 2(0)} = \pmatrix{0.5\cr -1}, &amp; 
t_1 = 0 + 0.5 = 0.5, \\
\mathbf{y}_2 &amp;= \pmatrix{0.5\cr -1}+ 0.5 \pmatrix{-1 \cr 2(0.5)} = \pmatrix{0\cr -0.5}, &amp;
t_2 = 0.5 + 0.5 = 1, \\
\mathbf{y}_3 &amp;= \pmatrix{0 \cr -0.5} + 0.5\pmatrix{-0.5 \cr 2(1)} = \pmatrix{-0.25 \cr 0.5}, &amp;
t_3 = 1 + 0.5 = 1.5, \\
\mathbf{y}_4 &amp;= \pmatrix{-0.25 \cr 0.5} + 0.5\pmatrix{0.5 \cr 2(1.5)} = \pmatrix{0 \cr 2}, &amp;
t_4 = 1.5 + 0.5 = 2.
\end{aligned}\end{split}\]</div>
<p>Question 3. Use the Secant method to calculate the next value of <span class="math notranslate nohighlight">\(s\)</span> for your solutions to the BVP in question 2 and hence calculate the Euler method using this new guess values.</p>
<p><strong>Solution:</strong></p>
<div class="math notranslate nohighlight">
\[s_2 = s_0 - F(s_1) \frac{s_1 - s_0}{ F(s_1) - F(s_0)}=1 - (3-0)\frac{-1 - 1}{(3-0) - (3 - 4)} = 0.5.\]</div>
<p>Using <span class="math notranslate nohighlight">\(s = 0.5\)</span> then <span class="math notranslate nohighlight">\(\mathbf{y}_0 = \pmatrix{ 1 \cr 0.5 }\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mathbf{y}_1 &amp;= \pmatrix{1 \cr 0.5} + 0.5\pmatrix{0.5 \cr 2(0)} = \pmatrix{1.25 \cr 0.5}, &amp; 
t_1 = 0 + 0.5 = 0.5, \\
\mathbf{y}_2 &amp;= \pmatrix{1.25 \cr 0.5}+ 0.5 \pmatrix{0.5 \cr 2(0.5)} = \pmatrix{1.5 \cr 1}, &amp;
t_2 = 0.5 + 0.5 = 1, \\
\mathbf{y}_3 &amp;= \pmatrix{1.5 \cr 1} + 0.5\pmatrix{1 \cr 2(1)} = \pmatrix{2 \cr 2}, &amp;
t_3 = 1 + 0.5 = 1.5, \\
\mathbf{y}_4 &amp;= \pmatrix{2 \cr 2} + 0.5\pmatrix{2 \cr 2(1.5)} = \pmatrix{3 \cr 3}, &amp;
t_4 = 1.5 + 0.5 = 2.
\end{aligned}\end{split}\]</div>
<p>So the solution is</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    \mathbf{t} &amp;= \pmatrix{ 0.0 \cr 0.5 \cr 1.0 \cr 1.5 \cr 2.0 }, &amp;
    \mathbf{y} &amp;= \pmatrix{ 1 \cr 1.25 \cr 1.5 \cr 2 \cr 3}.
\end{aligned}\]</div>
<p>Question 4. Using a pen and calculator, calculate the solution of the BVP in question 2 using the finite-difference method with a step length <span class="math notranslate nohighlight">\(h=0.5\)</span>.</p>
<p><strong>Solution:</strong></p>
<p>Using <span class="math notranslate nohighlight">\(y'' = \dfrac{y_{i-1} - 2y_i + y_{i+1}}{h^2}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\frac{y_{i-1} - 2y_i + y_{i+1}}{h^2} &amp;= 2t_i \\
y_{i-1} - 2y_i + y_{i+1} &amp;= 2h^2t_i.
\end{aligned}\end{split}\]</div>
<p>and for <span class="math notranslate nohighlight">\(i=N\)</span> and <span class="math notranslate nohighlight">\(i=N-1\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
-2y_1 + y_2 &amp;= 2h^2t_1 - y_0, \\ y_{N-2} - 2y_N &amp;= 2h^2t_i - y_{N}.
\end{aligned}\end{split}\]</div>
<p>Therefore we have the linear system</p>
<div class="math notranslate nohighlight">
\[\pmatrix{-2 &amp; 1 \cr 1 &amp; -2 &amp; 1 \cr &amp; \ddots &amp; \ddots &amp; \ddots \cr &amp; &amp; 1 &amp; -2 &amp; 1 \cr &amp; &amp; &amp; 1 &amp; -2}
\pmatrix{y_1 \cr y_2 \cr \vdots \cr y_{N-2} \cr y_{N-1}} = 
\pmatrix{2h^2t_1 - y_0 \cr 2h^2t_2 \cr \vdots \cr 2h^2t_{N-2} \cr 2h^2t_{N-1} - y_N}.\]</div>
<p>Since <span class="math notranslate nohighlight">\(y_0=1\)</span>, <span class="math notranslate nohighlight">\(y_N=3\)</span>, <span class="math notranslate nohighlight">\(h=0.5\)</span> so <span class="math notranslate nohighlight">\(\mathbf{t} = (0, 0.5, 1, 1.5, 2)^T\)</span> and the linear system is</p>
<div class="math notranslate nohighlight">
\[\pmatrix{-2 &amp; 1&amp; 0 \cr 1 &amp; -2 &amp; 1 \cr 0 &amp; 1 &amp; -2}\pmatrix{ y_1 \cr y_2 \cr y_3} = \pmatrix{-0.99 \cr 0.02 \cr -2.97}\]</div>
<p>The inverse of the coefficient matrix can be determined using the adjoint-determinant formula</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
A{-1} &amp;= \frac{1}{\det(A)}\text{adj}(A), \\
\det(A) &amp;= -2 \left| \matrix{-2 &amp; 1 \cr 1 &amp; -2}\right|-\left| \matrix{1 &amp; 1 \cr 0 &amp; -2}\right| = -6 + 2 = -4, \\
\text{adj}(A) &amp;= \pmatrix{3 &amp; 2 &amp; 1 \cr 2 &amp; 4 &amp; 2 \cr 1 &amp; 2 &amp; 3}^T = \pmatrix{3 &amp; 2 &amp; 1 \cr 2 &amp; 4 &amp; 2 \cr 1 &amp; 2 &amp; 3}, \\
\therefore A^{-1} &amp;= -\frac{1}{4} \pmatrix{3 &amp; 2 &amp; 1 \cr 2 &amp; 4 &amp; 2 \cr 1 &amp; 2 &amp; 3}.
\end{aligned}\end{split}\]</div>
<p>Using <span class="math notranslate nohighlight">\(\mathbf{y} = A^{-1} \mathbf{b}\)</span> then</p>
<div class="math notranslate nohighlight">
\[\pmatrix{ y_1 \cr y_2 \cr y_3} = -\frac{1}{4}\pmatrix{3 &amp; 2 &amp; 1 \cr 2 &amp; 4 &amp; 2 \cr 1 &amp; 3 &amp; 3} 
\pmatrix{ -0.99 \cr 0.02 \cr -2.97} =
\pmatrix{ 1.475 \cr 1.96 \cr 2.465}.\]</div>
<p>So the solution is <span class="math notranslate nohighlight">\(\mathbf{y} = (1, 1.475, 1.96, 2.465, 3)^T\)</span>.</p>
<p>Question 5. Write a Python program to repeat questions 3 and 4 using a step length of <span class="math notranslate nohighlight">\(h=0.1\)</span>. The exact solution to this BVP is <span class="math notranslate nohighlight">\(y = \frac{1}{3}t^3 - \frac{1}{3}t + 1\)</span>. Produce a plot of the numerical solutions and exact solution on the same set of axes.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span> <span class="p">])</span>

<span class="k">def</span> <span class="nf">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># Define BVP parameters</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">2</span> <span class="p">]</span>
<span class="n">bvals</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]</span>
<span class="n">s0</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span>

<span class="c1"># Shooting method solution</span>
<span class="c1"># Solve system using s = 1</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="n">s0</span> <span class="p">],</span> <span class="n">h</span><span class="p">)</span>
<span class="n">F0</span> <span class="o">=</span> <span class="n">bvals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Solve system using s= -1</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="n">s1</span> <span class="p">],</span> <span class="n">h</span><span class="p">)</span>
<span class="n">F1</span> <span class="o">=</span> <span class="n">bvals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Calculate next guess value using the Secant method</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">-</span> <span class="n">F1</span> <span class="o">*</span> <span class="p">(</span><span class="n">s1</span> <span class="o">-</span> <span class="n">s0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">F1</span> <span class="o">-</span> <span class="n">F0</span><span class="p">)</span>

<span class="c1"># Solve system using new guess value</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="n">s2</span> <span class="p">],</span> <span class="n">h</span><span class="p">)</span>

<span class="c1"># Finite-difference method solution</span>
<span class="c1"># Initialise solution array</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">bvals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bvals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Define linear system</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Solve linear system</span>
<span class="n">y1</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tridiag_solver</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
    
<span class="c1">#Plot solutions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler method&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Finite-difference method&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t1</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;exact solution&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8_exercise_solutions_35_0.png" src="_images/8_exercise_solutions_35_0.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="direct-methods-for-solving-systems-of-linear-equations">
<h2>Direct Methods for Solving Systems of Linear Equations<a class="headerlink" href="#direct-methods-for-solving-systems-of-linear-equations" title="Permalink to this headline">¶</a></h2>
<p>Question 1. Solve the following systems of linear equations using LU decomposition using a pen and calculator.</p>
<p>(a) <span class="math notranslate nohighlight">\(2x_1 + 3x_2 - x_3 = 4, \\
4x_1 + 9x_2 - x_3 = 18, \\
\qquad 3x_2 + 2x_3 = 11.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(L = \pmatrix{ 1 &amp; 0 &amp; 0 \cr 2 &amp; 1 &amp; 0 \cr 0 &amp; 1 &amp; 1 },
U = \pmatrix{ 2 &amp; 3 &amp; -1 \cr 0 &amp; 3 &amp; 1 \cr 0 &amp; 0 &amp; 1 },
\mathbf{x} = \pmatrix{ -2 \cr 3 \cr 1 }.\)</span></p>
<p>(b) <span class="math notranslate nohighlight">\(3x_1 + 9x_2 + 5x_3 = 20, \\
 \,\,\,\,   x_1 + 2x_2 + 2x_3 = 3, \\
    2x_1 + 4x_2 + 5x_3 = 4.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(L = \pmatrix{ 1 &amp; 0 &amp; 0 \cr 1/3 &amp; 1 &amp; 0 \cr 2/3 &amp; 2 &amp; 1 },
U = \pmatrix{ 3 &amp; 9 &amp; 5 \cr 0 &amp; -1 &amp; 1/3 \cr 0 &amp; 0 &amp; 1 },
\mathbf{x} = \pmatrix{ 1 \cr 3 \cr -2 }.\)</span></p>
<p>(c)   <span class="math notranslate nohighlight">\(\qquad \,\,\,x_1 + 3x_3 + 2x_4 = 21, \\
    3x_1 - 2x_2 + 5x_3 + x_4 = 28, \\
    4x_1 - x_2 - 2x_3 - 3x_4 = -12, \\
   \qquad \qquad \,\,\, 2x_2 + 3x_4 = 13.\)</span></p>
<p><strong>Solution:</strong>
<span class="math notranslate nohighlight">\(L = \pmatrix{ 1 &amp; 0 &amp; 0 &amp; 0 \cr 3 &amp; 1 &amp; 0 &amp; 0 \cr 4 &amp; 1/2 &amp; 1 &amp; 0 \cr 0 &amp; -1 &amp; 1/3 &amp; 1 },
    U = \pmatrix{ 1 &amp; 0 &amp; 3 &amp; 2 \cr 0 &amp; -2 &amp; -4 &amp; -5 \cr 0 &amp; 0 &amp; -12 &amp; 17/2 \cr 0 &amp; 0 &amp; 0 &amp; 5/6 },
    \mathbf{x} = \pmatrix{ 2 \cr -1 \cr 3 \cr 5 }.\)</span>
<br><br>
   (d)   <span class="math notranslate nohighlight">\(\,\,\,\,\,\,x_1 + 5x_2 + 2x_3 + 2x_4 = -10, \\
\quad\,\,\,\,    -2x_1 - 4x_2 + 2x_3 = 10, \\
\quad\,\,    3x_1 + x_2 - 2x_3 - x_4 = -2, \\
    -3x_1 - 3x_2 + 4x_3 - x_4 = 4.\)</span></p>
<p><strong>Solution:</strong>
<span class="math notranslate nohighlight">\(L = \pmatrix{ 1 &amp; 0 &amp; 0 &amp; 0 \cr -2 &amp; 1 &amp; 0 &amp; 0 \cr 3 &amp; -7/3 &amp; 1 &amp; 0 \cr -3 &amp; 2 &amp; -1/3 &amp; 1 },
U = \pmatrix{ 1 &amp; 5 &amp; 2 &amp; 2 \cr 0 &amp; 6 &amp; 6 &amp; 4 \cr 0 &amp; 0 &amp; 6 &amp; 7/3 \cr 0 &amp; 0 &amp; 0 &amp;  20/9 }, 
\mathbf{x} = \pmatrix{ 1 \cr -3 \cr 0 \cr 2 }.\)</span>
<br><br></p>
<p>Question 2. Solve the systems of linear equations from question 1 using LU decomposition with partial pivoting using a pen and calculator.</p>
<p>(a) <span class="math notranslate nohighlight">\(2x_1 + 3x_2 - x_3 = 4, \\
4x_1 + 9x_2 - x_3 = 18, \\
\qquad 3x_2 + 2x_3 = 11.\)</span></p>
<p><strong>Solution:</strong>
<span class="math notranslate nohighlight">\(P = \pmatrix{ 0 &amp; 1 &amp; 0 \cr 1 &amp; 0 &amp; 0 \cr 0 &amp; 0 &amp; 1 }\)</span>,
<span class="math notranslate nohighlight">\(L = \pmatrix{ 1 &amp; 0 &amp; 0 \cr 1/2 &amp; 1 &amp; 0 \cr 0 &amp; -2 &amp; 1 }\)</span>,
<span class="math notranslate nohighlight">\(U = \pmatrix{ 4 &amp; 9 &amp; -1 \cr 0 &amp; -3/2 &amp; -1/2 \cr 0 &amp; 0 &amp; 1 }\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ -2 \cr 3 \cr 1 }\)</span>.</p>
<p>(b) <span class="math notranslate nohighlight">\(3x_1 + 9x_2 + 5x_3 = 20, \\
 \,\,\,\,   x_1 + 2x_2 + 2x_3 = 3, \\
    2x_1 + 4x_2 + 5x_3 = 4.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(P = \pmatrix{ 1 &amp; 0 &amp; 0 \cr 0 &amp; 0 &amp; 1 \cr 0 &amp; 1 &amp; 0 }\)</span>,
<span class="math notranslate nohighlight">\(L = \pmatrix{ 1 &amp; 0 &amp; 0 \cr 2/3 &amp; 1 &amp; 0 \cr 1/3 &amp; 1/2 &amp; 1 }\)</span>,
<span class="math notranslate nohighlight">\(U = \pmatrix{ 3 &amp; 9 &amp; 5 \cr 0 &amp; -2 &amp; 5/3 \cr 0 &amp; 0 &amp; -1/2 }\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ 1 \cr 3 \cr -2 }\)</span>.</p>
<p>(c) <span class="math notranslate nohighlight">\(\qquad \,\,\,x_1 + 3x_3 + 2x_4 = 21, \\
    3x_1 - 2x_2 + 5x_3 + x_4 = 28, \\
    4x_1 - x_2 - 2x_3 - 3x_4 = -12, \\
   \qquad \qquad \,\,\, 2x_2 + 3x_4 = 13.\)</span></p>
<p><strong>Solution:</strong>
<span class="math notranslate nohighlight">\(P = \pmatrix{ 0 &amp; 0 &amp; 1 &amp; 0 \cr 0 &amp; 1 &amp; 0 &amp; 0 \cr 1 &amp; 0 &amp; 0 &amp; 0 \cr 0 &amp; 0 &amp; 0 &amp; 1 }\)</span>,
<span class="math notranslate nohighlight">\(L = \pmatrix{ 1 &amp; 0 &amp; 0 &amp; 0 \cr 3/4 &amp; 1 &amp; 0 &amp; 0 \cr 1/3 &amp; -1/5 &amp; 1 &amp; 0 \cr 0 &amp; -8/5 &amp; 13/6 &amp; 1 }\)</span>,
<span class="math notranslate nohighlight">\(U = \pmatrix{ 4 &amp; -1 &amp; -2 &amp; -3 \cr 0 &amp; -5/4 &amp; 13/2 &amp; 7/4 \cr 0 &amp; 0 &amp; 24/5 &amp; 17/4 \cr 0 &amp; 0 &amp; 0 &amp; 5/6 }\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ 2 \cr -1 \cr 3 \cr 5 }\)</span>.</p>
<p>(d) <span class="math notranslate nohighlight">\(x_1 + 5x_2 + 2x_3 + 2x_4 = -10, \\
-2x_1 - 4x_2 + 2x_3 = 10, \\
3x_1 + x_2 - 2x_3 - x_4 = -2, \\
    -3x_1 - 3x_2 + 4x_3 - x_4 = 4.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(P = \pmatrix{ 0 &amp; 0 &amp; 1 &amp; 0 \cr 0 &amp; 1 &amp; 0 &amp; 0 \cr 0 &amp; 0 &amp; 0 &amp; 1 \cr 1 &amp; 0 &amp; 0 &amp; 0 }\)</span>,
<span class="math notranslate nohighlight">\(L = \pmatrix{ 1 &amp; 0 &amp; 0 &amp; 0 \cr -2/3 &amp; 1 &amp; 0 &amp; 0 \cr -1 &amp; 3/5 &amp; 1 &amp; 0 \cr 1/3 &amp; -7/5 &amp; 9/4 &amp; 1}\)</span>,
<span class="math notranslate nohighlight">\(U = \pmatrix{ 3 &amp; 1 &amp; -2 &amp; -1 \cr 0 &amp; -10/3 &amp; 2/3 &amp; -2/3 \cr 0 &amp; 0 &amp; 8/5 &amp; -8/5 \cr 0 &amp; 0 &amp; 0 &amp; 5  }\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ 1 \cr -3 \cr 0 \cr 2 }\)</span>.</p>
<p>Question 3. Solve the following systems of linear equations using Cholesky decomposition using a pen and calculator.</p>
<p>(a) <span class="math notranslate nohighlight">\(\,\,\,\,16x_1 + 16x_2 + 4x_3 = -8, \\
    16x_1 + 25x_2 + 10x_3 = -47, \\
\quad     4x_1 + 10x_2 + 6x_3 = -30.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(L = \pmatrix{ 4 &amp; 0 &amp; 0 \cr 4 &amp; 3 &amp; 0 \cr 1 &amp; 2 &amp; 1 }\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ 3 \cr -3 \cr -2 }\)</span>.</p>
<p>(b) <span class="math notranslate nohighlight">\(\quad 4x_1 + 2x_2 + 8x_3 = 36, \\
    2x_1 + 17x_2 + 20x_3 = 50, \\
    8x_1 + 20x_2 + 41x_3 = 122.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(L = \pmatrix{ 2 &amp; 0 &amp; 0 \cr 1 &amp; 4 &amp; 0 \cr 4 &amp; 4 &amp; 3 }\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ 5 \cr 0 \cr 2 }\)</span>.</p>
<p>(c) <span class="math notranslate nohighlight">\(\qquad \qquad \,9x_1 - 9x_2 - 6x_4 = 12, \\
    -9x_1 + 25x_2 + 8x_3 - 10x_4 = -116, \\
 \qquad \qquad \,   8x_2 + 8x_3 - 2x_4 = -58, \\
    -6x_1 - 10x_2 - 2x_3 + 33x_4 = 91.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(L = \pmatrix{ 3 &amp; 0 &amp; 0 &amp; 0 \cr -3 &amp; 4 &amp; 0 &amp; 0 \cr 0 &amp; 2 &amp; 2 &amp; 0 \cr -2 &amp; -4 &amp; -3 &amp; 1 }\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ -2 \cr -4 \cr -3 \cr 1 }\)</span>.</p>
<p>(d) <span class="math notranslate nohighlight">\(\qquad\,\,\,\,\, x_1 + 5x_2 - x_3 + 2x_4 = 14, \\
\,\,\,\,\,    5x_1 + 29x_2 + 3x_3 + 12x_4 = 82, \\
\,    -x_1 + 3x_2 + 42x_3 - 13x_4 = 40, \\
    2x_1 + 12x_2 - 13x_3 + 39x_4 = -34.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(L = \pmatrix{ 1 &amp; 0 &amp; 0 &amp; 0 \cr 5 &amp; 2 &amp; 0 &amp; 0 \cr -1 &amp; 4 &amp; 5 &amp; 0 \cr 2 &amp; 1 &amp; -3 &amp; 5 }\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ -2 \cr 4 \cr 0 \cr -2 }\)</span>.</p>
<p>Question 4. Calculate the QR decomposition of the coefficient matrix for the following systems using the Gram-Schmidt process with a pen and calculator.</p>
<p>(a) <span class="math notranslate nohighlight">\(x_1 + x_2 = 9, \\
\,\,\,\,\,\,    -x_1 = -5.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(Q = \pmatrix{ \sqrt{2}/2 &amp; \sqrt{2}/2 \cr -\sqrt{2}/2 &amp; \sqrt{2}/2 }\)</span>,
<span class="math notranslate nohighlight">\(R = \pmatrix{ \sqrt{2} &amp; \sqrt{2}/2 \cr 0 &amp; \sqrt{2}/2 }\)</span>.</p>
<p>(b) <span class="math notranslate nohighlight">\(6x_1 + 6x_2 + x_3 = 3, \\
    3x_1 + 6x_2 + x_3 = 0, \\
\,\,\,\,    2x_1 + x_2 + x_3 = 4.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(Q = \pmatrix{ 6/7 &amp; -2/7 &amp; -3/7 \cr 3/7 &amp; 6/7 &amp; 2/7 \cr 2/7 &amp; -3/7 &amp; 6/7 }\)</span>,
<span class="math notranslate nohighlight">\(R = \pmatrix{ 7 &amp; 8 &amp; 11/7 \cr 0 &amp; 3 &amp; 1/7 \cr 0 &amp; 0 &amp; 5/7 }\)</span>.</p>
<p>(c) <span class="math notranslate nohighlight">\(\,\,\,\,x_1 + 2x_2 + x_3 = 1, \\
    x_1 + 4x_2 + 3x_3 = 7, \\
    x_1 - 4x_2 + 6x_3 = -6, \\
 \,\,\,\,   x_1 + 2x_2 + x_3 = -1.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(Q = \pmatrix{ 1/2 &amp; 1/6 &amp; -\sqrt{2}/3 \cr 1/2 &amp; 1/2 &amp; \sqrt{2}/2 \cr 1/2 &amp; -5/6 &amp; \sqrt{2}/6 \cr 1/2 &amp; 1/6 &amp; -\sqrt{2}/3 }\)</span>,
<span class="math notranslate nohighlight">\(R = \pmatrix{ 2 &amp; 2 &amp; 11/2 \cr 0 &amp; 6 &amp; -19/6 \cr 0 &amp; 0 &amp; 11\sqrt{2}/6 }\)</span>.</p>
<p>Question 5. Repeat question 4 using Householder reflections.</p>
<p>(a) <span class="math notranslate nohighlight">\(x_1 + x_2 = 9, \\
\,\,\,\,\,\,    -x_1 = -5.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(Q = \pmatrix{ -\sqrt{2}/2 &amp; -\sqrt{2}/2 \cr \sqrt{2}/2 &amp; -\sqrt{2}/2 }\)</span>,
<span class="math notranslate nohighlight">\(R = \pmatrix{ -\sqrt{2} &amp; -\sqrt{2}/2 \cr 0 &amp; -\sqrt{2}/2 }\)</span>.</p>
<p>(b) <span class="math notranslate nohighlight">\(6x_1 + 6x_2 + x_3 = 3, \\
    3x_1 + 6x_2 + x_3 = 0, \\
\,\,\,\,    2x_1 + x_2 + x_3 = 4.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(Q = \pmatrix{ -6/7 &amp; 2/7 &amp; 3/7 \cr -3/7 &amp; -6/7 &amp; -2/7 \cr -2/7 &amp; 3/7 &amp; -6/7 }\)</span>,
<span class="math notranslate nohighlight">\(R = \pmatrix{ -7 &amp; -8 &amp; -11/7 \cr 0 &amp; -3 &amp; -1/7 \cr 0 &amp; 0 &amp; -5/7 }\)</span>.</p>
<p>(c) <span class="math notranslate nohighlight">\(\,\,\,\,x_1 + 2x_2 + x_3 = 1, \\
    x_1 + 4x_2 + 3x_3 = 7, \\
    x_1 - 4x_2 + 6x_3 = -6, \\
 \,\,\,\,   x_1 + 2x_2 + x_3 = -1.\)</span></p>
<p><strong>Solution:</strong> <span class="math notranslate nohighlight">\(Q = \pmatrix{-1/2 &amp; -1/6 &amp; \sqrt{2}/3 &amp; - \sqrt{2}/2 \cr -1/2 &amp; -1/2 &amp; -\sqrt{2}/2 &amp; 0 \cr -1/2 &amp; 5/6 &amp; -\sqrt{2}/6 &amp; 0 \cr -1/2 &amp; -1/6 &amp; \sqrt{2}/3 &amp; \sqrt{2}/2}\)</span>,
<span class="math notranslate nohighlight">\(R = \pmatrix{ -2 &amp; -2 &amp; -11/2 \cr 0 &amp; -6 &amp; 19/6 \cr 0 &amp; 0 &amp; -11\sqrt{2}/6 }\)</span>.</p>
<p>Question 6. Calculate the solutions to the linear systems in question 4 using QR decomposition.</p>
<p>(a) <span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ 5 \cr 4 }\)</span>.</p>
<p>(b) <span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ 1 \cr -1 \cr 3 }\)</span>.</p>
<p>(c) <span class="math notranslate nohighlight">\(\mathbf{x} = \pmatrix{ -62/11 \cr 47/22 \cr 15/11 }\)</span>.</p>
<ol class="simple">
<li><p>Check your solutions to questions 1 to 6 using Python.</p></li>
</ol>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 1 </span>
<span class="c1"># (a)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">11</span> <span class="p">])</span>

<span class="c1"># Calculate lu decomposition of A</span>
<span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Calculate solution to Ax = b using Crout&#39;s method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Question 1 (a)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    
<span class="c1"># (b)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span> <span class="p">])</span>

<span class="c1"># Calculate lu decomposition of A</span>
<span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Calculate solution to Ax = b using Crout&#39;s method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 1 (b)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    
<span class="c1"># (c)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span> <span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span> <span class="p">])</span>

<span class="c1"># Calculate lu decomposition of A</span>
<span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Calculate solution to Ax = b using Crout&#39;s method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 1 (c)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># (d)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="p">],</span> <span class="p">[</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="p">])</span>

<span class="c1"># Calculate lu decomposition of A</span>
<span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Calculate solution to Ax = b using Crout&#39;s method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 1 (d)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Question 1 (a)
L = 
[[1. 0. 0.]
 [2. 1. 0.]
 [0. 1. 1.]]
U = 
[[ 2.  3. -1.]
 [ 0.  3.  1.]
 [ 0.  0.  1.]]

x_1 = -2.0
x_2 = 3.0
x_3 = 1.0

Question 1 (b)
L = 
[[1.         0.         0.        ]
 [0.33333333 1.         0.        ]
 [0.66666667 2.         1.        ]]
U = 
[[ 3.          9.          5.        ]
 [ 0.         -1.          0.33333333]
 [ 0.          0.          1.        ]]

x_1 = 1.0000000000000024
x_2 = 2.999999999999999
x_3 = -2.0

Question 1 (c)
L = 
[[ 1.          0.          0.          0.        ]
 [ 3.          1.          0.          0.        ]
 [ 4.          0.5         1.          0.        ]
 [ 0.         -1.          0.33333333  1.        ]]
U = 
[[  1.           0.           3.           2.        ]
 [  0.          -2.          -4.          -5.        ]
 [  0.           0.         -12.          -8.5       ]
 [  0.           0.           0.           0.83333333]]

x_1 = 2.0
x_2 = -1.0
x_3 = 3.0000000000000004
x_4 = 4.999999999999999

Question 1 (d)
L = 
[[ 1.          0.          0.          0.        ]
 [-2.          1.          0.          0.        ]
 [ 3.         -2.33333333  1.          0.        ]
 [-3.          2.         -0.33333333  1.        ]]
U = 
[[ 1.          5.          2.          2.        ]
 [ 0.          6.          6.          4.        ]
 [ 0.          0.          6.          2.33333333]
 [ 0.          0.          0.         -2.22222222]]

x_1 = 1.0
x_2 = -2.9999999999999996
x_3 = -5.921189464667501e-16
x_4 = 2.0
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 2</span>
<span class="c1"># (a)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">11</span> <span class="p">])</span>

<span class="c1"># Calculate permutation matrix P</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">partial_pivot</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Calculate lu decomposition of PA</span>
<span class="n">PA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">PA</span><span class="p">)</span>

<span class="c1"># Use Crout&#39;s method to solve lux = Pb</span>
<span class="n">Pb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">Pb</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 2 (a)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># (b)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span> <span class="p">])</span>

<span class="c1"># Calculate permutation matrix P</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">partial_pivot</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Calculate lu decomposition of PA</span>
<span class="n">PA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">PA</span><span class="p">)</span>

<span class="c1"># Use Crout&#39;s method to solve lux = Pb</span>
<span class="n">Pb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">Pb</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 2 (b)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># (c)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span> <span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span> <span class="p">])</span>

<span class="c1"># Calculate permutation matrix P</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">partial_pivot</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Calculate lu decomposition of PA</span>
<span class="n">PA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">PA</span><span class="p">)</span>

<span class="c1"># Use Crout&#39;s method to solve lux = Pb</span>
<span class="n">Pb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">Pb</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 2 (c)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># (d)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="p">],</span> <span class="p">[</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="p">])</span>

<span class="c1"># Calculate permutation matrix P</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">partial_pivot</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Calculate lu decomposition of PA</span>
<span class="n">PA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">PA</span><span class="p">)</span>

<span class="c1"># Use Crout&#39;s method to solve lux = Pb</span>
<span class="n">Pb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">Pb</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 2 (d)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
Question 2 (a)
L = 
[[ 1.   0.   0. ]
 [ 0.5  1.   0. ]
 [ 0.  -2.   1. ]]
U = 
[[ 4.   9.  -1. ]
 [ 0.  -1.5 -0.5]
 [ 0.   0.   1. ]]
P = 
[[0. 1. 0.]
 [1. 0. 0.]
 [0. 0. 1.]]

x_1 = -2.0
x_2 = 3.0
x_3 = 1.0

Question 2 (b)
L = 
[[1.         0.         0.        ]
 [0.66666667 1.         0.        ]
 [0.33333333 0.5        1.        ]]
U = 
[[ 3.          9.          5.        ]
 [ 0.         -2.          1.66666667]
 [ 0.          0.         -0.5       ]]
P = 
[[1. 0. 0.]
 [0. 0. 1.]
 [0. 1. 0.]]

x_1 = 1.0000000000000024
x_2 = 2.999999999999999
x_3 = -2.0

Question 2 (c)
L = 
[[ 1.          0.          0.          0.        ]
 [ 0.75        1.          0.          0.        ]
 [ 0.25       -0.2         1.          0.        ]
 [ 0.         -1.6         2.16666667  1.        ]]
U = 
[[ 4.         -1.         -2.         -3.        ]
 [ 0.         -1.25        6.5         3.25      ]
 [ 0.          0.          4.8         3.4       ]
 [ 0.          0.          0.          0.83333333]]
P = 
[[0. 0. 1. 0.]
 [0. 1. 0. 0.]
 [1. 0. 0. 0.]
 [0. 0. 0. 1.]]

x_1 = 1.9999999999999991
x_2 = -0.9999999999999887
x_3 = 3.0000000000000067
x_4 = 4.99999999999999

Question 2 (d)
L = 
[[ 1.          0.          0.          0.        ]
 [-0.66666667  1.          0.          0.        ]
 [-1.          0.6         1.          0.        ]
 [ 0.33333333 -1.4         2.25        1.        ]]
U = 
[[ 3.          1.         -2.         -1.        ]
 [ 0.         -3.33333333  0.66666667 -0.66666667]
 [ 0.          0.          1.6        -1.6       ]
 [ 0.          0.          0.          5.        ]]
P = 
[[0. 0. 1. 0.]
 [0. 1. 0. 0.]
 [0. 0. 0. 1.]
 [1. 0. 0. 0.]]

x_1 = 0.9999999999999997
x_2 = -2.9999999999999996
x_3 = 0.0
x_4 = 1.9999999999999993
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 3</span>
<span class="c1"># (a)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">4</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">10</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">47</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span> <span class="p">])</span>

<span class="c1"># Calculate Cholesky decomposition</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">cholesky</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Solve linear system using the Cholesky-Crout method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 3 (a)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    
<span class="c1"># (b)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">20</span> <span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">41</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">122</span> <span class="p">])</span>

<span class="c1"># Calculate Cholesky decomposition</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">cholesky</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Solve linear system using the Cholesky-Crout method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 3 (b)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    
<span class="c1"># (c)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span> <span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span> <span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="p">],</span> <span class="p">[</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">33</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">116</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="mi">91</span> <span class="p">])</span>

<span class="c1"># Calculate Cholesky decomposition</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">cholesky</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Solve linear system using the Cholesky-Crout method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 3 (c)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># (d)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span> <span class="p">],</span> <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">39</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">34</span> <span class="p">])</span>

<span class="c1"># Calculate Cholesky decomposition</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">cholesky</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Solve linear system using the Cholesky-Crout method</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">crout</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 3 (d)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
Question 3 (a)
L = 
[[4. 0. 0.]
 [4. 3. 0.]
 [1. 2. 1.]]

x_0 = 3.0
x_1 = -3.0
x_2 = -2.0

Question 3 (b)
L = 
[[2. 0. 0.]
 [1. 4. 0.]
 [4. 4. 3.]]

x_0 = 5.0
x_1 = 0.0
x_2 = 2.0

Question 3 (c)
L = 
[[ 3.  0.  0.  0.]
 [-3.  4.  0.  0.]
 [ 0.  2.  2.  0.]
 [-2. -4.  3.  2.]]

x_0 = -2.0
x_1 = -4.0
x_2 = -3.0
x_3 = 1.0

Question 3 (d)
L = 
[[ 1.  0.  0.  0.]
 [ 5.  2.  0.  0.]
 [-1.  4.  5.  0.]
 [ 2.  1. -3.  5.]]

x_0 = -2.0
x_1 = 4.0
x_2 = 0.0
x_3 = -2.0
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 4</span>
<span class="c1"># (a)</span>
<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">])</span>

<span class="c1"># Calculate qr_gs decomposition of A</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr_gs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Output Q and R</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 4 (a)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>

<span class="c1"># (b)</span>
<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="p">])</span>

<span class="c1"># Calculate qr_gs decomposition of A</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr_gs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Output Q and R</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 4 (b)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>

<span class="c1"># (c)</span>
<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">])</span>

<span class="c1"># Calculate qr_gs decomposition of A</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr_gs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Output Q and R </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 4 (c)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
Question 4 (a)
Q = 
[[ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]]
R = 
[[1.41421356 0.70710678]
 [0.         0.70710678]]

Question 4 (b)
Q = 
[[ 0.85714286 -0.28571429 -0.42857143]
 [ 0.42857143  0.85714286  0.28571429]
 [ 0.28571429 -0.42857143  0.85714286]]
R = 
[[7.         8.         1.57142857]
 [0.         3.         0.14285714]
 [0.         0.         0.71428571]]

Question 4 (c)
Q = 
[[ 0.5         0.16666667 -0.47140452]
 [ 0.5         0.5         0.70710678]
 [ 0.5        -0.83333333  0.23570226]
 [ 0.5         0.16666667 -0.47140452]]
R = 
[[ 2.          2.          5.5       ]
 [ 0.          6.         -3.16666667]
 [ 0.          0.          2.59272486]]
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 5</span>
<span class="c1"># (a)</span>
<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">])</span>

<span class="c1"># Calculate qr_gs decomposition of A</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr_gs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Output Q and R</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 5 (a)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>

<span class="c1"># (b)</span>
<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="p">])</span>

<span class="c1"># Calculate qr_gs decomposition of A</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr_gs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Output Q and R</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 5 (b)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>

<span class="c1"># (c)</span>
<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">])</span>

<span class="c1"># Calculate qr_gs decomposition of A</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr_gs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Output Q and R</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 5 (c)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
Question 5 (a)
Q = 
[[ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]]
R = 
[[1.41421356 0.70710678]
 [0.         0.70710678]]

Question 5 (b)
Q = 
[[ 0.85714286 -0.28571429 -0.42857143]
 [ 0.42857143  0.85714286  0.28571429]
 [ 0.28571429 -0.42857143  0.85714286]]
R = 
[[7.         8.         1.57142857]
 [0.         3.         0.14285714]
 [0.         0.         0.71428571]]

Question 5 (c)
Q = 
[[ 0.5         0.16666667 -0.47140452]
 [ 0.5         0.5         0.70710678]
 [ 0.5        -0.83333333  0.23570226]
 [ 0.5         0.16666667 -0.47140452]]
R = 
[[ 2.          2.          5.5       ]
 [ 0.          6.         -3.16666667]
 [ 0.          0.          2.59272486]]
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 6</span>
<span class="c1"># (a)</span>
<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">])</span>

<span class="c1"># Calculate qr_gs decomposition of A</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr_gs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Solve Rx = Q.T b using back substitution</span>
<span class="n">QTb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">back_sub</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">QTb</span><span class="p">)</span>

<span class="c1"># Output solution </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 6 (a)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{:0.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># (b)</span>
<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="p">])</span>

<span class="c1"># Calculate qr_gs decomposition of A</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr_gs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Solve Rx = Q.T b using back substitution</span>
<span class="n">QTb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">back_sub</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">QTb</span><span class="p">)</span>

<span class="c1"># Output solution </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 6 (b))&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{:0.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># (c)</span>
<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">])</span>

<span class="c1"># Calculate qr_gs decomposition of A</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr_gs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Solve Rx = Q.T b using back substitution</span>
<span class="n">QTb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">back_sub</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">QTb</span><span class="p">)</span>

<span class="c1"># Output solution </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Question 6 (c)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{:0.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
Question 6 (a)
x_0 = 5.000000
x_1 = 4.000000

Question 6 (b))
x_0 = 1.000000
x_1 = -1.000000
x_2 = 3.000000

Question 6 (c)
x_0 = -5.636364
x_1 = 2.136364
x_2 = 1.363636
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="indirect-methods-for-solving-systems-of-linear-equations">
<h2>Indirect Methods for Solving Systems of Linear Equations<a class="headerlink" href="#indirect-methods-for-solving-systems-of-linear-equations" title="Permalink to this headline">¶</a></h2>
<p>Question 1. Using a pen and calculator, calculate the first 2 iterations of the Jacobi method for solving the system of linear equations below. Use starting values of <span class="math notranslate nohighlight">\(x_i^{(0)}=0\)</span> and work to 4 decimal places.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
4x_1 + x_2 - x_3 + x_4 &amp;= 14 ,\\
x_1 + 4x_2 - x_3 - x_4 &amp;= 10, \\
-x_1 -x_2 + 5x_3 + x_4 &amp;= -15, \\
x_1 - x_2 + x_3 + 3x_4 &amp;= 3.
\end{aligned} \end{split}\]</div>
<p><strong>Solution:</strong> The Jacobi method for this system is
<span class="math notranslate nohighlight">\($ \begin{aligned}
x_1^{(k+1)} &amp;= \frac{1}{4}(14 - x_2^{(k)} + x_3^{(k)} - x_4^{(k)}), \\
x_2^{(k+1)} &amp;= \frac{1}{4}(10 - x_1^{(k)} + x_3^{(k)} + x_4^{(k)}), \\
x_3^{(k+1)} &amp;= \frac{1}{5}(-15 + x_1^{(k)} + x_2^{(k)} - x_4^{(k)}), \\
x_4^{(k+1)} &amp;= \frac{1}{3}(3 - x_1^{(k)} + x_2^{(k)} - x_3^{(k)}).
\end{aligned} $\)</span></p>
<p>Using starting values of <span class="math notranslate nohighlight">\(\mathbf{x}^{(0)} = (0, 0, 0, 0)^T\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(1)} &amp;= \frac{1}{4}(14 - 0 + 0 - 0) = 3.5, \\
x_2^{(2)} &amp;= \frac{1}{4}(10 - 0 + 0 + 0) = 2.5, \\
x_3^{(3)} &amp;= \frac{1}{5}(-15 + 0 + 0 - 0) = -3, \\
x_4^{(4)} &amp;= \frac{1}{3}(3 - 0 + 0 - 0) = 1.
\end{aligned} \end{split}\]</div>
<p>Calculate the residual</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} = \pmatrix{14, \cr 10 \cr -15 \cr 3} -
\pmatrix{4 &amp; 1 &amp; -1 &amp; 1 \cr 1 &amp; 4 &amp; -1 &amp; -1 \cr -1 &amp; -1 &amp; 5 &amp; 1 \cr 1 &amp; -1 &amp; 1 &amp; 3}
\pmatrix{ 3.5 \cr 2.5 \cr -3 \cr 1 } =
\pmatrix{ -6.5 \cr -5.5 \cr 5 \cr 2 },\]</div>
<p>so <span class="math notranslate nohighlight">\(|\mathbf{r}| = \sqrt{(-6.5)^2 + (-5.5)^2 + 5^2 + 2^2} = 10.0747\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(2)} = \frac{1}{4}(14 - 2.5 - 3 - 1) = 1.875, \\
x_2^{(2)} = \frac{1}{4}(10 - 3.5 - 3 + 1) = 1.125, \\
x_3^{(2)} = \frac{1}{5}(-15 + 3.5 - 5.5 - 1) = -2, \\
x_4^{(2)} = \frac{1}{3}(3 - 1.875 + 2.5 +3) = 1.6667.
\end{aligned} \end{split}\]</div>
<p>Calculate the residual</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} = \pmatrix{14, \cr 10 \cr -15 \cr 3} -
\pmatrix{4 &amp; 1 &amp; -1 &amp; 1 \cr 1 &amp; 4 &amp; -1 &amp; -1 \cr -1 &amp; -1 &amp; 5 &amp; 1 \cr 1 &amp; -1 &amp; 1 &amp; 3}
\pmatrix{ 1.875 \cr 1.125 \cr -2 \cr 1.6667 } =
\pmatrix{ 1.7083 \cr 3.2917 \cr -3.6667 \cr -0.75 },\]</div>
<p>so <span class="math notranslate nohighlight">\(|\mathbf{r}| = \sqrt{1.7083^2 + 3.2917^2 + (-3.6667)^2 + (-0.75)^2} = 5.2688\)</span>.</p>
<p>Question 2. Repeat question 1 using the Gauss-Seidel method.</p>
<p><strong>Solution:</strong>  The Gauss-Seidel method for this system is</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(k+1)} &amp;= \frac{1}{4}(14 - x_2^{(k)} + x_3^{(k)} - x_4^{(k)}), \\
x_2^{(k+1)} &amp;= \frac{1}{4}(10 - x_1^{(k+1)} + x_3^{(k)} + x_4^{(k)}), \\
x_3^{(k+1)} &amp;= \frac{1}{5}(-15 + x_1^{(k+1)} + x_2^{(k+1)} - x_4^{(k)}), \\
x_4^{(k+1)} &amp;= \frac{1}{3}(3 - x_1^{(k+1)} + x_2^{(k+1)} - x_3^{(k+1)}).
\end{aligned} \end{split}\]</div>
<p>Using starting values of <span class="math notranslate nohighlight">\(\mathbf{x}^{(0)} = (0, 0, 0, 0)^T\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(1)} &amp;= \frac{1}{4}(14 - 0 + 0 - 0) = 3.5, \\
x_2^{(2)} &amp;= \frac{1}{4}(10 - 3.5 + 0 + 0) = 1.625, \\
x_3^{(3)} &amp;= \frac{1}{5}(-15 + 3.5 + 1.625 - 0) = -1.975, \\
x_4^{(4)} &amp;= \frac{1}{3}(3 - 3.5 + 1.625 + 1.975) = 1.0333.
\end{aligned} \end{split}\]</div>
<p>Calculate the residual</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} = \pmatrix{14, \cr 10 \cr -15 \cr 3} -
\pmatrix{4 &amp; 1 &amp; -1 &amp; 1 \cr 1 &amp; 4 &amp; -1 &amp; -1 \cr -1 &amp; -1 &amp; 5 &amp; 1 \cr 1 &amp; -1 &amp; 1 &amp; 3}
\pmatrix{ 3.5 \cr 1.625  \cr -1.975 \cr 1.0333 } =
\pmatrix{ -4.6333 \cr -0.9417 \cr -1.0333 \cr 0 },\]</div>
<p>so <span class="math notranslate nohighlight">\(|\mathbf{r}| = \sqrt{(-4.6333)^2 + (-0.9417)^2 + (-1.0333)^2 + 0^2} = 4.8397\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(2)} &amp;= \frac{1}{4}(14 - 1.625 - 1.975 - 1.0333) = 2.3417, \\
x_2^{(2)} &amp;= \frac{1}{4}(10 - 2.3417 - 1.975 + 1.0333) = 1.6792, \\
x_3^{(2)} &amp;= \frac{1}{5}(-15 + 2.3417 + 1.6792 - 1.0333) = -2.4025, \\
x_4^{(2)} &amp;= \frac{1}{3}(3 - 2.3417 + 1.6792 + 2.4025) = 1.58.
\end{aligned} \end{split}\]</div>
<p>Calculate the residual</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} = \pmatrix{14, \cr 10 \cr -15 \cr 3} -
\pmatrix{4 &amp; 1 &amp; -1 &amp; 1 \cr 1 &amp; 4 &amp; -1 &amp; -1 \cr -1 &amp; -1 &amp; 5 &amp; 1 \cr 1 &amp; -1 &amp; 1 &amp; 3}
\pmatrix{ 12.3417 \cr 1.6792 \cr -2.4025 \cr 1.58 } =
\pmatrix{ -1.0283 \cr 0.1192 \cr -0.5467 \cr 0 },\]</div>
<p>so <span class="math notranslate nohighlight">\(|\mathbf{r}| = \sqrt{(-1.0283)^2 + 0.1192^2 + (-0.5467)^2 + 0^2} = 1.1707\)</span>.</p>
<p>Question 3. Repeat question 1 using the SOR method using the optimum value for the relaxation parameter (use Python to determine the spectral radius of <span class="math notranslate nohighlight">\(T_J\)</span>).</p>
<p><strong>Solution:</strong> Calculate the eigenvalues of the iteration matrix for the Jacobi method</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define coefficent matrix</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]])</span>

<span class="c1"># Calculate L, D and U</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">L</span> <span class="o">-</span> <span class="n">U</span>

<span class="c1"># Calculate iteration matrix of the Jacobi method and its eigenvaleus</span>
<span class="n">T</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="n">U</span><span class="p">)</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">D</span><span class="p">),</span> <span class="n">L</span> <span class="o">+</span> <span class="n">U</span><span class="p">))</span>

<span class="c1"># Calculate optimum relaxation parameter</span>
<span class="n">rhoT</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rhoT</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rhoT</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;eigenvalues = </span><span class="si">{:0.4f}</span><span class="s1">, </span><span class="si">{:0.4f}</span><span class="s1">, </span><span class="si">{:0.4f}</span><span class="s1">, </span><span class="si">{:0.4f}</span><span class="se">\n</span><span class="s1">omega = </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span>\
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">omega</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>eigenvalues = -0.6054, 0.5425, 0.2853, -0.2224
omega = 1.1136
</pre></div>
</div>
</div>
</div>
<p>The eigenvalues are <span class="math notranslate nohighlight">\(\lambda_1 = -0.6054\)</span>, <span class="math notranslate nohighlight">\(\lambda_2 = 0.5425\)</span>, <span class="math notranslate nohighlight">\(\lambda_3 = 0.2853\)</span> and <span class="math notranslate nohighlight">\(\lambda_4 = -0.2224\)</span>. All eigenvalues of <span class="math notranslate nohighlight">\(T_J\)</span> are real and <span class="math notranslate nohighlight">\(A\)</span> is symmetric so <span class="math notranslate nohighlight">\(A\)</span> is a positive definite matrix.</p>
<p>The SOR method for this system using the optimal relaxation parameter <span class="math notranslate nohighlight">\(\omega=1.1136\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(k+1)} &amp;= (1 - 1.1136) x_1^{(k)} + \frac{1.1136}{4} (14 - x_2^{(k)} + x_3^{(k)} - x_4^{(k)}), \\
x_2^{(k+1)} &amp;= (1 - 1.1136) x_2^{(k)} + \frac{1.1136}{4} (10 - x_1^{(k+1)} + x_3^{(k)} + x_4^{(k)}), \\
x_3^{(k+1)} &amp;= (1 - 1.1136) x_3^{(k)} + \frac{1.1136}{5} (-15 + x_1^{(k+1)} + x_2^{(k+1)} - x_4^{(k)}), \\
x_4^{(k+1)} &amp;= (1 - 1.1136) x_4^{(k)} + \frac{1.1136}{3} (3 - x_1^{(k+1)} + x_2^{(k+1)} - x_3^{(k+1)}).
\end{aligned} \end{split}\]</div>
<p>Using starting values of <span class="math notranslate nohighlight">\(\mathbf{x}^{(0)} = (0, 0, 0, 0)^T\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(k+1)} &amp;= (1 - 1.1136) x_1^{(k)} + \frac{1.1136}{4} (14 - 0 + 0 - 0) = 3.8977, \\
x_2^{(k+1)} &amp;= (1 - 1.1136) x_2^{(k)} + \frac{1.1136}{4} (10 - 3.8977 + 0 + 0) = 1.6989, \\
x_3^{(k+1)} &amp;= (1 - 1.1136) x_3^{(k)} + \frac{1.1136}{5} (-15 + 3.8977 + 1.6989 - 0) = -2.0944, \\
x_4^{(k+1)} &amp;= (1 - 1.1136) x_4^{(k)} + \frac{1.1136}{3} (3 - 3.8977 + 1.6989 + 2.0944 ) = 1.0749.
\end{aligned} \end{split}\]</div>
<p>Calculate the residual</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} = \pmatrix{14, \cr 10 \cr -15 \cr 3} -
\pmatrix{4 &amp; 1 &amp; -1 &amp; 1 \cr 1 &amp; 4 &amp; -1 &amp; -1 \cr -1 &amp; -1 &amp; 5 &amp; 1 \cr 1 &amp; -1 &amp; 1 &amp; 3}
\pmatrix{ 3.8977 \cr 1.6989 \cr -2.0944 \cr 1.0749 } =
\pmatrix{-6.4591 \cr -1.7130 \cr -0.0063 \cr -0.3291 },\]</div>
<p>so <span class="math notranslate nohighlight">\(|\mathbf{r}| = \sqrt{(-6.4591)^2 + (-1.7130)^2 + (-0.0063)^2 + (-0.3291)^2} = 6.6905\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
x_1^{(k+1)} &amp;= (1 - 1.1136) x_1^{(k)} + \frac{1.1136}{4} (14 - 1.6989 - 2.0944 - 1.0749) = 2.0944, \\
x_2^{(k+1)} &amp;= (1 - 1.1136) x_2^{(k)} + \frac{1.1136}{4} (10 - 2.0944 - 2.0944 + 1.0749) = 1.7227, \\
x_3^{(k+1)} &amp;= (1 - 1.1136) x_3^{(k)} + \frac{1.1136}{5} (-15 + 2.0944 + 1.7227 - 1.0749) = -0.4991, \\
x_4^{(k+1)} &amp;= (1 - 1.1136) x_4^{(k)} + \frac{1.1136}{3} (3 - 2.0944 + 1.7227 + 0.4991) = 1.7763.
\end{aligned} \end{split}\]</div>
<p>Calculate the residual</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} = \pmatrix{14, \cr 10 \cr -15 \cr 3} -
\pmatrix{4 &amp; 1 &amp; -1 &amp; 1 \cr 1 &amp; 4 &amp; -1 &amp; -1 \cr -1 &amp; -1 &amp; 5 &amp; 1 \cr 1 &amp; -1 &amp; 1 &amp; 3}
\pmatrix{ 2.0994 \cr 1.7227 \cr -2.4910 \cr 1.7763 } =
\pmatrix{ -0.3878 \cr 0.2951 \cr -0.4991 \cr -0.2147 }.\]</div>
<p>so <span class="math notranslate nohighlight">\(|\mathbf{r}| = \sqrt{(-0.3878)^2 + 0.2951^2 + (-0.4991)^2 + (-0.2147)^2} = 0.7299\)</span>.</p>
<p>Question 4. Which method would you expect to converge to the solution with the fewest iterations? What quantitative evidence do you have to support your conclusion?</p>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate iteration matrices for the Jacobi, Gauss-Seidel and SOR methods</span>
<span class="n">TJ</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">D</span><span class="p">),</span> <span class="n">L</span> <span class="o">+</span> <span class="n">U</span><span class="p">)</span>
<span class="n">TGS</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="n">D</span><span class="p">),</span> <span class="n">U</span><span class="p">)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mf">1.1136</span>
<span class="n">TSOR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">L</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">omega</span><span class="p">)</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">U</span><span class="p">)</span>

<span class="c1"># Calculate the spectral radii of the 3 methods</span>
<span class="k">def</span> <span class="nf">spectral_radius</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

<span class="n">rho_TJ</span> <span class="o">=</span> <span class="n">spectral_radius</span><span class="p">(</span><span class="n">TJ</span><span class="p">)</span>
<span class="n">rho_TGS</span> <span class="o">=</span> <span class="n">spectral_radius</span><span class="p">(</span><span class="n">TGS</span><span class="p">)</span>
<span class="n">rho_TSOR</span> <span class="o">=</span> <span class="n">spectral_radius</span><span class="p">(</span><span class="n">TSOR</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho(T_J) = </span><span class="si">{:0.4f}</span><span class="se">\n</span><span class="s1">rho(T_GS) = </span><span class="si">{:0.4f}</span><span class="se">\n</span><span class="s1">rhot(T_SOR) = </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span>\
     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rho_TJ</span><span class="p">,</span> <span class="n">rho_TGS</span><span class="p">,</span> <span class="n">rho_TSOR</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>rho(T_J) = 0.6054
rho(T_GS) = 0.3553
rhot(T_SOR) = 0.1968
</pre></div>
</div>
</div>
</div>
<p>The spectral radii are <span class="math notranslate nohighlight">\(\rho(T_J) = 0.6054\)</span>, <span class="math notranslate nohighlight">\(\rho(T_{GS})=0.3553\)</span> and <span class="math notranslate nohighlight">\(\rho(T_{SOR})=0.1968\)</span> so the SOR should converge fastest.</p>
<p>Question 5. Write a Python program to calculate the solution to questions 1 to 3 using <span class="math notranslate nohighlight">\(tol=10^{-5}\)</span>. How many iterations did each of the three methods take to converge to the solution?</p>
<p><strong>Solution:</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 5 </span>
<span class="c1"># (a)</span>

<span class="c1"># Define linear system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> 
              <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span> 
              <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> 
              <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span> <span class="p">])</span>

<span class="c1"># Solve linear system using the Jacobi, Gauss-Seidel and SOR methods</span>
<span class="n">tol</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1.1136</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">jacobi</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">gauss_seidel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">sor</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>

<span class="c1"># Output results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Jacobi method:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">solution_table</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Gauss-Seidel method:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">solution_table</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">SOR method:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">solution_table</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x_1 = </span><span class="si">{:0.4f}</span><span class="se">\n</span><span class="s1">x_2 = </span><span class="si">{:0.4f}</span><span class="se">\n</span><span class="s1">x_3 = </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">x3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">x3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Jacobi method took </span><span class="si">{}</span><span class="s1"> iterations&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gauss-Seidel method took </span><span class="si">{}</span><span class="s1"> iterations&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SOR method took </span><span class="si">{}</span><span class="s1"> iterations&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
Jacobi method:

  k      x_0       x_1       x_2       x_3       |r|
------------------------------------------------------
   0   0.00000   0.00000   0.00000   0.00000  23.02173
   1   3.50000   2.50000  -3.00000   1.00000  10.07472
   2   1.87500   1.12500  -2.00000   1.66667   5.26882
   3   2.30208   1.94792  -2.73333   1.41667   2.68711
   4   1.97552   1.59531  -2.43333   1.79306   1.51747
   5   2.04457   1.84605  -2.64444   1.68438   0.78346
   6   1.95628   1.74884  -2.55875   1.81531   0.45250
   7   1.96928   1.82507  -2.62204   1.78377   0.23211
   8   1.94228   1.79811  -2.59788   1.82594   0.13642
   9   1.94451   1.82144  -2.61711   1.81791   0.06940
  10   1.93589   1.81407  -2.61039   1.83135   0.04155
  11   1.93605   1.82127  -2.61628   1.82952   0.02098
  12   1.93323   1.81930  -2.61444   1.83383   0.01281
  13   1.93311   1.82154  -2.61626   1.83350   0.00644
  14   1.93217   1.82103  -2.61577   1.83490   0.00401
  15   1.93207   1.82174  -2.61634   1.83488   0.00202
  16   1.93176   1.82162  -2.61621   1.83533   0.00128
  17   1.93171   1.82184  -2.61639   1.83536   0.00065
  18   1.93160   1.82181  -2.61636   1.83551   0.00042
  19   1.93158   1.82189  -2.61642   1.83552   0.00021
  20   1.93154   1.82188  -2.61641   1.83557   0.00014
  21   1.93153   1.82190  -2.61643   1.83558   0.00007
  22   1.93152   1.82191  -2.61643   1.83560   0.00005
  23   1.93152   1.82191  -2.61644   1.83560   0.00003
  24   1.93151   1.82191  -2.61644   1.83561   0.00002
  25   1.93151   1.82192  -2.61644   1.83561   0.00001

Gauss-Seidel method:

  k      x_0       x_1       x_2       x_3       |r|
------------------------------------------------------
   0   0.00000   0.00000   0.00000   0.00000  23.02173
   1   3.50000   1.62500  -1.97500   1.03333   4.83966
   2   2.34167   1.67917  -2.40250   1.58000   1.17069
   3   2.08458   1.77323  -2.54444   1.74436   0.43337
   4   1.98449   1.80386  -2.59120   1.80352   0.14933
   5   1.95035   1.81549  -2.60754   1.82422   0.05307
   6   1.93819   1.81963  -2.61328   1.83157   0.01880
   7   1.93388   1.82110  -2.61532   1.83418   0.00668
   8   1.93235   1.82163  -2.61604   1.83511   0.00237
   9   1.93181   1.82181  -2.61630   1.83544   0.00084
  10   1.93161   1.82188  -2.61639   1.83555   0.00030
  11   1.93154   1.82190  -2.61642   1.83559   0.00011
  12   1.93152   1.82191  -2.61643   1.83561   0.00004
  13   1.93151   1.82192  -2.61644   1.83561   0.00001
  14   1.93151   1.82192  -2.61644   1.83562   0.00000

SOR method:

  k      x_0       x_1       x_2       x_3       |r|
------------------------------------------------------
   0   0.00000   0.00000   0.00000   0.00000  23.02173
   1   3.89760   1.69891  -2.09435   1.07487   6.68985
   2   2.09955   1.72267  -2.49099   1.77625   0.72995
   3   1.99150   1.83489  -2.60122   1.81926   0.24924
   4   1.92987   1.82058  -2.61518   1.83712   0.01727
   5   1.93199   1.82270  -2.61663   1.83563   0.00532
   6   1.93118   1.82187  -2.61650   1.83574   0.00133
   7   1.93150   1.82194  -2.61645   1.83562   0.00016
   8   1.93150   1.82191  -2.61644   1.83562   0.00005
   9   1.93151   1.82192  -2.61644   1.83562   0.00001

x_1 = 1.9315
x_2 = 1.8219
x_3 = -2.6164

Jacobi method took 25 iterations
Gauss-Seidel method took 14 iterations
SOR method took 9 iterations
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(x_1 = 1.9315\)</span>, <span class="math notranslate nohighlight">\(x_2 = 1.8219\)</span> and <span class="math notranslate nohighlight">\(x_3 = -2.6164\)</span>. The Jacobi method took 25 iterations, the Gauss-Seidel method took 14 iterations and the SOR method took 9 iterations to converge to the solution.</p>
<p>Question 6. A linear system has the following coefficient matrix. What is the largest value that  can be in order for the Jacobi method to be convergent?</p>
<div class="math notranslate nohighlight">
\[A = \pmatrix{ 2 &amp; 1 \cr \alpha &amp; 2}\]</div>
<p><strong>Solution:</strong></p>
<p>For a method to be convergent <span class="math notranslate nohighlight">\(\rho(T)&lt;1\)</span>. The iteration matrix for the Jacobi method for this coefficient matrix is</p>
<div class="math notranslate nohighlight">
\[T_J = -D^{-1}(L+U) = -\pmatrix{\frac{1}{2} &amp; 0 \cr 0 &amp; \frac{1}{2}} \pmatrix{0 &amp; 1 \cr \alpha &amp; 0 } = \pmatrix{0 &amp; -\frac{1}{2} \cr -\frac{\alpha}{2} &amp; 0}\]</div>
<p>which has eigenvalues <span class="math notranslate nohighlight">\(\lambda = \pm \dfrac{\sqrt{\alpha}}{2}\)</span>. So for the Jacobi method to be convergent <span class="math notranslate nohighlight">\(\alpha&lt;4\)</span>.</p>
<p>Question 7. A linear system has the following coefficient matrix. Is the Jacobi method convergent for this system? If not, can the system be altered so that the Jacobi method is convergent?</p>
<div class="math notranslate nohighlight">
\[A = \pmatrix{1 &amp; 3 &amp; 1 \cr 2 &amp; 1 &amp; 0 \cr 1 &amp; 1 &amp; 4}\]</div>
<p><strong>Solution:</strong></p>
<div class="math notranslate nohighlight">
\[T = D^{-1}(L+U)= \pmatrix{1 &amp; 0 &amp; 0 \cr 0 &amp; 1 &amp; 0 \cr 0 &amp; 0 &amp; \frac{1}{4}}\pmatrix{0 &amp; 3 &amp; 1 \cr 2 &amp; 0 &amp; 0 \cr 1 &amp; 1 &amp; 0} =
\pmatrix{0 &amp; 3 &amp; 1 \cr 2 &amp; 0 &amp; 0 \cr \frac{1}{4} &amp; \frac{1}{4} &amp; 0}\]</div>
<p>Checking <span class="math notranslate nohighlight">\(\|T\|_2\)</span></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> 
              <span class="p">[</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;||T||_2 = </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>||T||_2 = 3.1713
</pre></div>
</div>
</div>
</div>
<p>So <span class="math notranslate nohighlight">\(\|T\|_2 = 3.1713&gt;1\)</span> so the Jacobi method is not convergent for this system. Changing the coefficient matrix by swapping rows 1 and 2 gives</p>
<div class="math notranslate nohighlight">
\[A = \pmatrix{ 2 &amp; 1 &amp; 0 \cr 1 &amp; 3 &amp; 1 \cr 1 &amp; 1 &amp; 4}.\]</div>
<p>The iteration matrix is now</p>
<div class="math notranslate nohighlight">
\[T = D^{-1}(L+U) = \pmatrix{\frac{1}{2} &amp; 0 &amp; 0 \cr 0 &amp; \frac{1}{3} &amp; 0 \cr 0 &amp; 0 &amp; \frac{1}{4}}\pmatrix{0 &amp; 1 &amp; 0 \cr 1 &amp; 0 &amp; 1 \cr 1 &amp; 1 &amp; 0 }=
\pmatrix{0 &amp; \frac{1}{2} &amp; 0 \cr \frac{1}{3} &amp; 0 &amp; \frac{1}{3} \cr \frac{1}{4} &amp; \frac{1}{4} &amp; 0 }.\]</div>
<p>Checking <span class="math notranslate nohighlight">\(\|T\|_2\)</span></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="p">],</span> 
              <span class="p">[</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;||T||_2 = </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>||T||_2 = 0.5876
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\|T\|_2=0.5876 \leq 1\)</span> so the Jacobi method is now convergent for this system.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>