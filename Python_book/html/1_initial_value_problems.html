

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Initial Value Problems &#8212; My Jupyter Book</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-2 bd-sidebar site-navigation show single-page" id="site-navigation">
    
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/1_initial_value_problems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/1_initial_value_problems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-outcomes">
   Learning outcomes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-taylor-series">
   The Taylor series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-euler-method">
   The Euler method
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1">
     Example 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2">
     Example 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3">
     Example 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-higher-order-ordinary-differential-equations">
   Solving higher-order ordinary differential equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-4">
     Example 4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-systems-of-ordinary-differential-equations">
     Solving systems of ordinary differential equations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-5">
       Example 5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-6">
       Example 6
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="initial-value-problems">
<h1>Initial Value Problems<a class="headerlink" href="#initial-value-problems" title="Permalink to this headline">¶</a></h1>
<div class="section" id="learning-outcomes">
<h2>Learning outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this headline">¶</a></h2>
<p>On successful completion of this page readers will be able to:</p>
<ul class="simple">
<li><p>Identity an initial value problem;</p></li>
<li><p>Derive the Euler method and apply it to solve first-order ordinary differential equations;</p></li>
<li><p>Express a higher-order ODE as a system of first-order ODEs;</p></li>
<li><p>Apply an ODE solver to solve a system of ODEs.</p></li>
</ul>
<p>An <a class="reference external" href="https://en.wikipedia.org/wiki/Initial_value_problem"><strong>Initial Value Problem</strong></a> (IVP) is written as an <a class="reference external" href="https://en.wikipedia.org/wiki/Ordinary_dif">Ordinary Differential Equation</a> (ODE) where the initial solution at the lower boundary of the domain is known. For example,</p>
<div class="math notranslate nohighlight" id="equation-ivp">
<span class="eqno">(1)<a class="headerlink" href="#equation-ivp" title="Permalink to this equation">¶</a></span>\[y' = f(t, y), \qquad t \in [t_{\min}, t_{\max}], \qquad y(t_{\min}) = y_0.\]</div>
<p>Here a first-order ODE <span class="math notranslate nohighlight">\(y'=f(t,y)\)</span> is defined over the domain <span class="math notranslate nohighlight">\(t\in [t_{\min}, t_{\max}]\)</span> and the initial solution <span class="math notranslate nohighlight">\(y(t_{\min})\)</span> is the known value <span class="math notranslate nohighlight">\(y_0\)</span>.</p>
<p>In most real world practical applications, IVPs cannot be solved using analytical methods so instead we use computational methods called <strong>ODE solvers</strong> to approximate the solutions. The simplest ODE solver is the Euler method.</p>
</div>
<div class="section" id="the-taylor-series">
<h2>The Taylor series<a class="headerlink" href="#the-taylor-series" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Taylor_series">Taylor series</a> is a series expansion that is the basis for all computational methods for solving ODEs. The Taylor series expansion of the function <span class="math notranslate nohighlight">\(f(t)\)</span> evaluated at the point <span class="math notranslate nohighlight">\(a\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-taylor-f-t">
<span class="eqno">(2)<a class="headerlink" href="#equation-taylor-f-t" title="Permalink to this equation">¶</a></span>\[f(a) = \sum_{n=0}^\infty \frac{f^{(n)}(a)}{n!}(t - a) = f(a) + f'(a)(t-a) + \frac{f''(a)}{2}(t-a) + \cdots,\]</div>
<p>where <span class="math notranslate nohighlight">\(f^{(n)}(a)\)</span> denotes the <span class="math notranslate nohighlight">\(n\)</span>th derivative of <span class="math notranslate nohighlight">\(f\)</span>. Let <span class="math notranslate nohighlight">\(h = t - a\)</span> be some small change in the value at which the function is evaluated (known as the <strong>step length</strong>) then</p>
<div class="math notranslate nohighlight" id="equation-taylor-no-error">
<span class="eqno">(3)<a class="headerlink" href="#equation-taylor-no-error" title="Permalink to this equation">¶</a></span>\[f(t + h) = \sum_{n=0}^\infty \frac{h^n}{n!}f(t) = f(t) + hf'(t) + \frac{h^2}{2}f''(t) + \cdots.\]</div>
<p>It is impractical to sum the series to an infinite number of terms so we <strong>truncate</strong> equation <a class="reference internal" href="#equation-taylor-no-error">(3)</a> so that only the first few terms are included, e.g.,</p>
<div class="math notranslate nohighlight" id="equation-taylor">
<span class="eqno">(4)<a class="headerlink" href="#equation-taylor" title="Permalink to this equation">¶</a></span>\[f(t + h) = f(t) + hf'(t) + \frac{h^2}{2}f''(t) + \cdots + \frac{h^n}{n!}f^{(n)}(t) + O(h^{n+1}).\]</div>
<p>Since we are not including all terms in the truncated series we have introduced an error in the calculation of <span class="math notranslate nohighlight">\(f(t+h)\)</span>. This error is known as the <strong>local truncation error</strong>. We do not know the value of this truncation error but we do know that the error will be less than some function of <span class="math notranslate nohighlight">\(h\)</span> and we represent this idea using the term <span class="math notranslate nohighlight">\(O(h^{n+1})\)</span> which means <em>the truncation error will tend to zero at least as fast as <span class="math notranslate nohighlight">\(h^{n+1}\)</span> tends to zero</em>. For example for <span class="math notranslate nohighlight">\(O(h^2)\)</span> if <span class="math notranslate nohighlight">\(h\)</span> is halved then the truncation error will decrease by a factor of at least <span class="math notranslate nohighlight">\((\frac{1}{2})^2 = \frac{1}{4}\)</span>.</p>
</div>
<div class="section" id="the-euler-method">
<h2>The Euler method<a class="headerlink" href="#the-euler-method" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Euler_method"><strong>Euler method</strong></a> is the simplest numerical method for computing the solution of a first-order Ordinary Differential Equation (ODE). Truncating the Taylor series, equation <a class="reference internal" href="#equation-taylor">(4)</a>, after the first-order term we have</p>
<div class="math notranslate nohighlight">
\[y(t+h) = y(t) + hy'(t) + O(h^2),\]</div>
<p>and introducing the notation <span class="math notranslate nohighlight">\(y_n = y(t_n)\)</span> and <span class="math notranslate nohighlight">\(y_{n+1} = y(t_n + h)\)</span> then</p>
<div class="math notranslate nohighlight" id="equation-euler">
<span class="eqno">(5)<a class="headerlink" href="#equation-euler" title="Permalink to this equation">¶</a></span>\[y_{n+1} = y_n + hf(t_n, y_n) + O(h^2),\]</div>
<p>which is the Euler method.</p>
<p>To apply the Euler method to solve equation <a class="reference internal" href="#equation-ivp">(1)</a> we initialise <span class="math notranslate nohighlight">\(t_0 = t_{\min}\)</span> and <span class="math notranslate nohighlight">\(y_0 = y(t_{\min})\)</span> and then apply equation <a class="reference internal" href="#equation-euler">(5)</a> to calculate the values of <span class="math notranslate nohighlight">\(y_{n+1}\)</span> and update <span class="math notranslate nohighlight">\(t_n\)</span> using <span class="math notranslate nohighlight">\(t_{n+1} = t_n + h\)</span></p>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>Calculate the first two steps of the Euler method when used to solve the following IVP</p>
<div class="math notranslate nohighlight">
\[ y' = \sin^2(t)y, \qquad t \in [0, 5], \qquad y(0) = 1,\]</div>
<p>using a step length <span class="math notranslate nohighlight">\(h=0.5\)</span>.</p>
<p>Since we have <span class="math notranslate nohighlight">\(t_0=0\)</span> and <span class="math notranslate nohighlight">\(y_0=1\)</span> then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_1 &amp;= y_0 + h \sin^2(t_0)y_0 = 1 + 0.5\sin^2(0)(1) = 1, &amp; t_1 &amp;= t_0 + h = 0 + 0.5 = 0.5,\\
    y_2 &amp;= y_1 + h \sin^2(t_1)y_1 = 1 + 0.5\sin^2(0.5)(1) = 1.1149, &amp; t_2 &amp;= t_1 + h = 0.5 + 0.5 = 1.0.
\end{aligned}
\end{split}\]</div>
</div>
<div class="section" id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h3>
<p>Calculate the solution of the IVP from example 1 over the whole domain <span class="math notranslate nohighlight">\(t\in [0,5]\)</span> using the Euler method with a step length of <span class="math notranslate nohighlight">\(h=0.5\)</span> and compare it to the exact solution given by</p>
<div class="math notranslate nohighlight">
\[y = e^{(t - \sin(t)\cos(t))/2}\]</div>
<p>The functions below defines the right-hand side of the ODE and the exact solution to the IVP.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>The code below defines a function called <code class="docutils literal notranslate"><span class="pre">euler</span></code> that solves an IVP using the Euler method. The input arguments are <code class="docutils literal notranslate"><span class="pre">f</span></code> is the name of the function the defines the ODE, <code class="docutils literal notranslate"><span class="pre">tspan</span></code> is a two-element array containing the lower and upper bounds of the <span class="math notranslate nohighlight">\(t\)</span> domain, <code class="docutils literal notranslate"><span class="pre">y0</span></code> is the initial value of <span class="math notranslate nohighlight">\(y\)</span> at the lower bound and <code class="docutils literal notranslate"><span class="pre">h</span></code> is the step length.
<a id="euler"></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculuates the solution to an IVP using the Euler method</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Initialise solution arrays</span>
    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nsteps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nsteps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>

    <span class="c1"># Solver loop</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
        <span class="n">t</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>The program below invokes the Euler method to solve this IVP.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Define IVP parameters</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span> <span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1"># Invoke the Euler method to solve the IVP</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; t    Euler   Exact</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.2f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>

<span class="c1"># Plot numerical and exact solutions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t1</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact solution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler method&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Solution to the IVP $y&#39;=\sin^2(t)y$, $y(0) = 1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span> t    Euler   Exact
--------------------
0.00  1.0000  1.0000
0.50  1.0000  1.0404
1.00  1.1149  1.3135
1.50  1.5096  2.0436
2.00  2.2607  3.2845
2.50  3.1953  4.4359
3.00  3.7675  4.8059
3.50  3.8050  4.8830
4.00  4.0391  5.7699
4.50  5.1958  8.5589
5.00  7.6783 13.9573
</pre></div>
</div>
<img alt="_images/1_initial_value_problems_9_1.png" src="_images/1_initial_value_problems_9_1.png" />
</div>
</div>
<p>Here we can see that the solution using the Euler method deviates from the exact solution. This is because the Euler method is a first-order method and the truncation errors at each step accumulate as we step through the solution. One way to improve our solution is to use a smaller step length.</p>
</div>
<div class="section" id="example-3">
<h3>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h3>
<p>Repeat the solution of the IVP in example 2 using a step length of <span class="math notranslate nohighlight">\(h=0.1\)</span> and compare the solution with the exact solution and the one obtained using <span class="math notranslate nohighlight">\(h=0.5\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Invoke the Euler method to solve IVP using a step length of h = 0.1</span>
<span class="n">t1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">t2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; t    h=0.5   h=0.1   Exact</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">28</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.2f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1">&#39;</span>\
          <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t1</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y1</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y2</span><span class="p">[</span><span class="mi">5</span> <span class="o">*</span> <span class="n">n</span><span class="p">],</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>

<span class="c1"># Plot numerical and exact solutions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t2</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact solution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler method $(h=0.5)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler method $(h=0.1)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Solution to the IVP $y&#39;=\sin^2(t)y$, $y(0) = 1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y(t)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span> t    h=0.5   h=0.1   Exact
----------------------------
0.00  1.0000  1.0000  1.0000
0.50  1.0000  1.0291  1.0404
1.00  1.1149  1.2626  1.3135
1.50  1.5096  1.9018  2.0436
2.00  2.2607  3.0133  3.2845
2.50  3.1953  4.1223  4.4359
3.00  3.7675  4.5394  4.8059
3.50  3.8050  4.5919  4.8830
4.00  4.0391  5.2940  5.7699
4.50  5.1958  7.5957  8.5589
5.00  7.6783 12.1225 13.9573
</pre></div>
</div>
<img alt="_images/1_initial_value_problems_11_1.png" src="_images/1_initial_value_problems_11_1.png" />
</div>
</div>
<p>Here we can see that although using a smaller step length has increased the accuracy of the solution it still does not match the exact solution. The Euler method is easy to derive and apply but is not very accurate.</p>
<p>The derivation of more accurate methods is covered in Runge-Kutta methods.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="solving-higher-order-ordinary-differential-equations">
<h2>Solving higher-order ordinary differential equations<a class="headerlink" href="#solving-higher-order-ordinary-differential-equations" title="Permalink to this headline">¶</a></h2>
<p>The numerical methods that are applied to calculate the solutions to ODEs can only be applied to first-order ODEs. To apply them to higher-order ODEs we first need to rewrite them as a system of first-order ODEs.</p>
<p>Consider the <span class="math notranslate nohighlight">\(N\)</span>th-order ODE</p>
<div class="math notranslate nohighlight">
\[y^{(N)} = f(t, y, y', y'', \ldots, y^{(N-1)}).\]</div>
<p>If we let <span class="math notranslate nohighlight">\(y_1=y\)</span>, <span class="math notranslate nohighlight">\(y_2 = y'\)</span>, <span class="math notranslate nohighlight">\(y_3 = y''\)</span> and so on up to <span class="math notranslate nohighlight">\(y_N = y^{(N-1)}\)</span> then we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_1' &amp;= y_2, \\
    y_2' &amp;= y_3, \\
    &amp; \vdots \\
    y_N' &amp;= f(t, y_1, y_2, y_3, \ldots , y_N).
\end{aligned}
\end{split}\]</div>
<p>This is a system of <span class="math notranslate nohighlight">\(N\)</span> first-order ODEs. We can apply our numerical methods for solving ODEs to each equation in the system to give an equivalent solution to the <span class="math notranslate nohighlight">\(n\)</span>th-order ODE.</p>
<div class="section" id="example-4">
<h3>Example 4<a class="headerlink" href="#example-4" title="Permalink to this headline">¶</a></h3>
<p>Rewrite the following third-order ODE as a system of three first-order ODEs.</p>
<div class="math notranslate nohighlight">
\[ y''' + yy'' - 2y' + tyy'' - 10 = 0\]</div>
<p>Let <span class="math notranslate nohighlight">\(y_1 = y\)</span>, <span class="math notranslate nohighlight">\(y_2 = y'\)</span>, <span class="math notranslate nohighlight">\(y_3 = y''\)</span> then we can rewrite this ODE using</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_1' &amp;= y_2, \\
    y_2' &amp;= y_3, \\
    y_3' &amp;= -y_1y_3 + 2y_2 - ty_1y_2 + 10.
\end{aligned}
\end{split}\]</div>
</div>
<div class="section" id="solving-systems-of-ordinary-differential-equations">
<h3>Solving systems of ordinary differential equations<a class="headerlink" href="#solving-systems-of-ordinary-differential-equations" title="Permalink to this headline">¶</a></h3>
<p>Consider a system of <span class="math notranslate nohighlight">\(N\)</span> first-order ODEs is written in the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_1' &amp;= f_1(t, y_1), \\
    y_2' &amp;= f_2(t, y_2), \\
    &amp; \vdots \\
    y_N' &amp;= f_N(t, y_N).
\end{aligned}
\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{y} = \pmatrix{y_1 \\ y_2 \\ \vdots \\ y_N}\)</span> and <span class="math notranslate nohighlight">\(F(t, \mathbf{y}) = \pmatrix{f_1(t, y_1) \\ f_2(t, y_2) \\ \vdots \\ f_N(t, y_N)}\)</span> then we can write the system in vector form</p>
<div class="math notranslate nohighlight">
\[\mathbf{y}' = F(t, \mathbf{y}).\]</div>
<p>Therefore Euler method for solving this ODE in vector form is</p>
<div class="math notranslate nohighlight">
\[ \mathbf{y}_{n+1} = \mathbf{y}_n + hF(t, \mathbf{y}) + O(h^2).\]</div>
<div class="section" id="example-5">
<h4>Example 5<a class="headerlink" href="#example-5" title="Permalink to this headline">¶</a></h4>
<p>Calculate two steps of the Euler method used to solve the following IVP</p>
<div class="math notranslate nohighlight">
\[
    y'' + y = 0, \qquad t \in[0, 10], \qquad y(0) = 2, \qquad y'(0) = 0.
\]</div>
<p>using a step length of <span class="math notranslate nohighlight">\(h=0.1\)</span>.</p>
<p>First we need to rewrite the second-order ODE as two first-order ODEs. Let <span class="math notranslate nohighlight">\(y_1=y\)</span> and <span class="math notranslate nohighlight">\(y_2=y'\)</span> then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_1' &amp;= y_2, &amp; y_1(0) = 2,\\
    y_2' &amp;= -y_1, &amp; y_2(0) = 0,
\end{aligned}
\end{split}\]</div>
<p>and we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    \mathbf{y} &amp;= \pmatrix{y_1 \\ y_2}, &amp;
    F(t, \mathbf{y}) &amp;= \pmatrix{ y_2 \\ -y_1}.
\end{aligned}
\end{split}\]</div>
<p>Calculating the first two steps of the Euler method:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    \mathbf{y}_1 &amp;= \mathbf{y}_0 + hF(t_0, \mathbf{y}_0)
    = \pmatrix{2 \\ 0} + 0.1 \pmatrix{ 0 \\ -2 }
    = \pmatrix{2 \\ -0.2}, \\
    \mathbf{y}_2 &amp;= \mathbf{y}_1 + hF(t_1, \mathbf{y}_1) 
    = \pmatrix{2 \\ -0.2} + 0.1 \pmatrix{-0.2 \\ -2} 
    = \pmatrix{1.98 \\ -0.4}.
\end{aligned}
\end{split}\]</div>
</div>
<div class="section" id="example-6">
<h4>Example 6<a class="headerlink" href="#example-6" title="Permalink to this headline">¶</a></h4>
<p>Calculate the solution of the IVP from example 5 over the whole domain <span class="math notranslate nohighlight">\(t\in [0,10]\)</span> using the Euler method with a step length of <span class="math notranslate nohighlight">\(h=0.1\)</span> and compare it to the exact solution given by</p>
<div class="math notranslate nohighlight">
\[y = 2\cos(t).\]</div>
<p>The functions below defines the right-hand side of the ODE and the exact solution to the IVP.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">dy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dy</span>

<span class="k">def</span> <span class="nf">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The code below defines a function called <code class="docutils literal notranslate"><span class="pre">euler2</span></code> that solves an IVP defined using a system of ODEs. This is very similar to the <a class="reference external" href="#euler"><code class="docutils literal notranslate"><span class="pre">euler</span></code></a> function defined earlier with the exception that the <code class="docutils literal notranslate"><span class="pre">y</span></code> array has <span class="math notranslate nohighlight">\(N\)</span> columns instead of just 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">euler2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the solution to an IVP expressed using a system</span>
<span class="sd">    of ODEs using the Euler method</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Initialise solution arrays</span>
    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nsteps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nsteps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y0</span><span class="p">)))</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">y0</span>

    <span class="c1"># Solver loop</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">t</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>The program below invokes the Euler method to solve this IVP.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define IVP parameters</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># Solve IVP using the Euler method</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">euler2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  t     Euler    Exact</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">23</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:5.2f}</span><span class="s1"> </span><span class="si">{:8.4f}</span><span class="s1"> </span><span class="si">{:8.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>

<span class="c1"># Plot solution</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Solutions to the IVP $y&#39;&#39;+y=0$, $y(0)=2$, $y&#39;(0)=0$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  t     Euler    Exact
-----------------------
 0.00   2.0000   2.0000
 0.50   1.8010   1.7552
 1.00   1.1416   1.0806
 1.50   0.1631   0.1415
 2.00  -0.9060  -0.8323
 2.50  -1.8032  -1.6023
 3.00  -2.2953  -1.9800
 3.50  -2.2387  -1.8729
 4.00  -1.6195  -1.3073
 4.50  -0.5638  -0.4216
 5.00   0.6867   0.5673
 5.50   1.8293   1.4173
 6.00   2.5728   1.9203
 6.50   2.7111   1.9532
 7.00   2.1786   1.5078
 7.50   1.0742   0.6933
 8.00  -0.3550  -0.2910
 8.50  -1.7684  -1.2040
 9.00  -2.8118  -1.8223
 9.50  -3.2054  -1.9943
10.00  -2.8177  -1.6781
</pre></div>
</div>
<img alt="_images/1_initial_value_problems_22_1.png" src="_images/1_initial_value_problems_22_1.png" />
</div>
</div>
<p>Here we can see that the Euler method solution is deviating away from the exact solution. Once again this is a result of the lower order accuracy of the Euler method.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>An initial value problem is expressed as an ODE where the solution at the lower bound of the domain is known.</p></li>
<li><p>The Euler method is derived by truncating the Taylor series after the first-order term. It advances the solution over a small step of length <span class="math notranslate nohighlight">\(h\)</span> using known values of <span class="math notranslate nohighlight">\(t_n\)</span> and <span class="math notranslate nohighlight">\(y_n\)</span> to calculate the solution at <span class="math notranslate nohighlight">\(y_{n+1}=y(t_n + h)\)</span>.</p></li>
<li><p>The Euler method is only first-order accurate so the solutions tend to be inaccurate unless using a very small value of <span class="math notranslate nohighlight">\(h\)</span>.</p></li>
<li><p>Higher-order ODEs can be rewritten as systems of first-order ODEs which can be solved using numerical solvers.</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>Using a pen and calculator (i.e., not Python), solve the following IVP using the Euler method with step length <span class="math notranslate nohighlight">\(h=0.4\)</span>. Write down your solution correct to 4 decimal places</p>
<div class="math notranslate nohighlight">
\[y' = ty, \qquad t \in [0, 2], \qquad y(0) = 1.\]</div>
</li>
<li><p>Reproduce your solutions to question 1 using Python.</p></li>
<li><p>The exact solution to the IVP in question 1 is <span class="math notranslate nohighlight">\(y=e^{t^2/2}\)</span>. Produce a plot of the Euler solution from question 2 and the exact solution on the same set of axes.</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>