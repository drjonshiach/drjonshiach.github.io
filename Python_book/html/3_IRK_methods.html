

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Implicit Runge-Kutta Methods &#8212; My Jupyter Book</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-2 bd-sidebar site-navigation show single-page" id="site-navigation">
    
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/3_IRK_methods.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/3_IRK_methods.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-outcomes">
   Learning outcomes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#determining-the-order-of-an-implicit-runge-kutta-method">
   Determining the order of an implicit Runge-Kutta method
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1">
     Example 1
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deriving-implicit-runge-kutta-methods">
   Deriving implicit Runge-Kutta methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gauss-legendre-methods">
     Gauss-Legendre methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-2">
       Example 2
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#radau-methods">
     Radau methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#radau-ia">
       Radau IA:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#radau-iia">
       Radau IIA
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-3">
       Example 3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diagonally-implicit-runge-kutta-methods">
     Diagonally implicit Runge-Kutta methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-4">
       Example 4
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#singly-diagonally-implicit-runge-kutta-methods">
     Singly diagonally implicit Runge-Kutta methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-5">
       Example 5
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation-of-implicit-runge-kutta-methods">
   Implementation of implicit Runge-Kutta methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-6">
     Example 6
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-7">
     Example 7
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="implicit-runge-kutta-methods">
<h1>Implicit Runge-Kutta Methods<a class="headerlink" href="#implicit-runge-kutta-methods" title="Permalink to this headline">¶</a></h1>
<div class="section" id="learning-outcomes">
<h2>Learning outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this headline">¶</a></h2>
<p>On successful completion of this page readers will be able to:</p>
<ul class="simple">
<li><p><a class="reference external" href="#Dermining-the-order-of-an-implicit-Runge-Kutta-method">Determine the order</a> of an implicit Runge-Kutta method;</p></li>
<li><p>Derive <a class="reference external" href="#Gauss-Legendre-methods">Gauss-Legendre</a>, <a class="reference external" href="#Radau-methods">Radau</a>, <a class="reference external" href="#Diagonally-implicit-Runge-Kutta-methods">DIRK</a> and <a class="reference external" href="#Singly-diagonally-implicit-Runge-Kutta-methods">SDIRK</a> implicit Runge-Kutta methods;</p></li>
<li><p><a class="reference external" href="#Implementation-of-implicit-Runge-Kutta-methods">Apply implicit Runge-Kutta methods to solve initial value problems</a>.</p></li>
</ul>
<p><strong>Implicit Runge-Kutta</strong> (IRK) methods and <strong>Explicit Runge-Kutta</strong> (ERK) methods are the two main types of the family of Runge-Kutta methods. ERK methods are straightforward to apply to solve an ordinary differential equation but are not suitable for <strong>stiff</strong> systems. This is why we need to also consider IRK methods.</p>
<p>The general form of an IRK method to solve a first-order ODE <span class="math notranslate nohighlight">\(y'=f(t, y)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_{n+1} &amp;= y_n + h\sum_{i=1}^s b_i k_i, \\
    k_i &amp;= f(t_n + c_ih, y_n + h\sum_{j=1}^s a_{ij}k_j).
\end{aligned}
\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(y_n = y(t_n)\)</span> is the solution at a discrete point in the domain <span class="math notranslate nohighlight">\(t_n\)</span>, <span class="math notranslate nohighlight">\(y_{n+1} = y(t_n + h)\)</span> is the solution at some small step <span class="math notranslate nohighlight">\(h\)</span> along the domain, <span class="math notranslate nohighlight">\(a_{ij}\)</span>, <span class="math notranslate nohighlight">\(b_i\)</span> and <span class="math notranslate nohighlight">\(c_i\)</span> are coefficients that define a particular method and <span class="math notranslate nohighlight">\(k_i\)</span> are intermediate <strong>stage values</strong> used to calculate <span class="math notranslate nohighlight">\(y_{n+1}\)</span>.</p>
<p>It is common to represent the <span class="math notranslate nohighlight">\(a_{ij}\)</span>, <span class="math notranslate nohighlight">\(b_i\)</span> and <span class="math notranslate nohighlight">\(c_i\)</span> coefficients in a <strong>Butcher tableau</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cccc}
c_1 &amp; a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1s} \\
c_2 &amp; a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2s} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
c_s &amp; a_{s1} &amp; a_{s2} &amp; \cdots &amp; a_{ss} \\ \hline
&amp; b_1 &amp; b_2 &amp; \cdots &amp; b_s
\end{array}\end{split}\]</div>
<p>Note that the <span class="math notranslate nohighlight">\(A\)</span> matrix of an IRK method has non-zero elements in the upper triangular region and on the main diagonal whereas the <span class="math notranslate nohighlight">\(A\)</span> method for an ERK method only has non-zero elements in the lower triangular region.</p>
</div>
<div class="section" id="determining-the-order-of-an-implicit-runge-kutta-method">
<h2>Determining the order of an implicit Runge-Kutta method<a class="headerlink" href="#determining-the-order-of-an-implicit-runge-kutta-method" title="Permalink to this headline">¶</a></h2>
<p><a id="order_conditions"></a>
One of the differences between IRK and ERK methods is that an IRK method can achieve the same accuracy as an ERK method but using fewer stages. To determine the order of an IRK method we need to consider the <strong>order conditions</strong> that govern the values of <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{c}\)</span> which are</p>
<div class="math notranslate nohighlight" id="equation-b-k">
<span class="eqno">(1)<a class="headerlink" href="#equation-b-k" title="Permalink to this equation">¶</a></span>\[B(k): \qquad \sum_{i=1}^s b_ic_i^{j-1} = \frac{1}{j}, \qquad j = 1, 2, \ldots, k\]</div>
<div class="math notranslate nohighlight" id="equation-c-k">
<span class="eqno">(2)<a class="headerlink" href="#equation-c-k" title="Permalink to this equation">¶</a></span>\[C(k): \qquad \sum_{j=1}^s a_{ij}c_j^{\ell-1} = \frac{1}{\ell}c_i^{\ell}, \qquad i = 1, 2, \ldots s, \qquad \ell = 1, 2, \ldots , k,\]</div>
<div class="math notranslate nohighlight" id="equation-d-k">
<span class="eqno">(3)<a class="headerlink" href="#equation-d-k" title="Permalink to this equation">¶</a></span>\[D(k): \qquad \sum_{i=1}^s b_ic_i^{\ell-1} a_{ij} = \frac{1}{\ell} b_j (1 - c_j^\ell), \qquad j = 1, 2, \ldots, s, \qquad \ell = 1, 2, \ldots, k.\]</div>
<p>Let <span class="math notranslate nohighlight">\(G(k)\)</span> represent a given IRK method has order <span class="math notranslate nohighlight">\(k\)</span>, then it can be shown that</p>
<div class="math notranslate nohighlight">
\[B(k) \text{ and } C(\lfloor \tfrac{k}{2} \rfloor) \text{ and } D(\lfloor \tfrac{k}{2} \rfloor) \implies G(k).\]</div>
<p>So to determine the order of an IRK method we need to find the highest value of <span class="math notranslate nohighlight">\(k\)</span> for which equation <a class="reference internal" href="#equation-b-k">(1)</a> is satisfied and which equations <a class="reference internal" href="#equation-c-k">(2)</a> and <a class="reference internal" href="#equation-d-k">(3)</a> are satisfied for <span class="math notranslate nohighlight">\(\lfloor \frac{k}{2} \rfloor\)</span> (i.e. the integer part of <span class="math notranslate nohighlight">\(\frac{k}{2}\)</span>).</p>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>Determine the order of the following IRK method</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
\frac{1}{4} &amp; \frac{1}{4} &amp; 0 \\
\frac{3}{4} &amp; \frac{1}{2} &amp; \frac{1}{4} \\ \hline
&amp; \frac{1}{2} &amp; \frac{1}{2}
\end{array} \end{split}\]</div>
<p>Checking the <span class="math notranslate nohighlight">\(B(k)\)</span> order condition:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    j &amp;= 1, &amp; \mathrm{LHS} &amp;= b_1c_1^0 + b_2c_2^0 = \frac{1}{2}\cdot 1 + \frac{1}{2}\cdot 1  = 1, &amp; \mathrm{RHS} &amp; = 1, \\
    j &amp;= 2, &amp; \mathrm{LHS} &amp;= b_1c_1^1 + b_2c_2^1 = \frac{1}{2} \cdot \frac{1}{4} + \frac{1}{2} \cdot \frac{3}{4} = \frac{1}{2}, &amp; \mathrm{RHS} &amp;= \frac{1}{2}, \\
    j &amp;= 3, &amp; \mathrm{LHS} &amp;= b_1c_1^2 + b_2c_2^2 = \frac{1}{2} \cdot \frac{1}{16} + \frac{1}{2} \cdot \frac{9}{16} = \frac{5}{16}, &amp; \mathrm{RHS} &amp;= \frac{1}{3}.
\end{aligned}
\end{split}\]</div>
<p>So the <span class="math notranslate nohighlight">\(B(k)\)</span> order condition is satisfied up to <span class="math notranslate nohighlight">\(k=j=2\)</span>. Now we need to check whether <span class="math notranslate nohighlight">\(C(k)\)</span> order condition is satisfied up to <span class="math notranslate nohighlight">\(k = 1\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    \ell &amp;= 1, &amp; i &amp;= 1, &amp; \mathrm{LHS} &amp;= a_{11}c_1^0 + a_{12}c_2^0 = \frac{1}{4} \cdot 1 + 0 \cdot 1 = \frac{1}{4}, &amp; \mathrm{RHS} &amp;= \frac{1}{\ell}c_1^\ell = \frac{1}{4}, \\
    \ell &amp;= 1, &amp; i &amp;= 2, &amp; \mathrm{LHS} &amp;= a_{21}c_1^0 + a_{22}c_2^0 = \frac{1}{2} \cdot 1 + \frac{1}{4} \cdot 1 = \frac{3}{4}, &amp; \mathrm{RHS} &amp;= \frac{1}{\ell}c_2^\ell = \frac{3}{4}
\end{aligned}
\end{split}\]</div>
<p>So the <span class="math notranslate nohighlight">\(C(k)\)</span> order condition is satisfied up to <span class="math notranslate nohighlight">\(k=1\)</span>. Now we need to check whether the <span class="math notranslate nohighlight">\(D(k)\)</span> order condition is satisfied up to <span class="math notranslate nohighlight">\(k=1\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    \ell &amp;= 1, &amp; j &amp;= 1, &amp; \mathrm{LHS} &amp;= b_1c_1^0a_{11} + b_2c_2^0 a_{21} = \frac{1}{2} \cdot 1 \cdot \frac{1}{4} + \frac{1}{2} \cdot 1 \cdot \frac{1}{2} = \frac{3}{8}, \\
    &amp; &amp; &amp; &amp; \mathrm{RHS} &amp;= \frac{1}{\ell}b_1(1 - c_1^\ell) = \frac{1}{2}\left(1 - \frac{1}{4}\right) = \frac{3}{8}, \\
    \ell &amp;= 1, &amp; j &amp;= 2, &amp; \mathrm{LHS} &amp;= b_1c_1^0a_{12} + b_2c_2^0a_{22} = \frac{1}{2}\cdot 1 \cdot 0 + \frac{1}{2} \cdot 1 \cdot \frac{1}{4} = \frac{1}{8}, \\
    &amp; &amp; &amp; &amp; \mathrm{RHS} &amp;= \frac{1}{\ell}b_2(1 - c_2^\ell) = \frac{1}{2}\left( 1 - \frac{3}{4} \right) = \frac{1}{8}.
\end{aligned}
\end{split}\]</div>
<p>So the <span class="math notranslate nohighlight">\(D(k)\)</span> order condition is satisfied up to <span class="math notranslate nohighlight">\(k=1\)</span>. Therefore since <span class="math notranslate nohighlight">\(B(2)\)</span>, <span class="math notranslate nohighlight">\(C(1)\)</span> and <span class="math notranslate nohighlight">\(D(1)\)</span> are all satisfied this IRK method is order 2.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="deriving-implicit-runge-kutta-methods">
<h2>Deriving implicit Runge-Kutta methods<a class="headerlink" href="#deriving-implicit-runge-kutta-methods" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gauss-legendre-methods">
<h3>Gauss-Legendre methods<a class="headerlink" href="#gauss-legendre-methods" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Legendre_method"><strong>Gauss-Legendre</strong></a> IRK methods are a family of methods that are derived using Gauss-Legendre quadrature. An <span class="math notranslate nohighlight">\(s\)</span>-stage Gauss-Legendre method has order <span class="math notranslate nohighlight">\(k=2s\)</span>. They are derived using <a class="reference external" href="https://en.wikipedia.org/wiki/Legendre_polynomials">Legendre polynomials</a> which can take the form</p>
<div class="math notranslate nohighlight" id="equation-p-n-t">
<span class="eqno">(4)<a class="headerlink" href="#equation-p-n-t" title="Permalink to this equation">¶</a></span>\[P_n(t) = \sum_{k=0}^n {n \choose k}{n+k \choose k}(t - 1)^k.\]</div>
<p>where <span class="math notranslate nohighlight">\({n \choose k}\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Binomial_coefficient">Binomial coefficient</a>. The values of the <span class="math notranslate nohighlight">\(c_i\)</span> coefficients are the roots of <span class="math notranslate nohighlight">\(P_{s}(t)\)</span>, the values of the <span class="math notranslate nohighlight">\(b_i\)</span> coefficients are chosen to satisfy the <span class="math notranslate nohighlight">\(B(k)\)</span> condition and the <span class="math notranslate nohighlight">\(a_{ij}\)</span> coefficients are chosen to satisfy the <span class="math notranslate nohighlight">\(C(\lfloor \frac{k}{2} \rfloor)\)</span> condition.</p>
<div class="section" id="example-2">
<h4>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h4>
<p>Derive a fourth-order Gauss-Legendre method.</p>
<p>A fourth-order Gauss-Legendre method will have <span class="math notranslate nohighlight">\(s=2\)</span> stages and the <span class="math notranslate nohighlight">\(c_i\)</span> coefficients are chosen to satisfy <span class="math notranslate nohighlight">\(0 = P_{2}(t)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    0 &amp;= {2 \choose 0}{2 \choose 0}(t - 1)^0 + {2 \choose 1}{3 \choose 1}(t - 1)^1 + {2 \choose 2}{4 \choose 2}(t - 1)^2 \\
    &amp;= 1 + 6t - 6 + 6t^2 - 12t + 6 \\
    &amp;= 6t^2 - 6t + 1,
\end{aligned}
\end{split}\]</div>
<p>therefore <span class="math notranslate nohighlight">\(c_1 = \frac{1}{2} - \frac{\sqrt{3}}{6}\)</span> and <span class="math notranslate nohighlight">\(c_2 = \frac{1}{2} + \frac{\sqrt{3}}{6}\)</span>. The <span class="math notranslate nohighlight">\(b_i\)</span> and <span class="math notranslate nohighlight">\(a_{ij}\)</span> coefficients are chosen to satisfy the <span class="math notranslate nohighlight">\(B(4)\)</span> and <span class="math notranslate nohighlight">\(C(2)\)</span> order conditions respectively</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    b_1 + b_2 &amp;= 1, \\
    b_1c_1 + b_2c_2 &amp;= \frac{1}{2}, \\
    a_{11} + a_{12} &amp;= c_1, \\
    a_{21} + a_{22} &amp;= c_2, \\
    a_{11}c_1 + a_{12}c_2 &amp;= \frac{1}{2}c_1^2, \\
    a_{21}c_1 + a_{22}c_2 &amp;= \frac{1}{2}c_2^2.
\end{aligned}
\end{split}\]</div>
<p>The code below uses the <a class="reference external" href="https://docs.sympy.org/latest/modules/solvers/solvers.html"><code class="docutils literal notranslate"><span class="pre">solve</span></code></a> command from the <code class="docutils literal notranslate"><span class="pre">sympy</span></code> library to solve these order conditions for the coefficients <span class="math notranslate nohighlight">\(a_{ij}\)</span> and <span class="math notranslate nohighlight">\(b_i\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Define symbolic variables</span>
<span class="n">a11</span><span class="p">,</span> <span class="n">a12</span><span class="p">,</span> <span class="n">a21</span><span class="p">,</span> <span class="n">a22</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a11, a12, a21, a22, b1, b2, c1, c2&#39;</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span>

<span class="c1"># Define order conditions</span>
<span class="n">eqn1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span>
<span class="n">eqn3</span> <span class="o">=</span> <span class="n">a11</span> <span class="o">+</span> <span class="n">a12</span> <span class="o">-</span> <span class="n">c1</span>
<span class="n">eqn4</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">+</span> <span class="n">a22</span> <span class="o">-</span> <span class="n">c2</span>
<span class="n">eqn5</span> <span class="o">=</span> <span class="n">a11</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">a12</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">c1</span><span class="o">**</span><span class="mi">2</span>
<span class="n">eqn6</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">a22</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">c2</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Solve the order conditions</span>
<span class="n">solve</span><span class="p">((</span><span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span><span class="p">,</span> <span class="n">eqn4</span><span class="p">,</span> <span class="n">eqn5</span><span class="p">,</span> <span class="n">eqn6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>{a11: 1/4,
 a12: 1/4 - sqrt(3)/6,
 a21: 1/4 + sqrt(3)/6,
 a22: 1/4,
 b1: 1/2,
 b2: 1/2}
</pre></div>
</div>
</div>
</div>
<p>So <span class="math notranslate nohighlight">\(b_1 = \frac{1}{2}\)</span>, <span class="math notranslate nohighlight">\(b_2 = \frac{1}{2}\)</span>, <span class="math notranslate nohighlight">\(a_{11} = \frac{1}{4}\)</span>, <span class="math notranslate nohighlight">\(a_{12} = \frac{1}{4} - \frac{\sqrt{3}}{6}\)</span>, <span class="math notranslate nohighlight">\(a_{21} = \frac{1}{4} + \frac{\sqrt{3}}{6}\)</span> and <span class="math notranslate nohighlight">\(a_{22} = \frac{1}{4}\)</span>. So the fourth-order Gauss-Legendre method is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
\frac{1}{2} - \frac{\sqrt{3}}{6} &amp; \frac{1}{4} &amp; \frac{1}{4} - \frac{\sqrt{3}}{6} \\
\frac{1}{2} + \frac{\sqrt{3}}{6} &amp; \frac{1}{4} + \frac{\sqrt{3}}{6} &amp; \frac{1}{4} \\ \hline
&amp; \frac{1}{2} &amp; \frac{1}{2}
\end{array}\end{split}\]</div>
</div>
</div>
<div class="section" id="radau-methods">
<h3>Radau methods<a class="headerlink" href="#radau-methods" title="Permalink to this headline">¶</a></h3>
<p>Gauss-Legendre methods give us maximal order for the number of stages, however sometimes it is better the sacrifice order to gain better stability properties (see <span class="xref myst">Stability of Runge-Kutta Methods</span>). An <span class="math notranslate nohighlight">\(s\)</span>-stage <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Radau_methods"><strong>Radau</strong></a> IRK method has order <span class="math notranslate nohighlight">\(k=2s-1\)</span> and is A-stable. The are two types of Radau methods: Radau IA and Radau IIA.</p>
<div class="section" id="radau-ia">
<h4>Radau IA:<a class="headerlink" href="#radau-ia" title="Permalink to this headline">¶</a></h4>
<p>Let <span class="math notranslate nohighlight">\(c_1=0\)</span> and the other <span class="math notranslate nohighlight">\(c_i\)</span> coefficients are the roots of</p>
<div class="math notranslate nohighlight">
\[0 = P_s(t) + P_{s-1}(t)\]</div>
<p>The coefficients <span class="math notranslate nohighlight">\(b_i\)</span> are chosen to satisfy the <span class="math notranslate nohighlight">\(B(2s)\)</span> order condition and the coefficients <span class="math notranslate nohighlight">\(a_{ij}\)</span> are chosen to satisfy the <span class="math notranslate nohighlight">\(C(s)\)</span> order condition.</p>
</div>
<div class="section" id="radau-iia">
<h4>Radau IIA<a class="headerlink" href="#radau-iia" title="Permalink to this headline">¶</a></h4>
<p>Let <span class="math notranslate nohighlight">\(c_2 = 1\)</span> and the other <span class="math notranslate nohighlight">\(c_i\)</span> coefficients are the roots of</p>
<div class="math notranslate nohighlight">
\[0=P_s(t) - P_{s-1}(t)\]</div>
<p>The coefficients <span class="math notranslate nohighlight">\(b_i\)</span> are chosen to satisfy the <span class="math notranslate nohighlight">\(B(2s)\)</span> order condition and the coefficients <span class="math notranslate nohighlight">\(a_{ij}\)</span> are chosen to satisfy the <span class="math notranslate nohighlight">\(C(s)\)</span> order condition.</p>
</div>
<div class="section" id="example-3">
<h4>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h4>
<p>Derive a third-order Radau IA method.</p>
<p>A <span class="math notranslate nohighlight">\(k=3\)</span> order Radau IA method will have <span class="math notranslate nohighlight">\(s=2\)</span> stages. Let <span class="math notranslate nohighlight">\(c_1=0\)</span> then the value of <span class="math notranslate nohighlight">\(c_2\)</span> is the root of <span class="math notranslate nohighlight">\(0 = P_2(t) + P_1(t)\)</span></p>
<p>\begin{align*}
0 = (6t^2 - 6t + 1) + (2t - 1) = 6t^2 - 4t,
\end{align*}</p>
<p>which is <span class="math notranslate nohighlight">\(c_2 = \frac{2}{3}\)</span>. The values of <span class="math notranslate nohighlight">\(b_i\)</span> and <span class="math notranslate nohighlight">\(a_{ij}\)</span> need to satisfy the <span class="math notranslate nohighlight">\(B(4)\)</span> and <span class="math notranslate nohighlight">\(C(2)\)</span> order conditions respectively with <span class="math notranslate nohighlight">\(k=2\)</span> (same as in <a class="reference external" href="#Example-2">example 2</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define symbolic variables</span>
<span class="n">a11</span><span class="p">,</span> <span class="n">a12</span><span class="p">,</span> <span class="n">a21</span><span class="p">,</span> <span class="n">a22</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a11, a12, a21, a22, b1, b2, c1, c2&#39;</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;2 / 3&#39;</span><span class="p">)</span>

<span class="c1"># Define order conditions</span>
<span class="n">eqn1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span>
<span class="n">eqn3</span> <span class="o">=</span> <span class="n">a11</span> <span class="o">+</span> <span class="n">a12</span> <span class="o">-</span> <span class="n">c1</span>
<span class="n">eqn4</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">+</span> <span class="n">a22</span> <span class="o">-</span> <span class="n">c2</span>
<span class="n">eqn5</span> <span class="o">=</span> <span class="n">a11</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">a12</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">c1</span><span class="o">**</span><span class="mi">2</span>
<span class="n">eqn6</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">a22</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">c2</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Solve system</span>
<span class="n">solve</span><span class="p">((</span><span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span><span class="p">,</span> <span class="n">eqn4</span><span class="p">,</span> <span class="n">eqn5</span><span class="p">,</span> <span class="n">eqn6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>{a11: 0, a12: 0, a21: 1/3, a22: 1/3, b1: 1/4, b2: 3/4}
</pre></div>
</div>
</div>
</div>
<p>So <span class="math notranslate nohighlight">\(a_{11} = 0\)</span>, <span class="math notranslate nohighlight">\(a_{12} = 0\)</span>, <span class="math notranslate nohighlight">\(a_{21} = \frac{1}{3}\)</span>,  <span class="math notranslate nohighlight">\(a_{22} = \frac{1}{3}\)</span>, <span class="math notranslate nohighlight">\(b_1 = \frac{1}{4}\)</span> and <span class="math notranslate nohighlight">\(b_2 = \frac{3}{4}\)</span> and the third-order Radau IA method is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
0 &amp; 0 &amp; 0 \\ 
\frac{2}{3} &amp; \frac{1}{3} &amp; \frac{1}{3} \\ \hline
&amp; \frac{1}{4} &amp; \frac{3}{4}
\end{array}\end{split}\]</div>
</div>
</div>
<div class="section" id="diagonally-implicit-runge-kutta-methods">
<h3>Diagonally implicit Runge-Kutta methods<a class="headerlink" href="#diagonally-implicit-runge-kutta-methods" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Diagonally_Implicit_Runge_Kutta_methods"><strong>Diagonally Implicit Runge-Kutta</strong></a> (DIRK) methods are where the <span class="math notranslate nohighlight">\(A\)</span> matrix is lower triangular with non-zero elements on the main diagonal, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cccc}
c_1 &amp; a_{11} \\
c_2 &amp; a_{21} &amp; a_{22} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots \\
c_s &amp; a_{s1} &amp; a_{s2} &amp; \cdots &amp; a_{ss} \\ \hline
&amp; b_1 &amp; b_2 &amp; \cdots &amp; b_s
\end{array}\end{split}\]</div>
<p>The advantage of DIRK methods is that although the stage values <span class="math notranslate nohighlight">\(k_1, k_2, \ldots, k_s\)</span> are defined using implicit equations, the solutions to these can be obtained sequentially since the equation for <span class="math notranslate nohighlight">\(k_i\)</span> does not include <span class="math notranslate nohighlight">\(k_{i+1}, k_{i+2}, \ldots, k_s\)</span>.</p>
<p>The coefficients of a <span class="math notranslate nohighlight">\(k\)</span>th-order DIRK method are chosen to satisfy the <span class="math notranslate nohighlight">\(B(k)\)</span> and <span class="math notranslate nohighlight">\(C(\lfloor \frac{k}{2} \rfloor)\)</span> order conditions along with</p>
<div class="math notranslate nohighlight">
\[ \mathbf{b}^T \cdot A \cdot \mathbf{c} = \frac{1}{k!}\]</div>
<div class="section" id="example-4">
<h4>Example 4<a class="headerlink" href="#example-4" title="Permalink to this headline">¶</a></h4>
<p>Derive a 2-stage third-order DIRK method.</p>
<p>Since <span class="math notranslate nohighlight">\(k=3\)</span> the order conditions are (remembering that <span class="math notranslate nohighlight">\(a_{12}=0\)</span>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    b_1 + b_2 &amp;= 1, \\
    b_1c_1 + b_2c_2 &amp;= \frac{1}{2}, \\
    b_1c_1^2 + b_2c_2^2 &amp;= \frac{1}{3}, \\
    a_{11} &amp;= c_1, \\
    a_{21} + a_{22} &amp;= c_2, \\
    b_1a_{11}c_1 + b_2(a_{21}c_1 + a_{22}c_2) &amp;= \frac{1}{6}
\end{aligned}
\end{split}\]</div>
<p>Here we have a system of 6 equations in 7 unknowns. Choosing <span class="math notranslate nohighlight">\(c_1=\frac{1}{4}\)</span> and solving for the other coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define symbolic variables</span>
<span class="n">a11</span><span class="p">,</span> <span class="n">a21</span><span class="p">,</span> <span class="n">a22</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a11, a21, a22, b1, b2, c1, c2&#39;</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 4&#39;</span><span class="p">)</span>

<span class="c1"># Define order conditions</span>
<span class="n">eqn1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span>
<span class="n">eqn3</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 3&#39;</span><span class="p">)</span>
<span class="n">eqn4</span> <span class="o">=</span> <span class="n">a11</span> <span class="o">-</span> <span class="n">c1</span>
<span class="n">eqn5</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">+</span> <span class="n">a22</span> <span class="o">-</span> <span class="n">c2</span>
<span class="n">eqn6</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">a11</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="n">a21</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">a22</span> <span class="o">*</span> <span class="n">c2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 6&#39;</span><span class="p">)</span>

<span class="c1"># Solve for the coefficients</span>
<span class="n">solve</span><span class="p">((</span><span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span><span class="p">,</span> <span class="n">eqn4</span><span class="p">,</span> <span class="n">eqn5</span><span class="p">,</span> <span class="n">eqn6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[{a11: 1/4, a21: 2/3, a22: 1/6, b1: 4/7, b2: 3/7, c2: 5/6}]
</pre></div>
</div>
</div>
</div>
<p>So <span class="math notranslate nohighlight">\(a_{11} = \frac{1}{4}\)</span>, <span class="math notranslate nohighlight">\(a_{21} = \frac{2}{3}\)</span>, <span class="math notranslate nohighlight">\(a_{22} = \frac{1}{6}\)</span>, <span class="math notranslate nohighlight">\(b_1 = \frac{4}{7}\)</span>, <span class="math notranslate nohighlight">\(b_2 = \frac{3}{7}\)</span> and <span class="math notranslate nohighlight">\(c_2 = \frac{5}{6}\)</span>  so a third-order DIRK method is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
\frac{1}{4} &amp; \frac{1}{4} \\
\frac{5}{6} &amp; \frac{2}{3} &amp; \frac{1}{6}  \\ \hline
&amp; \frac{4}{7} &amp; \frac{3}{7}
\end{array}\end{split}\]</div>
</div>
</div>
<div class="section" id="singly-diagonally-implicit-runge-kutta-methods">
<h3>Singly diagonally implicit Runge-Kutta methods<a class="headerlink" href="#singly-diagonally-implicit-runge-kutta-methods" title="Permalink to this headline">¶</a></h3>
<p><strong>Singly Diagonally Implicit Runge-Kutta</strong> (SDIRK) methods are a variation on DIRK method with the additional condition that the elements on the main diagonal have the same value (i.e., <span class="math notranslate nohighlight">\(a_{ii}=c_1\)</span> by the row sum condition on the first row of <span class="math notranslate nohighlight">\(A\)</span>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cccc}
c_1 &amp; c_1 \\
c_2 &amp; a_{21} &amp; c_1 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots \\
c_s &amp; a_{s1} &amp; a_{s2} &amp; \cdots &amp; c_1 \\ \hline
&amp; b_1 &amp; b_2 &amp; \cdots &amp; b_s
\end{array}\end{split}\]</div>
<p>The advantage that SDIRK methods is that they are A-stable for certain values of <span class="math notranslate nohighlight">\(c_1\)</span>.</p>
<p>The derivation of an <span class="math notranslate nohighlight">\(k\)</span>th-order SDIRK method uses the <span class="math notranslate nohighlight">\(B(k)\)</span>, <span class="math notranslate nohighlight">\(C(\lfloor \frac{k}{2} \rfloor)\)</span> and <span class="math notranslate nohighlight">\(D(\lfloor \frac{k}{2} \rfloor)\)</span>  order conditions.</p>
<div class="section" id="example-5">
<h4>Example 5<a class="headerlink" href="#example-5" title="Permalink to this headline">¶</a></h4>
<p>Derive 2-stage third-order SDIRK method.</p>
<p>Since <span class="math notranslate nohighlight">\(a_{11} = a_{22} = c_1\)</span> the order conditions used in <a class="reference external" href="#Example-4">example 4</a> become</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    b_1 + b_2 &amp;= 1, \\
    b_1c_1 + b_2c_2 &amp;= \frac{1}{2}, \\
    b_1c_1^2 + b_2c_2^2 &amp;= \frac{1}{3}, \\
    a_{21} + c_1 &amp;= c_2, \\
    b_1c_1^2 + b_2(a_{21}c_1 + c_1c_2) &amp;= \frac{1}{6}
\end{aligned}
\end{split}\]</div>
<p>Here we have 5 equations in 5 unknowns. Solving these order conditions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define symbolic variables</span>
<span class="n">a21</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a21, b1, b2, c1, c2&#39;</span><span class="p">)</span>

<span class="c1"># Define order conditions</span>
<span class="n">eqn1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 2&#39;</span><span class="p">)</span>
<span class="n">eqn3</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">c2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 3&#39;</span><span class="p">)</span>
<span class="n">eqn4</span> <span class="o">=</span> <span class="n">a21</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">-</span> <span class="n">c2</span>
<span class="n">eqn5</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="n">a21</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">c2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1 / 6&#39;</span><span class="p">)</span>

<span class="c1"># Solve for the coefficients</span>
<span class="n">solve</span><span class="p">((</span><span class="n">eqn1</span><span class="p">,</span> <span class="n">eqn2</span><span class="p">,</span> <span class="n">eqn3</span><span class="p">,</span> <span class="n">eqn4</span><span class="p">,</span> <span class="n">eqn5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[{a21: -sqrt(3)/3, b1: 1/2, b2: 1/2, c1: sqrt(3)/6 + 1/2, c2: 1/2 - sqrt(3)/6},
 {a21: sqrt(3)/3, b1: 1/2, b2: 1/2, c1: 1/2 - sqrt(3)/6, c2: sqrt(3)/6 + 1/2}]
</pre></div>
</div>
</div>
</div>
<p>So <span class="math notranslate nohighlight">\(a_{21} = \mp \frac{\sqrt{3}}{3}\)</span>, <span class="math notranslate nohighlight">\(b_1 = \frac{1}{2}\)</span>, <span class="math notranslate nohighlight">\(b_2 = \frac{1}{2}\)</span>, <span class="math notranslate nohighlight">\(c_1 = \frac{1}{2} \pm \frac{\sqrt{3}}{6}\)</span> <span class="math notranslate nohighlight">\(c_2 = \mp \frac{\sqrt{3}}{6}\)</span> and the third-order SDIRK method is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
    \frac{1}{2} \pm \frac{\sqrt{3}}{6} &amp; \frac{1}{2} \pm \frac{\sqrt{3}}{6} \\
    \frac{1}{2} \mp \frac{\sqrt{3}}{6} &amp; \mp \frac{\sqrt{3}}{3} &amp; \frac{1}{2} \pm \frac{\sqrt{3}}{6} \\ \hline
    &amp; \frac{1}{2} &amp; \frac{1}{2}
\end{array}\end{split}\]</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="implementation-of-implicit-runge-kutta-methods">
<h2>Implementation of implicit Runge-Kutta methods<a class="headerlink" href="#implementation-of-implicit-runge-kutta-methods" title="Permalink to this headline">¶</a></h2>
<p>Recall that the general form of an IRK method is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_{n+1} &amp;= y_n + h\sum_{i=1}^s b_i k_i, \\
    k_i &amp;= f(t_n + c_ih, y_n + h\sum_{j=1}^s a_{ij}k_j).
\end{aligned}
\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(Y_i = y_n + h\displaystyle\sum_{j=1}^s a_{ij}k_j\)</span> then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_{n+1} &amp;= y_n + h \sum_{i=1}^s b_i f(t_n + c_ih, Y_i), \\
    Y_i &amp;= y_n + h \sum_{j=1}^s a_{ij} f(t_n + c_jh, Y_j).
\end{aligned}
\end{split}\]</div>
<p>Expanding the summation in the expression for <span class="math notranslate nohighlight">\(Y_i\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    Y_1 &amp;= y_n + h (a_{11} f(t_n + c_1h, Y_1) + a_{12} f(t_n + c_2h, Y_2) + \cdots + a_{1s} f(t_n + c_sh, Y_s)), \\
    Y_2 &amp;= y_n + h (a_{21} f(t_n + c_1h, Y_1) + a_{22} f(t_n + c_2h, Y_2) + \cdots + a_{2s} f(t_n + c_sh, Y_s)), \\
    &amp; \vdots \\
    Y_s &amp;= y_n + h (a_{s1} f(t_n + c_1h, Y_1) + a_{s2} f(t_n + c_2h, Y_2) + \cdots + a_{ss} f(t_n + c_sh, Y_s)).
\end{aligned}
\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(Y = (Y_1, Y_2, \ldots, Y_s)^T\)</span> then we can write</p>
<p><a id="irk_vector"></a></p>
<div class="math notranslate nohighlight">
\[Y =  y_n + h A \cdot f(t_n + \mathbf{c}h, Y),\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-irk-y-n-1">
<span class="eqno">(5)<a class="headerlink" href="#equation-irk-y-n-1" title="Permalink to this equation">¶</a></span>\[y_{n+1} = y_n + h \mathbf{b}^T \cdot f( t_n + \mathbf{c}h, Y).\]</div>
<p>Since the equation for the stage values <span class="math notranslate nohighlight">\(Y\)</span> is an implicit equation we need to use an iterative method to solve this. The simplest iterative method is the <a id="jacobi"></a><a class="reference external" href="https://en.wikipedia.org/wiki/Jacobi_method">Jacobi method</a>. Let <span class="math notranslate nohighlight">\(Y^{k}\)</span> denote an estimate of <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(Y^{k+1}\)</span> denote an improved estimate. Using non-zero starting values for <span class="math notranslate nohighlight">\(Y^0\)</span> the Jacobi method applied to calculate the stage values of an IRK is</p>
<div class="math notranslate nohighlight" id="equation-jacobi">
<span class="eqno">(6)<a class="headerlink" href="#equation-jacobi" title="Permalink to this equation">¶</a></span>\[Y^{k+1} = y_n + h A \cdot f(t_n + \mathbf{c}h, Y^k).\]</div>
<p>The method is iterated until the largest absolute difference between two successive iterations of the method is less than some small number <span class="math notranslate nohighlight">\(tol\)</span>, i.e.,</p>
<div class="math notranslate nohighlight">
\[\max |Y^{k+1} - Y^{k}| &lt; tol.\]</div>
<p>Note that the Jacobi method is computationally inefficient and in practice <a class="reference external" href="https://en.wikipedia.org/wiki/Newton%27s_method">Newton’s method</a> is most commonly used to calculate <span class="math notranslate nohighlight">\(Y\)</span>. This requires calculation of a <a class="reference external" href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant">Jacobian matrix</a> and the solution to a linear system of equations and is outside of the scope of this course.</p>
<div class="section" id="example-6">
<h3>Example 6<a class="headerlink" href="#example-6" title="Permalink to this headline">¶</a></h3>
<p>Calculate the first step of the following IRK method</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
0 &amp; \frac{1}{4} &amp; -\frac{1}{4} \\
\frac{2}{3} &amp; \frac{1}{4} &amp; \frac{5}{12} \\ \hline
&amp; \frac{1}{4} &amp; \frac{3}{4}
\end{array}\end{split}\]</div>
<p>to solve the IVP</p>
<p>\begin{align*}
y’ &amp;= \sin^2(t)y, &amp; t &amp;\in [0, 5], &amp; y(0) &amp;= 1,
\end{align*}</p>
<p>using a step length of <span class="math notranslate nohighlight">\(h=0.5\)</span>.</p>
<p>Since <span class="math notranslate nohighlight">\(t_0=0\)</span> and <span class="math notranslate nohighlight">\(y_0=1\)</span> we need to iterate equation <a class="reference internal" href="#equation-jacobi">(6)</a> to solve for the stage values <span class="math notranslate nohighlight">\(Y\)</span>. Using <span class="math notranslate nohighlight">\(Y^0 = (1, 1)^T\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    Y^1 &amp;= y_0 + h A f(t_0 + \mathbf{c}h, Y^0) = 1 + 0.5\pmatrix{\frac{1}{4} &amp; -\frac{1}{4} \\ \frac{1}{4} &amp; \frac{5}{12}} \pmatrix{\sin^2(0+0(0.5))(1) \\ \sin^2(0+\frac{2}{3}(0.5))(1)} = \pmatrix{0.9866 \\ 1.0223},  \\
    Y^2 &amp;= y_0 + h A f(t_0 + \mathbf{c}h, Y^1) = 1 + 0.5\pmatrix{\frac{1}{4} &amp; -\frac{1}{4} \\ \frac{1}{4} &amp; \frac{5}{12}} \pmatrix{\sin^2(0+0(0.5))(0.9866) \\ \sin^2(0 + \frac{2}{3}(0.5))(1.0223)} = \pmatrix{0.9863 \\ 1.0228}, \\
    Y^3 &amp;= y_0 + h A f(t_0 + \mathbf{c}h, Y^2) = 1 + 0.5\pmatrix{\frac{1}{4} &amp; -\frac{1}{4} \\ \frac{1}{4} &amp; \frac{5}{12}} \pmatrix{\sin^2(0+0(0.5))(0.9863) \\ \sin^2(0+\frac{2}{3}(0.5))(1.0228)} = \pmatrix{0.9863 \\ 1.0228}, \\
\end{aligned}
\end{split}\]</div>
<p>Here the values of <span class="math notranslate nohighlight">\(Y^2\)</span> and <span class="math notranslate nohighlight">\(Y^3\)</span> agree to 4 decimal places. Substituting these into equation <a class="reference internal" href="#equation-irk-y-n-1">(5)</a></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_1 &amp;= y_0 + h \mathbf{b}^T \cdot f(t_0 + \mathbf{c}h, Y) = 1 + 0.5 \pmatrix{ \frac{1}{2} &amp; \frac{1}{2}} \pmatrix{ \sin^2(0+0(0.5))(0.9863) \\ \sin^2(0+\frac{2}{3}(0.5))(1.0228)} = 1.0411.
\end{aligned}
\end{split}\]</div>
</div>
<div class="section" id="example-7">
<h3>Example 7<a class="headerlink" href="#example-7" title="Permalink to this headline">¶</a></h3>
<p>Calculate the solution of the IVP from <a class="reference external" href="#Example-6">example 6</a> over the whole domain <span class="math notranslate nohighlight">\(t\in [0,5]\)</span> using the given IRK method with a step length of <span class="math notranslate nohighlight">\(h=0.5\)</span> and compare it to the exact solution given by</p>
<div class="math notranslate nohighlight">
\[y = e^{(t - \sin(t)\cos(t))/2}\]</div>
<p>The functions below defines the right-hand side of the ODE and the exact solution to the IVP.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>The function below solves a first-order IVP using IRK method defined by the inputs <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">irk</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the solution to an initial value problem using an implicit</span>
<span class="sd">    Runge-Kutta method defined by A, b and c</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Initialise output ararys</span>
    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nsteps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nsteps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>

    <span class="c1"># Loop through steps</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>

        <span class="c1"># Solve for Y values using the Jacobi method</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
            <span class="n">Ynew</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span>

            <span class="c1"># Check for convergence</span>
            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ynew</span> <span class="o">-</span> <span class="n">Y</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="c1"># Update Y</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">Ynew</span>

        <span class="c1"># Calculate the solution at the next step</span>
        <span class="n">y</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span>
        <span class="n">t</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>The program below solves the IVP given here using this IRK method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Define IRK method</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">12</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Define IVP parameters</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1"># Solve IVP using the IRK method</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">irk</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="c1"># Output solution table</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; t     RK2    Exact</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.2f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1"> </span><span class="si">{:7.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>

<span class="c1"># Plot solutions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">(</span><span class="n">t1</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;IRK&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Solution to the IVP $y&#39;=\sin^2(t)y$, $y(0) = 1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span> t     RK2    Exact
--------------------
0.00  1.0000  1.0000
0.50  1.0411  1.0404
1.00  1.3174  1.3135
1.50  2.0535  2.0436
2.00  3.2955  3.2845
2.50  4.4465  4.4359
3.00  4.8160  4.8059
3.50  4.8943  4.8830
4.00  5.7944  5.7699
4.50  8.6166  8.5589
5.00 14.0405 13.9573
</pre></div>
</div>
<img alt="_images/3_IRK_methods_27_1.png" src="_images/3_IRK_methods_27_1.png" />
</div>
</div>
<p>We can see here that the solution computed using this IRK method (which is of order 3) closely matches the exact solution.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The stage values in an <a class="reference external" href="#Implicit-Runge-Kutta-Methods">Implicit Runge-Kutta (IRK) method</a> are defined using implicit equations.</p></li>
<li><p>The <span class="math notranslate nohighlight">\(A\)</span> matrix of an IRK method has non-zero elements on the main diagonal or upper triangular region.</p></li>
<li><p>IRK methods use fewer stages to achieve the same accuracy as Explicit Runge-Kutta (ERK) methods.</p></li>
<li><p>The derivation of IRK methods involves choosing values of <span class="math notranslate nohighlight">\(a_{ij}\)</span>, <span class="math notranslate nohighlight">\(b_i\)</span> and <span class="math notranslate nohighlight">\(c_I\)</span> to satisfy some <a class="reference external" href="#order_conditions">order conditions</a>.</p></li>
<li><p>IRK methods have better stability properties than ERK methods meaning they can be used to solve stiff ODEs with which ERK methods are unsuitable (see <span class="xref myst">Stability of Runge-Kutta method</span>).</p></li>
<li><p>IRK methods require an iterative method such as the <a class="reference external" href="#jacobi">Jacobi method</a> to calculate the stage values.</p></li>
<li><p>IRK methods are more computationally expensive when applied to non-stiff methods than ERK methods.</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>Show that the Radau IA method derived in <a class="reference external" href="#Example-3">example 3</a> is a third-order method.</p></li>
<li><p>Determine the order of the following IRK method</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|ccc}
0 &amp; 0 &amp; 0 \\
\frac{1}{2} &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 \\ \hline
&amp; \frac{1}{6} &amp; \frac{2}{3} &amp; \frac{1}{6}
\end{array}
\end{split}\]</div>
</li>
<li><p>Derive a third-order Radau IIA method.</p></li>
<li><p>Derive a two-stage second-order SDIRK method with <span class="math notranslate nohighlight">\(c_1=\frac{1}{4}\)</span>.</p></li>
<li><p>Using pen and a calculator and working to 4 decimal places, calculate the first step of your IRK method derived in question 4 to solve the following IVP using a step length of <span class="math notranslate nohighlight">\(h=0.4\)</span></p>
<div class="math notranslate nohighlight">
\[y' = ty, \qquad t \in [0, 2], \qquad y(0) = 1.\]</div>
</li>
<li><p>The exact solution to the IVP in question 5 is <span class="math notranslate nohighlight">\(y=e^{t^2/2}\)</span>. Using Python repeat question 5 for the full domain and produce a table comparing the numerical and exact solutions and plot the numerical solutions and exact solutions on the same set of axes.</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>